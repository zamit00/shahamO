<!DOCTYPE html>
<html lang="he">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-41JX3YK216"></script>

<script>  
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-41JX3YK216');
</script>
	<script src="https://cdn.jsdelivr.net/npm/eruda"></script> 
	<script>    
	     //eruda.init();
	</script>
    <meta property="og:title" content="שחם אורלן">
    <meta property="og:description" content="אתר השוואה לנתוני קופות גמל, קרנות השתלמות, קרנות פנסיה ופוליסות חסכון ">
    <meta property="og:image" content="https://zamit00.github.io/shahamMain.png">
    <meta property="og:url" content="https://zamit00.github.io">
    <meta property="og:type" content="website">
    <meta name="description" content="כאן תמצאו מידע מקיף על קופות גמל, קרנות השתלמות, קרנות פנסיה ופוליסות חסכון פרט, כולל השוואת נתונים, מחשבונים פיננסיים מתקדמים ותוכן מקצועי שיעזור לכם לקבל החלטות
	    חכמות בנוגע לחיסכון הפנסיוני שלכם.">
	<title> שחם אורלן</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-3d@latest/dist/chartjs-chart-3d.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/ScrollToPlugin.min.js"></script>
    <script src="data.js"></script>
    <script src="kochavimscript.js"></script>
    <script src="PensiaScript.js"></script>
    <script src="mainscript.js"></script>
  
  <style>
    .hero-images .image-label {display: none;}
    .hero-images{
      display: none;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;        
    }
.hero{
  position: relative;
  width: 100%;
  margin: 0;
  margin-top: 0;
  padding: 0;
  display: block;
  direction: rtl;
  background-image: url('shahamMain.png');
  background-size: 100% auto;
  background-repeat: no-repeat;
  background-position: top center;
  /* שמירה על יחס גובה-רוחב של התמונה - גובה נקבע לפי הרוחב */
  padding-top: 41.6667%; /* 800/1920 * 100 - יחס גובה-רוחב של התמונה */
  height: 0;
  min-height: 0;
  line-height: 0;
  overflow: hidden;
}

/* התמונה עצמה - כבר לא נחוצה */
.hero .hero-img{
  display: none;
}

/* overlay - מיכל לקישורים ללא רקע כהה */
.hero .hero-overlay{
  position: absolute;
  top: 39%;
  left: 53%;
  transform: translate(-50%, -50%);
  width: 5%;                 /* בערך 5% מגודל התמונה כפי שציינת */
  aspect-ratio: 1 / 1;      /* ריבוע */
  margin: 0;
  padding: 0;
  pointer-events: none;      /* שלא יחסום קליקים מחוץ להוטספוטים */
  overflow: visible;
}

/* מיקום רספונסיבי של overlay לפי גודל המסך */
@media (min-width: 1400px) {
  .hero .hero-overlay {
    top: 39%;
    left: 53%;
    width: 5%;
  }
}

@media (min-width: 1200px) and (max-width: 1399px) {
  .hero .hero-overlay {
    top: 38%;
    left: 52.5%;
    width: 5.5%;
  }
}

@media (min-width: 768px) and (max-width: 1199px) {
  .hero .hero-overlay {
    top: 37%;
    left: 52%;
    width: 6%;
  }
}

@media (max-width: 767px) {
  .hero .hero-overlay {
    top: 35%;
    left: 50%;
    width: 8%;
  }
}

/* גריד 2x2 במרכז - ללא רווחים */
.hero .hero-grid{
  pointer-events: auto;      /* כדי שהקישורים יהיו קליקביליים */
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: repeat(2, 1fr);
  margin: 10px;
  margin-top: 2.5vh;
  padding: 0;
  gap: 8vh;                    /* רווחים בין הקישורים */
  width: 100%;
  height: 100%;
  position: relative;
}

/* רווחים רספונסיביים */
@media (min-width: 1400px) {
  .hero .hero-grid {
    gap: 8vh;
    margin-top: 2.5vh;
  }
}

@media (min-width: 768px) and (max-width: 1399px) {

  .hero .hero-grid {
    gap: 6vh;
    margin-top: 2vh;
  }
}

@media (max-width: 767px) {
  .hero .hero-grid {
    display: none;
    gap: 4vh;
    margin-top: 1.5vh;
  }
  .hero{display: none;}
}

/* ההוטספוטים – קישורים שקופים לחלוטין, כל אחד ברבע שלו */
.hero .hotspot{
  display: block;
  width: 4vw;
  height: 600%;
  margin: -5px;
  padding: 0;
  background: transparent;
  text-decoration: none;
  outline: none;
  position: relative;
}

/* גודל רספונסיבי של hotspots */
@media (min-width: 1400px) {
  .hero .hotspot {
    width: 4vw;
    height: 500%;
    margin: -5px;
  }
}

@media (min-width: 768px) and (max-width: 1399px) {
  .hero .hotspot {
    width: 5vw;
    height: 450%;
    margin: -4px;
  }
}

@media (max-width: 767px) {
  .header-socials{display: none !important;}
  .hero .hotspot {
    display: none;
    width: 6vw;
    height: 400%;
    margin: -3px;
  }
  .hero{display: none !important;}
  .hero-images {
  display: block;  /* מציג את התמונות */
  width: 100%;
}

/* כל מיכל עם תמונה ותווית */
.hero-images .image-container {
  position: relative;  /* מיקום התווית על התמונה */
  width: 100%;
  margin-bottom: 2px; /* הסרת רווח מיותר בין התמונות */
}

/* כל תמונה תופסת את כל רוחב המיכל */
.hero-images .image {
  display: block;   /* תמונה כחלק מהזרימה של הדף */
  width: 100%;      /* תמונה ממלאת את כל רוחב המיכל */
  height: auto;     /* שמירה על פרופורציות התמונה */
}

/* תווית שקופה על כל תמונה */
.hero-images .image-label {
 display: block;
  position: absolute;
  bottom: 5px;     /* מרחק 10px מהחלק התחתון של התמונה */
  left: 10px;       /* מרחק 10px מהחלק השמאלי של התמונה */
  background-color: transparent; /* רקע שקוף */
  color: white;     /* טקסט לבן */
  padding: 10px;
  border-radius: 8px;
  font-size: 20px;
  font-weight: bold;
  text-align: left;  /* כדי שהטקסט יהיה מיושר לשמאל */
  width: auto;
  text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7); /* הצללה לטקסט */
}

}

/* מיקום כל קישור ברבע המתאים */
.hero .hotspot:nth-child(1) {
  /* כניסת מבוטחים - רבע עליון ימני */
  grid-column: 2;
  grid-row: 1;
}

.hero .hotspot:nth-child(2) {
  /* כניסת סוכנים - רבע עליון שמאלי */
  grid-column: 1;
  grid-row: 1;
}

.hero .hotspot:nth-child(3) {
  /* כניסת מעסיקים - רבע תחתון ימני */
  grid-column: 2;
  grid-row: 2;
}

.hero .hotspot:nth-child(4) {
  /* להצטרפות אלינו - רבע תחתון שמאלי */
  grid-column: 1;
  grid-row: 2;
}

/* פוקוס מקלדת לנגישות (לא “צובע” ברגיל) */
.hero .hotspot:focus-visible{
  outline: 2px solid rgba(255,255,255,0.95);
  outline-offset: 3px;
}





.buttons-grid {
  direction: rtl;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 30px;
  justify-items: center;
  align-items: center;
  padding: 25px;
  max-width: 1500px;
  margin: 0 auto;
}

.grid-button {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  text-decoration: none;
  color: #fff;
  font-weight: 700;
  font-size: 1.1rem;
  text-align: center;
  padding: 20px 30px;
  width: 100%;
  max-width: 350px;

  /* גרדיאנט – זהה כמעט לחלוטין למקור */
  background: linear-gradient(180deg, #66b6cc 0%, #0c5266 100%);
  border-radius: 60px;
  box-shadow: inset 0 3px 6px rgba(255,255,255,0.3),
              0 6px 15px rgba(0,0,0,0.3);
  transition: all 0.25s ease-in-out;
}

.grid-button::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 60px;
  background: radial-gradient(ellipse at center, rgba(255,255,255,0.25) 0%, rgba(255,255,255,0) 70%);
  opacity: 0.6;
  pointer-events: none;
}

.grid-button:hover {
  background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
  box-shadow: inset 0 3px 6px rgba(255,255,255,0.4),
              0 8px 20px rgba(0,0,0,0.4);
  transform: translateY(-2px);
}

/* טאבלט: 2 עמודות => 3 שורות */
@media (max-width: 860px) {
  .buttons-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
    max-width: 720px;
  }
  .grid-button { max-width: 360px; }
}

/* מובייל: עמודה אחת */
@media (max-width: 520px) {
  .buttons-grid {
    grid-template-columns: 1fr;
    gap: 18px;
  }
  .grid-button { max-width: 420px; }
}



    .choose-us-title{
        display: flex;
        justify-content: center;
        align-items: center;
        width: clamp(300px, 100%, 1400px);
        margin-bottom: 30px;
        background: white;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        border-radius: 20px;
        margin-right: auto;
        margin-left: auto;
       
    }
    .choose-us-title-text{
        font-size: 2rem;
        background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        padding: 0.6rem;
        
    }
    .flex-container{
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width:clamp(300px, 100%, 1400px);
        margin-right: auto;
        margin-left: auto;
       
    }
    .flex-container-row{
        display: flex;
        flex-direction: row;
        align-items: stretch;
        justify-content: center;
        gap: 2rem;
        width: clamp(300px, 100%, 1400px);
        margin-right: auto;
        margin-left: auto;
        flex-wrap: wrap;
    }
    
    .flex-container-row > .feature-card {
        flex: 1;
        min-width: 300px;
        max-width: calc(33.333% - 1.5rem);
    }
     .tbl-button{
         background-color: #0183AA;
         color: white;
         padding: 12px 24px;
         border: none;
         border-radius: 8px;
         cursor: pointer;
         transition: all 0.3s ease;
         font-size: 0.9rem;
         font-weight: bold;
         text-align: center;
         line-height: 1.2;
         height: auto;
         box-shadow: 0 2px 8px #0183AA;
     }
     
     .tbl-button:hover {
         background-color: #0183AA;
         transform: translateY(-2px);
         box-shadow: 0 4px 12px #0183AA;
     }
	.mainTitle,.secondTitle{

			text-align: right;
			margin: 10px 0;
			font-size: 1.5rem;
			color: #333;
			max-width: 1400px;
			display: flex;
            flex-direction: column;
            align-items: center;
			margin-right: auto;
			margin-left: auto;
			padding: 20px;
			 
		}
		
		#services{
			padding-bottom: 0%;
			padding-top: 0%;
		}
          .file-upload-section{
              display: none;
		}
		.secondTitle{
			margin-top: 10px;
		}
		.mainTitle .feature-card,.secondTitle .feature-card {
			display: flex;
			flex-direction: column;
            max-width:clamp(30%, 1400px, 1400px);
            gap: 10px;
		}

		.mainTitle .feature-title,.secondTitle .feature-title {
			text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
			line-height: 1.2;
		}

		.mainTitle .feature-description,.secondTitle .feature-description{
			font-size: 1.8rem;
			font-weight: lighter;
		}
		.mainTitle .cta-button,.secondTitle .cta-button{
			margin-top: 80px;
		}
	.feature-card {
		background: white;
		padding: 2rem;
		border-radius: 20px;
		box-shadow: 0 10px 30px rgba(0,0,0,0.1);
		text-align: right;
		transition: transform 0.3s ease, box-shadow 0.3s ease;
	}

	/* CSS for calculator dropdown */
	.calculator-dropdown {
		position: relative;
		display: inline-block;
		width: 100%;
		margin-top: 0px;
	}

	.calculator-dropdown button {
		width: 100%;
		padding: 15px 25px;
		font-size: 16px;
		font-weight: 600;
		border: none;
		border-radius: 25px;
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 8px;
		transition: all 0.3s ease;
		background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
		color: white;
	}

	.calculator-dropdown button:hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 25px #0183AA;
	}

	.calculator-dropdown button.active {
		border-radius: 25px 25px 0 0;
		box-shadow: 0 4px 15px #0183AA;
	}

	.dropdown-content {
		display: none;
		position: absolute;
		min-width: 100%;
		top: calc(100% - 2px);
		left: 0;
		background: white;
		border: 1px solid rgba(102, 126, 234, 0.2);
		border-radius: 0 0 8px 8px;
		box-shadow: none;
		z-index: 1000;
		margin-top: 0;
		border-top: none;
	}

	.dropdown-content.show {
		display: block;
		animation: dropdownFadeIn 0.3s ease;
	}

	.dropdown-content a {
		color: #333;
		padding: 12px 16px;
		text-decoration: none;
		display: block;
		transition: background-color 0.3s ease;
		font-size: 14px;
		font-weight: 500;
		border-bottom: 1px solid rgba(102, 126, 234, 0.1);
	}

	.dropdown-content a:last-child {
		border-bottom: none;
	}

	.dropdown-content a:hover {
		background-color: #f8f9fa;
		color: #0183AA;
	}

	@keyframes dropdownFadeIn {
		from {
			opacity: 0;
			transform: translateY(-10px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	@keyframes scaleInFromCenter {
		from {
			opacity: 0;
			transform: scale(0.3);
		}
		to {
			opacity: 1;
			transform: scale(1);
		}
	}

	.intro-content {
		animation: scaleInFromCenter 1.4s ease-out;
		transform-origin: center;
	}

	/* CSS for tools dropdown - same styling as calculator dropdown */
	.tools-dropdown {
		position: relative;
		display: inline-block;
		width: 100%;
        max-height: 50px;
		
	}

	.tools-dropdown button {
		width: 100%;
		padding: 15px 25px;
		font-size: 16px;
		font-weight: 600;
		border: none;
		border-radius: 25px;
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 8px;
		transition: all 0.3s ease;
		background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
		color: white;
        margin-bottom: 100px;
        margin-top:0 !important;
	}

	.tools-dropdown button:hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 25px #0183AA;
	}

	.tools-dropdown button.active {
		border-radius: 25px 25px 0 0;
		box-shadow: 0 4px 15px #0183AA;
	}

	.tools-dropdown .dropdown-content {
		display: none;
		position: absolute;
		min-width: 100%;
		top: calc(100% - 2px);
		left: 0;
		background: white;
		border: 1px solid rgba(102, 126, 234, 0.2);
		border-radius: 0 0 8px 8px;
		box-shadow: none;
		z-index: 1000;
		margin-top: 0;
		border-top: none;
	}

	.tools-dropdown .dropdown-content.show {
		display: block;
		animation: dropdownFadeIn 0.3s ease;
	}

	.tools-dropdown .dropdown-content a {
		color: #333;
		padding: 12px 16px;
		text-decoration: none;
		display: block;
		transition: background-color 0.3s ease;
		font-size: 14px;
		font-weight: 500;
		border-bottom: 1px solid rgba(102, 126, 234, 0.1);
	}

	.tools-dropdown .dropdown-content a:last-child {
		border-bottom: none;
	}

	.tools-dropdown .dropdown-content a:hover {
		background-color: #f8f9fa;
		color: #0183AA;
	}
    

	.feature-card:hover {
		transform: translateY(-10px);
		box-shadow: 0 20px 40px rgba(0,0,0,0.15);
	}

	.feature-icon {
		font-size: 3rem;
		margin-bottom: 1rem;
		background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
        text-align: center;
       
	}

	.feature-title {
		font-size: 1.5rem;
		margin-bottom: 1rem;
		color: #333;
        text-align: center;
	}

	.feature-description {
		color: #666;
		margin-bottom: 1.5rem;
        text-align: center;
	}
	
    .logos {
            display: flex;
            overflow: hidden;
            white-space: nowrap;
            width: 100%;
			position: relative;
			bottom: 25px;
			margin: 25px 0px;
        }

        .logos-slide {
            display: flex;
            animation: scroll 20s linear infinite;
        }

        .logos-slide img {
            height: 100px; /* Adjust height as needed */
            margin: 0 20px; /* Space between logos */
            flex-shrink: 0;
        }

        @keyframes scroll {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%); /* Move half the width for seamless loop */
            }
        }

        /* Optional: Pause animation on hover */
        .logos:hover .logos-slide {
            animation-play-state: paused;
        }
		

		.logos-slide img {
			width: 200px; /* Adjust width as needed */
			height: 60px; /* Maintain aspect ratio */
			margin: 10px 80px ; /* Space between logos */
			transition: transform 0.3s ease; /* Smooth scaling effect */
		}
		
		.logos-slide img:last-child {
			margin-right: 0; /* Remove margin from the last image */
		}
  
  
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            max-width: 100%;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            overflow-x: hidden;
			background: #f8fafc;
            margin: 0;
            padding: 0;
            width: 100%;
            max-width: 100vw;
        }
        
        html {
            scroll-behavior: smooth;
            overflow-x: hidden;
            width: 100%;
            max-width: 100vw;
        }
        
        /* וידוא שהדף תמיד מתחיל בחלק העליון */
        html, body {
            scroll-padding-top: 0;
        }

        /* Header */
        .header {
            position:sticky;
            top: 0;
            width: 100% !important;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            z-index: 1000;
            padding: 1rem 0;
            padding-bottom: 0;
            margin-bottom: 0;
            transition: all 0.3s ease;
            max-width:100%;
            margin-right: auto;
            margin-left: auto;
        }

        .nav-container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 80px;
            
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-menu {
            list-style: none;
            display: flex;
            gap: 2rem;
            align-items: center;
            
        }

        .nav-menu a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
            font-size: 16px;
        }

        .nav-menu a:hover {
            color: #0183AA;
        }

        .nav-menu a:hover::after {
            width: 100%;
        }

        .nav-menu a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            right: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            transition: width 0.3s ease;
            
        }

        /* Navigation Dropdown */
        .nav-dropdown {
            position: relative;
        }

        .nav-dropdown .dropdown-content {
            display: flex;
            flex-direction: column;
            position: absolute;
            top: calc(100% - 2px);
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 0 0 8px 8px;
            box-shadow: none;
            min-width: 220px;
            z-index: 1001;
            margin-top: 0;
            border-top: none;
            max-height: 0;
            opacity: 0;
            visibility: hidden;
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease, visibility 0.3s ease;
        }

        .nav-dropdown .dropdown-content a {
            color: #333;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            transition: background-color 0.3s ease;
            font-size: 14px;
            border-bottom: 1px solid #eee;
        }

        .nav-dropdown .dropdown-content a:hover {
            background-color: #f5f5f5;
            color: #0183AA;
        }

        .nav-dropdown .dropdown-content a:last-child {
            border-bottom: none;
        }

        .nav-dropdown .dropdown-content.show {
            max-height: 500px;
            opacity: 1;
            visibility: visible;
        }
        
        /* Desktop hover behavior - only when not using JavaScript */
        @media (min-width: 769px) {
            .nav-dropdown:hover .dropdown-content:not(.show) {
                max-height: 500px;
                opacity: 1;
                visibility: visible;
            }
        }
        #gemelhashpolisa {
            text-align: center;
            font-size: 1.4rem;
            margin-bottom: 20px;
        }
        .cta-button {
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            color: white;
            padding: 8px 24px;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            box-shadow: 0 4px 15px #0183AA;
			margin-bottom: 5px;
            margin-left: auto;
            margin-right: 5%;
            min-width: 90%;
            max-width: 350px;
            min-height: 45px;
            text-align: center;
           
           
        }
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px #0183AA;
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            gap: 4px;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            transition: 0.3s;
            border-radius: 3px;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* Hero Section with Slider - הוסר height: 100vh כדי שה-hero יהיה מותאם לגודל התמונה */
        .hero {
            /* height: 100vh; - הוסר - הגובה נקבע לפי aspect-ratio או padding-top */
            position: relative;
            overflow: hidden;
            display: block;
            align-items: center;
            margin-top: 40px;
        }

        .slider-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .slide.active {
            opacity: 1;
        }

        .slide::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
        }

        /* Slide Backgrounds */
        .slide:nth-child(1) {
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect fill="%23f0f2ff" width="1200" height="800"/><g fill="%23667eea" opacity="0.1"><circle cx="200" cy="200" r="80"/><circle cx="800" cy="300" r="60"/><circle cx="1000" cy="600" r="100"/></g></svg>');
        }

        .slide:nth-child(2) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect fill="%23e6f7ff" width="1200" height="800"/><g fill="%234facfe" opacity="0.1"><rect x="100" y="100" width="100" height="100" rx="10"/><rect x="700" y="200" width="80" height="80" rx="10"/><rect x="900" y="500" width="120" height="120" rx="10"/></g></svg>');
        }

        .slide:nth-child(3) {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect fill="%23fff5e6" width="1200" height="800"/><g fill="%23fa709a" opacity="0.1"><polygon points="200,150 250,100 300,150 250,200"/><polygon points="800,250 850,200 900,250 850,300"/><polygon points="1000,550 1050,500 1100,550 1050,600"/></g></svg>');
        }

        .slide:nth-child(4) {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect fill="%23f0fff4" width="1200" height="800"/><g fill="%23a8edea" opacity="0.1"><ellipse cx="200" cy="200" rx="60" ry="40"/><ellipse cx="800" cy="300" rx="80" ry="50"/><ellipse cx="1000" cy="600" rx="70" ry="45"/></g></svg>');
        }

        .slide:nth-child(5) {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect fill="%23fff0f5" width="1200" height="800"/><g fill="%23ff9a9e" opacity="0.1"><path d="M200 200 L250 150 L300 200 L250 250 Z"/><path d="M800 300 L850 250 L900 300 L850 350 Z"/><path d="M1000 600 L1050 550 L1100 600 L1050 650 Z"/></g></svg>');
        }

        .hero-content {
            position: relative;
            z-index: 10;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 4rem;
            align-items: center;
            height: 100%;
        }

        .hero-text {
            color: white;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            line-height: 1.2;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero-subtitle {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.95;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .hero-cta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .hero-visual {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .hero-icon {
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8rem;
            color: white;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            animation: float 6s ease-in-out infinite;		
        }

      @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
	

        /* Slider Controls */
        .slider-nav {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 20;
        }

        .slider-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .slider-dot.active {
            background: white;
            transform: scale(1.2);
        }

        /* Slider Arrows */
        .slider-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 20;
            transition: all 0.3s ease;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .slider-arrow:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: translateY(-50%) scale(1.1);
        }

        .slider-arrow.prev {
            left: 30px;
			display: flex;
			align-items: center;
			justify-content: center;
        }

        .slider-arrow.next {
            right: 30px;
			display: flex;
			align-items: center;
			justify-content: center;
        }

        /* Features Section */
        .features {
            padding: 6rem 0;
            background: #f8fafc;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 3%;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: right;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            height: 25%;
        }

        .feature-title {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #333;
             height: 15%;
        }

        .feature-description {
            color: #666;
            margin-bottom: 1.5rem;
             height: 30%;
        }

        /* CTA Section */
        .cta-section {
            padding: 4rem 2rem;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            color: white;
            border-radius: 20px;
            margin: 4rem auto;
            width: clamp(300px, 100%, 1400px);
            max-width: 1400px;
            box-shadow: 0 20px 60px #0183AA;
        }
        
        .cta-section .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            gap: 1.5rem;
        }

        .cta-title {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .cta-subtitle {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            opacity: 0.95;
            line-height: 1.6;
            max-width: 800px;
        }

        .cta-button-white {
            background: white;
            color: #0183AA;
            padding: 10px 40px;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-size: 1.2rem;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            width: clamp(300px, 100%, 300px);
        }

        .cta-button-white:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.3);
            background: #f8f9fa;
        }
        
        /* Comparison Modal Styles */
        .comparison-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            backdrop-filter: blur(5px);
            overflow-y: auto;
            padding: 2rem 0;
        }
        
        .comparison-modal.show {
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }
        
        .comparison-card {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: right;
            line-height: 1.8;
            max-width: 900px;
            width: 90%;
            margin: 2rem auto;
            position: relative;
            animation: slideInFromTop 0.4s ease;
        }
        
        @keyframes slideInFromTop {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .comparison-card h2 {
            font-size: 2.2rem;
            margin-bottom: 2rem;
            text-align: center;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .comparison-card h3 {
            font-size: 1.8rem;
            margin: 2.5rem 0 1.5rem;
            color: #333;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .comparison-card h4 {
            font-size: 1.3rem;
            margin: 1.5rem 0 1rem;
            color: #0183AA;
            font-weight: 600;
        }
        
        .comparison-card p {
            color: #555;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .comparison-card ul {
            list-style: none;
            padding: 0;
            margin: 1rem 0 2rem 0;
        }
        
        .comparison-card li {
            margin-bottom: 1rem;
            padding-right: 1.5rem;
            position: relative;
            color: #555;
            font-size: 1.05rem;
        }
        
        .comparison-card li::before {
            content: '✓';
            position: absolute;
            right: 0;
            color: #28a745;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .comparison-card .cons-list li::before {
            content: '✗';
            color: #dc3545;
        }
        
        .comparison-card .summary-box {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            padding: 2rem;
            border-radius: 15px;
            margin-top: 2rem;
            border-right: 4px solid #0183AA;
        }
        
        .comparison-card .summary-box h3 {
            margin-top: 0;
        }
        
        .comparison-card .summary-box p {
            margin-bottom: 0.5rem;
        }
        
        .close-comparison-btn {
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px #0183AA;
            margin-top: 2rem;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        
        .close-comparison-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px #0183AA;
        }
        
        /* Top Performers Table */
        .top-performers-section {
            margin: 3rem 0;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }
        
        .top-performers-section h3 {
            text-align: center;
            color: #0183AA;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }
        
        .performers-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .performers-table thead {
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            color: white;
        }
        
        .performers-table th {
            padding: 15px 12px;
            text-align: center;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .performers-table td {
            padding: 15px 12px;
            text-align: center;
            border-bottom: 1px solid #e2e8f0;
            background: white;
            color: #333;
        }
        
        .performers-table tbody tr:hover {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        
        .performers-table .rank-cell {
            font-weight: bold;
            font-size: 1.2rem;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .performers-table .return-cell {
            font-weight: bold;
            color: #28a745;
            font-size: 1.1rem;
        }
        
        .performers-table .name-cell {
            text-align: right;
            font-weight: 500;
        }
        
        .performers-table .company-cell {
            text-align: right;
            color: #666;
            font-size: 0.9rem;
        }
        
        .loading-spinner {
            text-align: center;
            padding: 2rem;
            color: #0183AA;
        }
        
        .loading-spinner i {
            font-size: 2rem;
            animation: spin 1s linear infinite;
        }
        
        /* Consultation Form Modal */
        #consultationFormModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 10000;
            backdrop-filter: blur(5px);
        }
        
        #consultationFormModal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #consultationFormModal > div {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideInFromTop 0.4s ease;
            position: relative;
        }
        
        #consultationFormModal .close-modal-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: #e74c3c;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(231, 76, 60, 0.3);
            z-index: 10;
        }
        
        #consultationFormModal .close-modal-btn:hover {
            background: #c0392b;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.5);
        }
	.logoimg{
                width: 200px;
                height: auto;
                
            }
	.slider-touch {display: none;}
        
        
        
        #dataDisplayContainer {
            max-width: 1200px;
            width: 100%;
            margin: 20px auto;
            display: none;
            background: #f8fafc;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            box-sizing: border-box;
        }
        
        .data-grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
            width: 100%;
        }
        
        .data-card {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            width: 100%;
        }
        
        /* כרטיסיות מובייל לטבלת סיכום מפורט */
        .cards-container-mobile {
            display: flex;
            flex-direction: column;
            gap: 15px 10px;
            width: 100%;
        }
        
        .product-card-mobile {
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
            width: 100%;
        }
        
        .card-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .card-row:last-child {
            border-bottom: none;
        }
        
        .card-label {
            font-weight: 600;
            color: #4a5568;
            font-size: 0.95rem;
        }
        
        .card-value {
            font-weight: bold;
            font-size: 1rem;
            text-align: left;
        }
         @media (max-width: 1400px) {
            .logoimg{
                width: 200px;
                height: auto;
                
            }
        
         }
        /* Comparison Modal Styles */
        .comparison-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            overflow-y: auto;
        }

        .comparison-modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .comparison-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .comparison-card h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8rem;
            text-align: center;
            border-bottom: 3px solid #0183AA;
            padding-bottom: 15px;
        }

        .comparison-card h3 {
            color: #0183AA;
            margin: 25px 0 15px 0;
            font-size: 1.3rem;
        }

        .comparison-card h4 {
            color: #555;
            margin: 15px 0 10px 0;
            font-size: 1.1rem;
        }

        .comparison-card ul {
            margin: 10px 0;
            padding-right: 20px;
        }

        .comparison-card li {
            margin: 8px 0;
            line-height: 1.6;
        }

        .comparison-card .cons-list {
            color: #e74c3c;
        }

        .summary-box {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #0183AA;
            border-radius: 10px;
            padding: 20px;
            margin: 25px 0;
        }

        .summary-box h3 {
            color: #0183AA;
            margin-bottom: 15px;
        }

        .summary-box p {
            margin: 10px 0;
            font-size: 1.05rem;
        }

        .top-performers-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }

        .top-performers-section h3 {
            text-align: center;
            color: #0183AA;
            margin-bottom: 20px;
        }

        .loading-spinner {
            text-align: center;
            padding: 20px;
        }

        .loading-spinner i {
            font-size: 2rem;
            color: #0183AA;
            margin-bottom: 10px;
        }

        .close-comparison-btn {
            background: linear-gradient(135deg, #0183AA, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            margin-top: 20px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            transition: all 0.3s ease;
        }

        .close-comparison-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px #0183AA;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            #gemelhashpolisa {
                font-size: 1rem;
            }
            .flex-container-row{
                display: flex;
                flex-direction: column;
                gap: 1.5rem;
                width: calc(100% - 1rem);
                margin: 0 0.5rem;
            }
            
            footer{max-width: 100%;box-sizing: border-box;margin: 0;padding: 0;}
            
            .flex-container-row > .feature-card {
                flex: 1;
                min-width: 100%;
                max-width: 100%;
                margin: 0;
            }  
             /* רספונסיביות לרשימות הנפתחות */
             .calculator-dropdown button,
             .tools-dropdown button {
                 font-size: 14px !important;
                 padding: 12px 20px !important;
             }
             
             .data-card-table{
                width:clamp(300px, 100%, 1000px) !important;
             }
             .dropdown-content a,
             .tools-dropdown .dropdown-content a {
                 padding: 12px 18px !important;
                 font-size: 14px !important;
             }
             
             /* תיקון תצוגת קישורים ארוכים במסכים קטנים - מחשבונים */
             .calculator-dropdown .dropdown-content a {
                 white-space: normal !important;
                 overflow: visible !important;
                 text-overflow: unset !important;
                 line-height: 1.4 !important;
                 text-align: center !important;
             }

             /* תיקון תצוגת קישורים ארוכים במסכים קטנים */
             .tools-dropdown .dropdown-content a {
                 white-space: normal !important;
                 overflow: visible !important;
                 text-overflow: unset !important;
                 line-height: 1.4 !important;
                 text-align: center !important;
             }
             
                 /* עיצוב רספונסיבי לתצוגת הנתונים */
                 @media (max-width: 768px) {
                    
                    #detailedSummary{
                        margin-bottom: 15px !important;
                    }
                    .smallfont{
                        font-size: 0.8rem !important;
                    }
                     #dataDisplayContainer {
                         width: clamp(280px, 85vw,280px) !important;
                         margin-right: auto !important;
                         margin-left: auto !important;
                         padding: 15px !important;
                         box-sizing: border-box !important;
                         overflow-x: hidden !important;
                     }
                 
                 .data-grid-container {
                     display: flex !important;
                     flex-direction: column !important;
                     gap: 15px !important;
                     grid-template-columns: unset !important;
                     width: clamp(280px, 85vw,280px) !important;
                     margin-bottom: 15px !important;
                     align-items: center !important;
                 }
                 
                 .data-card {
                     width: 100% !important;
                     max-width: 100% !important;
                     padding: 15px !important;
                     box-sizing: border-box !important;
                    
                 }
                 
                 .product-card-mobile {
                     width: 100% !important;
                     padding: 15px !important;
                     margin-bottom: 12px !important;
                     box-sizing: border-box !important;
                 }
                 
                 .cards-container-mobile {
                     width: 100% !important;
                 }
                 
                 .card-row {
                     padding: 8px 0 !important;
                     flex-wrap: wrap !important;
                 }
                 
                 .card-label {
                     font-size: 0.85rem !important;
                     flex: 1 !important;
                     min-width: 140px !important;
                 }
                 
                 .card-value {
                     font-size: 0.9rem !important;
                     text-align: right !important;
                 }
                 
                 #dataDisplayContainer h2 {
                     font-size: 1.2rem !important;
                     text-align: center !important;
                     line-height: 1.3 !important;
                     padding: 0 5px !important;
                 }
                 
                 #dataDisplayContainer h3 {
                     font-size: 0.9rem !important;
                     white-space: normal !important;
                     text-align: center !important;
                     line-height: 1.3 !important;
                     padding: 0 5px !important;
                 }
                 
                 #dataDisplayContainer p {
                     font-size: 0.85rem !important;
                     padding: 0 5px !important;
                     line-height: 1.4 !important;
                 }
                 
                 #dataDisplayContainer table {
                     font-size: 0.6rem !important;
                     width: 100% !important;
                     overflow-x: auto !important;
                 }
                 
                 #dataDisplayContainer #detailedSummary {
                     overflow-x: auto !important;
                     width: 100% !important;
                     -webkit-overflow-scrolling: touch !important;
                 }
                 
                 #dataDisplayContainer canvas {
                     max-width: 100% !important;
                     width: 100% !important;
                     height: auto !important;
                 }
                 
                 #dataDisplayContainer #pieChart {
                     max-height: 200px !important;
                     max-width: 100% !important;
                 }
                 
                 #dataDisplayContainer th,
                 #dataDisplayContainer td {
                     padding: 4px 2px !important;
                     font-size: 0.6rem !important;
                 }
                 
                 #dataDisplayContainer th {
                     font-size: 0.65rem !important;
                     line-height: 1.2 !important;
                 }
                 
                 /* עיצוב רספונסיבי לכרטיסיות */
                 .chart-actions {
                     flex-direction: column !important;
                     align-items: center !important;
                     gap: 10px !important;
                 }
                 
                 .chart-action-btn {
                     width: 90% !important;
                     max-width: 300px !important;
                     margin: 0 auto !important;
                 }
                 
                 /* עיצוב רספונסיבי לכפתורים בתצוגת הנתונים */
                 #dataDisplayContainer > div:last-child {
                     display: flex !important;
                     flex-direction: column !important;
                     align-items: center !important;
                     gap: 15px !important;
                 }
                 
                #dataDisplayContainer button {    
                    margin: 5px auto !important;
                    padding: 5px 15px !important;
                    font-size: 0.9rem !important;
                    box-sizing: border-box !important;
                    white-space: normal !important;
                    line-height: 1.3 !important;
                }
                
                 /* תיקון עבור כרטיסיות שאינן בתוך dataDisplayContainer */
                 .flex-container-row > .feature-card {
                     width: 100% !important;
                     max-width: 100% !important;
                     
                 }
                 
                 /* עיצוב רספונסיבי לטופס ייעוץ פנסיוני */
                #consultationFormModal > div {
                    padding: 25px !important;
                    max-width: 95% !important;
                    width: 95% !important;
                    max-height: 70vh !important;
                    margin: 0 !important;
                }
                
            
                
                #consultationFormModal h3 {
                    font-size: 1.5rem !important;
                }
                
                #consultationFormModal p {
                    font-size: 0.95rem !important;
                }
                
                #consultationFormModal input,
                #consultationFormModal textarea {
                    font-size: 1rem !important;
                    padding: 12px !important;
                }
                
                #consultationFormModal button {
                    padding: 14px 24px !important;
                    font-size: 1rem !important;
                }
                 
                 /* עיצוב רספונסיבי ל-file-upload-section */
                 .file-upload-section {
                     max-width: 100% !important;
                     width: 100% !important;
                     margin: 0 !important;
                     padding: 2rem 0.5rem !important;
                     box-sizing: border-box !important;
                 }
                 
                 .file-upload-container {
                     max-width: 100% !important;
                     width: 100% !important;
                     padding: 0 0.5rem !important;
                     box-sizing: border-box !important;
                 }
             }
		.hero-text h1 {
            font-size: 1.5rem;
        }
        .slider-arrow.prev,.slider-arrow.next {
           display: none;
        }
		.mainTitle,.secondTitle {
			margin-left: 0.5rem;
			margin-right: 0.5rem;
			padding: 10px;
			width: calc(100% - 1rem);
		}
		.mainTitle .feature-card,.secondTitle .feature-card {
			flex-direction: column;
			align-items: center;
			gap: 2rem;
			width: 100%;
			margin: 0;
		}
		.mainTitle .cta-button,.secondTitle .cta-button{
			margin-top: -35px;
			font-size: 1rem;
			
		}
		.mainTitle .feature-title,.secondTitle .feature-title{
			font-size: 1.8rem;
			padding-bottom: 0%;
			margin-bottom: 0%;
            text-align: center;
            text-wrap: wrap;
		}
		.mainTitle .hero-icon,.secondTitle .hero-icon{
			margin-top: 40px;
		}
		.mainTitle .feature-description,.secondTitle .feature-description{
			display: flex;
			padding-bottom: 25px;
			font-size: 1.2rem;
			height: auto;
            text-align: right;
            text-wrap: wrap;
			
		}
            .feature-title {
               height: 25%;}

            .logoimg{
                width: 150px;
                height: auto;
            }
			
			.header {
				padding: 1rem 0;
                padding-bottom: 0;
                width: 100%;
                margin: 0%;
                margin-bottom: 0;
			}

			.nav-container {
				padding: 1rem 1rem;
			}

		.nav-menu {
            position: fixed;
            top: 80px;
            right: 0;
            width: 100%;
            height: calc(100vh - 80px);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding-top: 2rem;
            display: flex;
            opacity: 0;
            visibility: hidden;
            transform: translateX(100%);
            transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
		}

		.hamburger {
			display: flex;
		}

		.nav-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
            margin-top: -25px; 
		}
        .nav-menu.active li,.nav-menu.active li a{
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-left: auto;
            margin-right: auto;
            width: 100%;
        }
            /* Mobile nav-dropdown adjustments */
            .nav-dropdown .dropdown-content {
                position: relative;
                display: flex;
                flex-direction: column;
                min-width: auto;
                width: clamp(200px, 100%, 270px);
                max-height: 0;
                opacity: 0;
                visibility: hidden;
                overflow: hidden;
                border: none;
                background:white;
                margin-top: 5px;
                top: auto;
                border-radius: 15px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                padding: 0;
                transition: max-height 0.3s ease, opacity 0.3s ease, visibility 0.3s ease, padding-top 0.3s ease;
                }

                .nav-dropdown .dropdown-content a {
                padding: 8px 16px;
                border-bottom: 1px solid rgba(255,255,255,0.1);
                font-size: 1rem;
                }

                .nav-dropdown .dropdown-content.show {
                max-height: 500px;
                opacity: 1;
                visibility: visible;
                padding-top: 15px;
                }

            .hamburger {
                display: flex;
                padding-left: 5%;
            }

            .hero-content {
                grid-template-columns: 1fr;
                text-align: right;
                gap: 2rem;
                padding: 2rem 1rem;
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .hero-subtitle {
				display: flex;
				justify-content: center;
				align-items: center;
                font-size: 1.1rem;
				
            }

            .hero-icon {
                width: 120px;
                height: 120px;
                font-size: 3.5rem;
            }

            .hero-cta {
                justify-content: center;
            }

            .features-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
				margin-right: 0;
				margin-left: 0;
            }
            
            .feature-card {
                margin-right: 0;
                margin-left: 0;
                width: 100%;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .containerCards {
                margin: 0 0.5rem !important;
            }
            
            .comparison-modal {
                padding: 1rem 0;
            }
            
            .comparison-card {
                padding: 2rem 1.5rem;
                width: 95%;
                margin: 1rem auto;
            }
            
            .comparison-card h2 {
                font-size: 1.6rem;
                line-height: 1.3;
            }
            
            .comparison-card h3 {
                font-size: 1.4rem;
                flex-direction: column;
                align-items: flex-start;
            }
            
            .comparison-card h4 {
                font-size: 1.2rem;
            }
            
            .comparison-card p,
            .comparison-card li {
                font-size: 0.95rem;
                line-height: 1.6;
            }
            
            .comparison-card .summary-box {
                padding: 1.5rem;
            }
            
            .close-comparison-btn {
                padding: 12px 30px;
                font-size: 1rem;
            }
            
            .top-performers-section {
                padding: 1.5rem 1rem;
            }
            
            .top-performers-section h3 {
                font-size: 1.4rem;
            }
            
            .performers-table th,
            .performers-table td {
                padding: 10px 6px;
                font-size: 0.85rem;
            }
            
            .performers-table .rank-cell {
                font-size: 1rem;
            }
            
            .performers-table .return-cell {
                font-size: 0.95rem;
            }
            
            .performers-table .company-cell {
                font-size: 0.8rem;
            }
            
            /* הסתרת עמודת מ"ה במסכים קטנים */
            .performers-table .mh-column {
                display: none;
            }
            
            .performers-table {
                width: 100%;
                overflow-x: hidden;
            }
            
            .performers-table .name-cell,
            .performers-table .company-cell {
                text-align: right;
                padding: 10px 8px;
            }

            .section-title {
                font-size: 1.5rem;
                text-align: center;
                text-wrap: wrap;
            }

            .cta-title {
                font-size: 2rem;
            }

            .slider-arrow {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }

            .slider-arrow.prev {
                right: 15px;
            }

            .slider-arrow.next {
                left: 15px;
            }
			.slider-touch {
				width: 100%;
				font-size: 1.2rem;
				color: #fff;
				z-index: 1000;
				position: relative;
				top:10%;
				display: flex;
				justify-content: space-between;
				padding: 0 20px;

			}
			.cta-section{
				margin: 2rem 0.5rem;
				padding: 3rem 1.5rem;
				width: calc(100% - 1rem);
			}
			
			.cta-title {
				font-size: 2rem;
			}
			
			.cta-subtitle {
				font-size: 1.1rem;
			}
			
			.cta-button-white {
				padding: 10px 30px;
				font-size: 1rem;
			}
        .logos-slide img {
			width: 150px; /* Adjust width as needed */
			height: 45px; /* Maintain aspect ratio */
			margin: 10px 60px ; /* Space between logos */
			transition: transform 0.3s ease; /* Smooth scaling effect */
		}
		#altshuler-logo{
			width:70px; /* Adjust width as needed */
			height: 45px;	
		}
		}
		.container .feature-card{
			display: flex;
			flex-direction: column;
			align-items:space-between;
			justify-content: center;
			border-radius: 20px;
            width: 100%;
            padding: 0%;
            margin: 0%;
		}
        .hatid{
            white-space: nowrap;
        }
        
        /* File Upload Section Styles */
        .file-upload-section {
            padding: 6rem 0;
            background: #f8fafc;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .file-upload-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .file-upload-area {
            border: 3px dashed #0183AA;
            border-radius: 20px;
            padding: 3rem 2rem;
            text-align: right;
            background: white;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .file-upload-area:hover {
            border-color: #764ba2;
            background: #f8fafc;
            transform: translateY(-5px);
        }
        
        .file-upload-area.dragover {
            border-color: #764ba2;
            background: #f0f2ff;
            transform: scale(1.02);
        }
        
        .upload-icon {
            font-size: 4rem;
            color: #0183AA;
            margin-bottom: 1rem;
        }
        
        .file-upload-area h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .file-upload-area p {
            color: #666;
            margin-bottom: 2rem;
        }
        
        .uploaded-files {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .uploaded-files h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .files-list {
            margin-bottom: 2rem;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 10px;
            margin-bottom: 0.5rem;
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .file-icon {
            font-size: 1.5rem;
            color: #0183AA;
        }
        
        .file-name {
            font-weight: 500;
            color: #333;
        }
        
        .file-size {
            color: #666;
            font-size: 0.9rem;
        }
        
        .file-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .delete-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
            padding: 20px 5px;
        }
        
        .delete-btn:hover {
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.6);
        }
        
        .file-data-display {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .file-data-display h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #333;
        }
        
        .data-content {
            background: #f8fafc;
            border-radius: 10px;
            padding: 1.5rem;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .data-table th,
        .data-table td {
            padding: 0.75rem;
            text-align: right;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .data-table th {
            background: #0183AA;
            color: white;
            font-weight: bold;
        }
        
        .data-table tr:hover {
            background: #f1f5f9;
        }
        
        .loading {
            text-align: right;
            padding: 2rem;
            color: #0183AA;
        }
        
        .loading i {
            font-size: 2rem;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Chart Styles */
        .chart-container {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .chart-wrapper {
            position: relative;
            width: 80%;
            max-width: 400px;
        }
        
        #myDoughnutChart {
            width: 100% !important;
            height: auto !important;
        }
        
        .custom-legend {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background-color: #f9f9f9;
            text-align: right;
            width: 100%;
            max-width: 500px;
            box-sizing: border-box;
        }
        
        .custom-legend h3 {
            margin-bottom: 10px;
            color: #333;
        }
        
        .legend-item {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            width: 100%;
            flex-wrap: wrap;
        }
        
        .legend-color-box {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        .legend-label {
            font-size: 16px;
            color: #333;
            flex-grow: 1;
        }
        
        .legend-value {
            font-size: 16px;
            color: #0183AA;
            font-weight: bold;
        }
        
        /* Advanced Analysis Styles */
        .advanced-analysis-section {
            padding: 6rem 0;
            background: #f8fafc;
        }
        
        /* עיצוב רספונסיבי לניתוח מתקדם */
        @media (max-width: 768px) {
            .advanced-analysis-section {
                padding: 3rem 0 !important;
            }
            
            .analysis-tabs {
                flex-direction: column !important;
                align-items: center !important;
                gap: 0.5rem !important;
                margin-bottom: 2rem !important;
            }
            
            .tab-button {
                width: 90% !important;
                max-width: 300px !important;
                margin: 0 auto !important;
                padding: 15px 20px !important;
                font-size: 0.9rem !important;
            }
            
            .analysis-content {
                padding: 0 1rem !important;
            }
            
            /* תיקון התצוגה במובייל - הכל אחד מעל השני */
            .analysis-grid {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }
            
            .summary-grid {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }
            
            /* תיקון התצוגה של הפרטים האישיים והגרף */
            div[style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
                gap: 20px !important;
            }
            
            .analysis-content h3 {
                font-size: 1.2rem !important;
                text-align: center !important;
            }
            
            .analysis-content table {
                font-size: 0.7rem !important;
                overflow-x: auto !important;
            }
            
            .analysis-content th,
            .analysis-content td {
                padding: 8px 4px !important;
                white-space: nowrap !important;
            }
            
            .analysis-content .container {
                padding: 0 1rem !important;
            }
            
            /* עיצוב רספונסיבי לטבלת פיצויים */
            #pitzuimTable {
                min-width: 100% !important;
                width: 100% !important;
                display: block !important;
                overflow-x: auto !important;
            }
            #pitzuimTable thead,
            #pitzuimTable tbody,
            #pitzuimTable tr {
                display: table !important;
                width: 100% !important;
            }
            #pitzuimTable th,
            #pitzuimTable td {
                font-size: 0.55rem !important;
                padding: 4px 2px !important;
                min-width: auto !important;
                white-space: nowrap !important;
            }
            #pitzuimTable th {
                font-size: 0.55rem !important;
                line-height: 1.1 !important;
            }
        }
        
        .analysis-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }
        
        .tab-button {
            background: white;
            color: #0183AA;
            padding: 12px 24px;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .tab-button:hover {
            background: #0183AA;
            color: white;
            transform: translateY(-2px);
        }
        
        .tab-button.active {
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            color: white;
            border-color: #0183AA;
        }
        
        .tab-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .tab-panel {
            display: none;
        }
        
        .tab-panel.active {
            display: block;
        }
        
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .analysis-card {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 15px;
            border: 1px solid #e2e8f0;
        }
        
        .analysis-card h4 {
            color: #0183AA;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .chart-container-small {
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .comparison-table {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            border: 1px solid #e2e8f0;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .summary-card {
            background: #f8fafc;
            padding: 2rem;
            border-radius: 15px;
            border: 1px solid #e2e8f0;
            text-align: right;
        }
        
        .score-display {
            font-size: 3rem;
            font-weight: bold;
            color: #28a745;
            margin: 1rem 0;
        }
        
        .recommendations {
            text-align: right;
            line-height: 1.6;
        }
        
        .recommendations-list {
            text-align: right;
            line-height: 1.8;
        }
        
        .analysis-actions {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 3rem;
            flex-wrap: wrap;
        }
        
        .retirement-analysis {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            border: 1px solid #e2e8f0;
            min-height: 200px;
        }
        
        .retirement-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .retirement-item:last-child {
            border-bottom: none;
        }
        
        .retirement-label {
            font-weight: 500;
            color: #4a5568;
        }
        
        .retirement-value {
            font-weight: bold;
            color: #2d3748;
        }
        
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 1.5rem;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .data-table th,
        .data-table td {
            padding: 16px 20px;
            text-align: right;
            border: none;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .data-table[dir="rtl"] {
            direction: rtl;
        }
        
        .data-table[dir="rtl"] th,
        .data-table[dir="rtl"] td {
            text-align: right;
        }
        
        .data-table th {
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            color: white;
            font-weight: 600;
            font-size: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
        }
        
        .data-table th:first-child {
            border-top-right-radius: 12px;
        }
        
        .data-table th:last-child {
            border-top-left-radius: 12px;
        }
        
        .data-table tbody tr {
            transition: all 0.3s ease;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .data-table tbody tr:hover {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .data-table tbody tr:nth-child(even) {
            background: #fafbfc;
        }
        
        .data-table tbody tr:nth-child(even):hover {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        }
        
        .data-table td {
            color: #2d3748;
            font-weight: 500;
        }
        
        .data-table tbody tr:last-child td:first-child {
            border-bottom-right-radius: 12px;
        }
        
        .data-table tbody tr:last-child td:last-child {
            border-bottom-left-radius: 12px;
        }
        
        .retirement-details {
            margin-top: 2rem;
        }
        
        .retirement-details h4 {
            color: #2d3748;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #0183AA;
            display: inline-block;
        }
        
        .retirement-summary {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .retirement-summary h4 {
            color: #2d3748;
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #0183AA;
            display: inline-block;
        }
        
        .currency-value {
            font-family: 'Courier New', monospace;
            font-weight: 600;
            color: #2d3748;
            background: linear-gradient(135deg, #e6fffa 0%, #f0fff4 100%);
            padding: 4px 8px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            display: inline-block;
            min-width: 120px;
            text-align: right;
        }
        
        .not-relevant {
            color: #a0aec0;
            font-style: italic;
            background: #f7fafc;
            padding: 4px 8px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            display: inline-block;
        }
        
        .product-type {
            font-weight: 600;
            color: #4a5568;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            padding: 6px 12px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            display: inline-block;
            min-width: 150px;
            text-align: right;
        }
        
        .retirement-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .retirement-item:hover {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding-left: 8px;
            padding-right: 8px;
            border-radius: 8px;
        }
        
        .retirement-item:last-child {
            border-bottom: none;
        }
        
        .retirement-label {
            font-weight: 500;
            color: #4a5568;
            font-size: 15px;
        }
        
        .retirement-value {
            font-weight: 600;
            color: #2d3748;
            font-size: 16px;
        }
        
        .data-table tr:nth-child(even) {
            background: #f8fafc;
        }
        
        .data-table tr:hover {
            background: #e2e8f0;
        }
        
        .close-section-btn:hover {
            background: #c82333 !important;
            transform: scale(1.1);
        }
        
        .section-header {
            position: relative;
        }
        
        .chart-action-btn {
            min-width: 120px;
            max-width: 150px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        @media screen and (max-width: 768px) {
            .chart-actions {
                flex-direction: column !important;
                align-items: center !important;
                gap: 0.5rem !important;
            }
            
            .chart-action-btn {
                width: 200px;
                max-width: 200px;
                
            }
        }
        
        @media screen and (max-width: 480px) {
            .hatid{
                white-space: normal;
                font-size: 1.5rem;
            }
            .choose-us-title-text{
                font-size: 1.5rem;
            }
            .mutzarimText{
                font-size: 1.3rem !important;
            }
            
            .file-upload-area {
                padding: 2rem 1rem;
            }
            
            #dataDisplayContainer {
                width:clamp(280px, 85vw,280px) !important;
                margin-left: auto !important;
                margin-right:  auto !important;
                padding: 10px !important;
            }
            
            .data-card {
                padding: 12px !important;
                width: 100% !important;
            }
            .data-card button{
                padding: 5px 15px !important;
            }
            
            .product-card-mobile {
                padding: 5px !important;
                width: 100% !important;
            }
            
            .product-card-mobile h4 {
                font-size: 0.9rem !important;
            }
            
            .card-label {
                font-size: 0.75rem !important;
                min-width: 120px !important;
            }
            
            .card-value {
                font-size: 0.8rem !important;
            }
            
            #dataDisplayContainer h2 {
                font-size: 1rem !important;
                padding: 0 3px !important;
            }
            
            #dataDisplayContainer h3 {
                font-size: 0.8rem !important;
                padding: 0 3px !important;
            }
            
            #dataDisplayContainer p {
                font-size: 0.7rem !important;
            }
            
            #dataDisplayContainer button {
                font-size: 0.7rem !important;
                padding: 8px !important;

            }
            
            #dataDisplayContainer table {
                font-size: 0.5rem !important;
            }
            
            #dataDisplayContainer th,
            #dataDisplayContainer td {
                padding: 3px 1px !important;
            }
            
            /* תיקון נוסף למובייל קטן - תפריטים נפתחים */
            .calculator-dropdown .dropdown-content a,
            .tools-dropdown .dropdown-content a {
                padding: 15px 10px !important;
                font-size: 13px !important;
                line-height: 1.5 !important;
                text-align: center !important;
                white-space: normal !important;
                word-wrap: break-word !important;
            }
            
            .calculator-dropdown button,
            .tools-dropdown button {
                font-size: 13px !important;
                padding: 10px 15px !important;
            }
            
            /* תיקון נוסף למובייל קטן */
            .analysis-grid,
            .summary-grid {
                grid-template-columns: 1fr !important;
                gap: 0.5rem !important;
            }
            
            div[style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }
            
            .upload-icon {
                font-size: 3rem;
            }
            .upload-icon-small {
                display: none;
            }
            .file-upload-area h3 {
                font-size: 1.2rem;
            }
            
            .file-actions {
                flex-direction: column;
            }
            
            .file-item {
                flex-direction: column;
                gap: 0.5rem;
                text-align: right;
            }
        }
        
    </style>
    
    <!-- External Modal Styles -->
    <link rel="stylesheet" href="about-modal.css">
    <link rel="stylesheet" href="consultation-form.css">
    <link rel="stylesheet" href="terms-modal.css">
    <link rel="stylesheet" href="terms-consent.css">
    <link rel="stylesheet" href="risk-quest-modal.css">
    <link rel="stylesheet" href="professional-info-modal.css">
    
    <!-- Accessibility and Footer -->
    <link rel="stylesheet" href="mainStyle.css">
    <link rel="stylesheet" href="footer.css">
    
    <style>
    /* עיצוב הכללי של הקונטיינר של הטופס */
/* עיצוב הכללי של הקונטיינר */
.col-lg-9.mx-auto.text-center {
  background-color: #2983b3; /* צבע רקע כהה */
  padding: 40px;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  margin-bottom: 40px;
  max-width: 1000px;
  margin: 10px auto;
  text-align: center;
}
@media screen and (max-width: 767px) {
  .col-lg-9.mx-auto.text-center {
    padding: 20px;
    margin: 10px;
    max-width: 100%;
  }
    
}
/* עיצוב הכותרת */
.intro-title {
  font-size: 36px;
  font-weight: bold;
  color: white; /* צבע האתר לכותרת */
  margin-bottom: 20px;
  text-transform: uppercase; /* טקסט באותיות גדולות */
  max-width: 1000px;
}

/* עיצוב התוכן (הפסקה) */
.intro-content {
  font-size: 18px;
  color: #fff; /* טקסט לבן */
  line-height: 1.6;
}

/* עיצוב התוכן במובייל - קטן יותר, נגיש יותר */
@media (max-width: 767px) {
  .intro-title {
    font-size: 28px;
  }

  .intro-content {
    font-size: 16px;
    text-align: center;
  }
}


.simple-form-container {
  background-color:#0183AA; /* צבע רקע כהה */
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    max-width: 1000px;
    margin: 0 auto;
}

/* עיצוב של הכותרת הראשית של הטופס */
.header-line {
  text-align: center;
  margin-bottom: 20px;
}

.header-line img {
  width: 100%;
  max-width: 300px;
  margin-top: 10px;
}

/* עיצוב של הרקע עבור הטופס */
.agent-bg {
  background-color: #0183AA; /* צבע רקע כהה ומעט בהיר יותר */
  padding: 20px;
  border-radius: 8px;
}

/* עיצוב של כל שדה טופס */
.agent-form .input-col {
  margin-bottom: 20px;
}

.agent-form input[type="text"], 
.agent-form input[type="email"], 
.agent-form input[type="tel"], 
.agent-form select {
  width: 100%;
  padding: 12px;
  background-color: #fff; /* צבע רקע לבן לשדות */
  border: 1px solid #0183AA; /* גבול בצבע האתר */
  border-radius: 8px;
  font-size: 16px;
  color: #333; /* צבע טקסט כהה */
}

/* עיצוב עבור כפתור הסכמה */
.agent-form .wpcf7-acceptance {
  color: #fff; /* טקסט לבן */
  font-size: 14px;
}

.agent-form .wpcf7-acceptance input {
  margin-right: 8px; /* רווח בין תיבת הסימון לטקסט */
}

/* עיצוב עבור כפתור שלח */
.submit-col p input[type="submit"] {
  background-color: #3aafe6; /* צבע האתר */
  color: white;
  border: none;
  padding: 12px 25px;
  font-size: 18px;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease;
  margin-right: 80%;
}

.submit-col p input[type="submit"]:hover {
  background-color: #139276; /* צבע כהה יותר בעת hover */
}

/* עיצוב לטופס רספונסיבי */
@media (max-width: 767px) {
  .simple-form-container {
    padding: 15px;
  }

  .header-line img {
    max-width: 100%;
  }

  .agent-form .input-col {
    margin-bottom: 10px;
  }
}

    

        /* Scroll to Top Button - Mobile Only */
        #scrollToTopBtn {
            display: none;
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 999;
            width: 45px;
            height: 45px;
            background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 12px #0183AA;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }
#adviceBtnFloat {
    display: none;             /* משתמש ב-flexbox למרכז את התוכן */
    justify-content: center;   /* ממקם את הטקסט במרכז אופקית */
    align-items: center;       /* ממקם את הטקסט במרכז אנכית */
    position: fixed;
    background-color:white;
    color:#0a4512;
    font-weight: bold;
    border: 2px solid #0183AA;
    z-index: 999;
    bottom: 20vh;
     left: 50%;                
    transform: translateX(-50%);
    width: clamp(150px, 30%, 200px);
    height: 45px;
    padding: 0;                /* מבטל ריפוד כדי ש-flexbox יתפקד טוב */
    font-size: 1rem;
    border-radius: 25px;
    cursor: pointer;
    box-shadow: 0 4px 12px #0183AA;
    transition: all 0.3s ease;
}

#adviceBtnFloat span {
    display: block;            /* ה-span צריך להיות בלוק כדי שה-flexbox יפעל */
    text-align: center;        /* כדי לוודא שהטקסט בתוך ה-span ממורכז */
}

        #scrollToTopBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px #0183AA;
        }
        
        #adviceBtnFloat:hover {
            transform: translateX(-50%) translateY(-3px);
            box-shadow: 0 6px 16px #0183AA;
        }
        
        #scrollToTopBtn.show {
            display: block;
        }
        #adviceBtnFloat.show {
            display: flex;
        }
        @media (min-width: 769px) {
            #scrollToTopBtn {
                display: none !important;
            }
        }
        
        /* Pension Clearance Tooltip */
        .pension-clearance-link {
            position: relative;
            display: inline-block;
            color: #0183AA;
            font-weight: bold;
            cursor: pointer;
            text-decoration: underline;
            text-decoration-style: dotted;
            text-underline-offset: 3px;
        }
        
        .pension-tooltip {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            bottom: 140%;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            color: #333;
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 500;
            line-height: 1.6;
            max-width: 320px;
            width: max-content;
            z-index: 9999;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            border: 2px solid #0183AA;
            transition: all 0.3s ease;
            pointer-events: none;
            white-space: normal;
            text-align: center;
        }
        
        .pension-tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -10px;
            border-width: 10px;
            border-style: solid;
            border-color: white transparent transparent transparent;
        }
        
        .pension-tooltip::before {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -12px;
            border-width: 12px;
            border-style: solid;
            border-color: #0183AA transparent transparent transparent;
            z-index: -1;
        }
        
        .pension-clearance-link:hover .pension-tooltip {
            visibility: visible;
            opacity: 1;
            bottom: 150%;
            pointer-events: auto;
        }
        
        .pension-tooltip strong {
            color: #0183AA;
            text-decoration: underline;
            font-weight: 700;
            transition: opacity 0.2s ease;
            cursor: pointer;
        }
        
        .pension-tooltip strong:hover {
            opacity: 0.7;
        }
        
        .pension-tooltip i {
            margin-left: 8px;
            color: #0183AA;
            font-size: 16px;
        }
        
        /* Responsive - Mobile & Tablet */
        @media (max-width: 1024px) {
            .pension-tooltip {
                font-size: 14px;
                padding: 14px 18px;
                max-width: 280px;
                left: auto;
                right: 0;
                transform: none;
            }
            
            .pension-tooltip::after {
                left: auto;
                right: 20px;
            }
            
            .pension-tooltip::before {
                left: auto;
                right: 18px;
            }
        }
        #consultationFormBtn{
            background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3); padding: 12px 30px; border-radius: 25px; font-size: 1rem; font-weight: bold; cursor: 
            pointer; transition: all 0.3s ease; backdrop-filter: blur(10px);
           }
        @media (max-width: 480px) {
            .pension-tooltip {
                font-size: 13px;
                padding: 12px 14px;
                max-width: 240px;
            }
            .xml-title{
                font-size: 1.2rem;
                margin-bottom: 0.5rem;
            }
           #consultationFormBtn{
            width:clamp(200px, 70%, 250px) !important;
            background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.3); padding: 12px 30px; border-radius: 25px; font-size: 1rem; font-weight: bold; cursor: 
            pointer; transition: all 0.3s ease; backdrop-filter: blur(10px);
           }
			.yitrotgilprish{
				text-decoration:underline;
				font-weight:bold;
			}
        }
    </style>
</head>

<body dir="rtl">
    
    <!-- Scroll to Top Button (Mobile Only) -->
    <button id="scrollToTopBtn" onclick="scrollToTop()" title="חזור למעלה">
        <i class="fas fa-arrow-up"></i>
    </button>
    <button id="adviceBtnFloat" onclick="openConsultationForm()" title="קבל ייעוץ חינם">
        <span>קבל ייעוץ חינם</span></button>

    <header class="header" dir="rtl">
        <div class="nav-container">   
            <nav class="nav-menu" id="navMenu">
                <li class="nav-dropdown">
                    <a href="#" onclick="toggleNavProductsDropdown(event)">מוצרים ותשואות ▼</a>
                    <div class="dropdown-content" id="navProductsDropdown">
                        <a href="mozarim.html?product=hishtalmut">קרנות השתלמות</a>
                        <a href="mozarim.html?product=gemel">קופות גמל</a>
                        <a href="mozarim.html?product=gemelHashkaa">קופות גמל להשקעה</a>
                        <a href="mozarim.html?product=yeled">חסכון לילד</a>
                        <a href="mozarim.html?product=polisot">פוליסות חסכון</a>
                        <a href="mozarim.html?product=pensia">קרנות פנסיה חדשות</a>
                        <a href="mozarim.html?product=pensiaKlalit">קרנות פנסיה כלליות</a>
                    </div>
                </li>
                <li class="nav-dropdown">
                    <a href="#" onclick="toggleNavCalculatorDropdown(event)">מחשבונים ▼</a>
                    <div class="dropdown-content" id="navCalculatorDropdown">
                        <a href="prisatMaanak.html">פריסת מענק פרישה</a>
                        <a href="calac.html">מחשבון דחיית קצבה</a>
                        <a href="ribitderibit.html">חישוב ערך עתידי</a>
                        <a href="loan.html">סימולטור הלוואה</a>
                        <a href="hafkada.html">מחשבון הפקדה לסכום מטרה</a>
                        <a href="hashDmeyNihul.html">השוואת דמי ניהול</a>
                    </div>
                </li>
                <li class="nav-dropdown">
                    <a href="#" onclick="toggleNavToolsDropdown(event)">כלי השוואה ▼</a>
                    <div class="dropdown-content" id="navToolsDropdown">
                        <a href="hashMenahalot.html">השוואת חברות מנהלות</a>
                        <a href="hasifotMeshulav.html">מחולל חשיפות</a>
                        <a href="VirtualInvest.html">השוואת תיק משולב מסלולים</a>
                        <a href="#">ציון משקל תשואה לשארפ</a>
                    </div>
                </li>
                <li><a href="https://shaham-orlan.co.il/%d7%90%d7%95%d7%93%d7%95%d7%aa/" >אודות</a></li>
                <li><a href="#contact" onclick="openConsultationForm(); return false;">צור קשר</a></li>
                <li class="whatsapp-desktop"><a href="https://wa.me/972545287184?text=שלום, אני מעוניין בייעוץ פנסיוני" target="_blank" title="צור קשר בוואטסאפ"><i class="fab fa-whatsapp" style="font-size:2rem; color:#0183AA;"></i></a></li>
            </nav>
            <div class="whatsapp-mobile">
                <a href="https://wa.me/972545287184?text=שלום, אני מעוניין בייעוץ פנסיוני" target="_blank" title="צור קשר בוואטסאפ">
                    <i class="fab fa-whatsapp" style="font-size:2rem; color:#0183AA"></i>
                </a>
            </div>
            <div class="header-topper">	
		
            <div class="header-socials" style="display: flex;flex-direction: row;justify-content: space-between;width: 250px;">
                <div class="soc"><a href="https://www.facebook.com/shaham.orlan/" rel="nofollow" target="_blank"><i style="font-size:20px;color:#0183AA;" class="fa-brands fa-facebook" aria-hidden="true"></i></a></div>
                <div class="soc"><a href="https://www.instagram.com/shaham_orlan_insurance/" rel="nofollow" target="_blank"><i style="font-size:20px;color:#0183AA;" class="fa-brands fa-instagram" aria-hidden="true"></i></a></div>
                <div class="soc"><a href="https://www.linkedin.com/in/shaham-orlan-insurance-5135582a/" rel="nofollow" target="_blank"><i style="font-size:20px;color:#0183AA;" class="fa-brands fa-linkedin" aria-hidden="true"></i></a></div>
                <div class="soc"><a href="https://twitter.com/shaham_ins" rel="nofollow" target="_blank"><i style="font-size:20px;color:#0183AA;" class="fa-brands fa-twitter" aria-hidden="true"></i></a></div>
                <div class="soc"><a href="https://www.tiktok.com/@shaham.orlan.ins?_t=8mr1hvjy0ih&amp;_r=1" rel="nofollow" target="_blank"><i style="font-size:20px;color:#0183AA;" class="fa-brands fa-tiktok" aria-hidden="true"></i></a></div>
                <div class="soc"><a href="https://api.whatsapp.com/message/G2TNWXJEX6T6G1?autoload=1&amp;app_absent=0" rel="nofollow" target="_blank"><i style="font-size:20px;color:#0183AA;" class="fa-brands fa-whatsapp" aria-hidden="true"></i></a></div>
                <div class="soc"><a href="https://www.threads.net/@shaham_orlan_insurance" rel="nofollow" target="_blank"><i style="font-size:20px;color:#0183AA;" class="fa-brands fa-threads" aria-hidden="true"></i></a></div>
                </div>
            </div>
            <div class="logo"> <img class="logoimg" src="https://shaham-orlan.co.il/wp-content/uploads/2023/06/logo.png" alt="" title="" onclick="navigateToHome();" 
                style="cursor: pointer;"/></div>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </header>
<div class="intro-content" style="margin-top: 20px;"><h1 style="text-align: center;color:#0183AA"><strong>שחם אורלן בית הסוכן האמיתי </strong></h1>
    <h2 style="text-align: center;color:#333"><em style="color: #0183AA;">SO</em> כבר הבנתם… נכון?</h2>
</div>
<div class="hero">
  <div class="hero-overlay" aria-label="קישורים מרכזיים">
    <div class="hero-grid">
      <a class="hotspot" href="https://shaham-orlan.co.il/%d7%9b%d7%a0%d7%99%d7%a1%d7%aa-%d7%a1%d7%95%d7%9b%d7%a0%d7%99%d7%9d"  target="_blank" rel="noopener noreferrer" aria-label="כניסת מבוטחים"></a>
      <a class="hotspot" href="https://shaham-orlan.co.il/%d7%9e%d7%91%d7%95%d7%98%d7%97%d7%99%d7%9d"  target="_blank" rel="noopener noreferrer" aria-label="כניסת סוכנים"></a>
      <a class="hotspot" href="https://shaham-orlan.co.il/join-us/" target="_blank" rel="noopener noreferrer" aria-label="כניסת מעסיקים"></a>
      <a class="hotspot" href="https://shaham-orlan.co.il/%d7%9e%d7%a2%d7%a1%d7%99%d7%a7%d7%99%d7%9d" target="_blank" rel="noopener noreferrer" aria-label="להצטרפות אלינו"></a>
    </div>
  </div>
  
</div>


<div class="hero-images">
  <div class="image-container">
    <img class="image" src="https://shaham-orlan.co.il/wp-content/uploads/2023/07/2.jpg" alt="תמונה 1">
    <a style="text-decoration: none;" class="image-label" href="https://shaham-orlan.co.il/%d7%9e%d7%91%d7%95%d7%98%d7%97%d7%99%d7%9d" >כניסת מבוטחים</a>
  </div>
  <div class="image-container">
    <img class="image" src="https://shaham-orlan.co.il/wp-content/uploads/2023/07/1.jpg" alt="תמונה 2">
    <a style="text-decoration: none;" class="image-label" href="https://shaham-orlan.co.il/%d7%9b%d7%a0%d7%99%d7%a1%d7%aa-%d7%a1%d7%95%d7%9b%d7%a0%d7%99%d7%9d/">כניסת סוכנים</a>
  </div>
  <div class="image-container">
    <img class="image" src="https://shaham-orlan.co.il/wp-content/uploads/2023/07/3.jpg" alt="תמונה 3">
    <a style="text-decoration: none;" class="image-label" href= "https://shaham-orlan.co.il/%d7%9e%d7%a2%d7%a1%d7%99%d7%a7%d7%99%d7%9d/">כניסת מעסיקים</a>
  </div>
  <div class="image-container">
    <img class="image" src="https://shaham-orlan.co.il/wp-content/uploads/2023/07/4.jpg" alt="תמונה 4">
    <a style="text-decoration: none;" class="image-label" href="https://shaham-orlan.co.il/join-us/">להצטרפות אלינו</a>
  </div>
</div>



<div class="mainTitle" dir="rtl">
    
	<div class="feature-card">
		<div dir="rtl" class="flex-container" >
            
			<h1  class="feature-title hatid">העתיד הפיננסי שלך מתחיל כאן!</h1>          

			<h1 class="feature-description">אנחנו יודעים – ביטוח, זה נשמע קצת מסובך ואולי גם קצת מפחיד .

גם אם הבנת מה הצרכים שלך, לא בטוח שהפתרונות ברורים לך,

אנחנו והצוותים שלנו כאן כדי לסייע , להסביר להציע פתרונות – לך ולמשפחה שלך.</h1>           
            <a href="javascript:void(0)" class="cta-button bigscreen smallfont" style="margin-left: auto;margin-right: auto;"
            onclick="letStart()">לתהליך - חינם*</a>
            <div style="font-size: 1rem;font-weight: bold;text-align: right;color: #666; margin-top: 15px;">
                *נדרש להעלות קובצי xml של 
                <a href="https://www.swiftness.co.il/?gad_source=1" target="_blank" rel="noopener noreferrer" class="pension-clearance-link" style="text-decoration: none;color:#0183AA;">
                    המסלקה הפנסיונית
                    <span class="pension-tooltip">
                        <i class="fas fa-info-circle"></i>
                        הזמנת קובצי מסלקה דרך 
                        <strong style="text-decoration: underline;color:#0183AA;">
                            האתר הרשמי של המסלקה הפנסיונית
                        </strong>
                    </span>
                </a>
            </div>
   
        </div> 
	</div>
    	
</div>
    <!-- File Upload Section -->
    <section class="file-upload-section" id="fileUpload">
        <div class="container">
            <i id="closeFileUploadSection" class="fas fa-times" style="font-size: 2rem; cursor: pointer; color: #dc3545; margin-bottom: 2rem;"></i> 
            <div id='sectionHeader' class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 class="section-title xml-title" dir="rtl">העלאת קבצי XML מהמסלקה הפנסיונית</h2>   
            </div>
            
            <div class="file-upload-container">
	
                <div class="file-upload-area" id="fileUploadArea">
                    <div style="display: flex; gap: 30px; align-items: center; justify-content: center; flex-wrap: wrap; margin-bottom: 20px;">
                        <!-- Upload Icon -->
                        <div class="upload-icon upload-icon-small">
                            <i class="fas fa-file-code"></i>
                        </div>
                        
                        <!-- Privacy Message -->
                        <div style="flex: 1; min-width: 250px; max-width: 500px; background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); color: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <i class="fas fa-shield-alt" style="font-size: 2rem;"></i>
                                <h3 style="margin: 0; font-size: 1rem; color: white;">אבטחה ופרטיות מלאה</h3>
                            </div>
                            <p style="margin: 0; font-size: 0.8rem; line-height: 1.6;">
                                <strong>הנתונים שלך לא נשמרים!</strong><br>
                                עיבוד מקומי בלבד • מחיקה אוטומטית • פרטיות מלאה
                            </p>
                        </div>
                    </div>
                    
                    <h3 dir="rtl">גרור ושחרר קבצי מסלקה כאן או לחץ לבחירה</h3>
                    <p dir="rtl">העלה את קבצי המסלקה מסוג XML</p>
                    <input type="file" id="fileInput" multiple accept=".xml" style="display: none;">
                    <button class="cta-button" id="selectFilesBtn" dir="rtl">בחר קבצי XML</button>
</div>
                <div class="uploaded-files" id="uploadedFiles" style="display: none;">
                    <div class="file-actions">
                        <button class="cta-button" id="processFiles" style="display: none;">קרא נתונים</button>
                        <button class="cta-button delete-btn" id="deleteFiles">🗑️ סגור תצוגה ומחק נתונים</button>
                        <button class="cta-button" id="advancedAnalysisBtnMain2" onclick="sessionStorage.removeItem('riskProfile'); sessionStorage.removeItem('riskScore'); sessionStorage.removeItem('riskSource'); window.location.href='advancedAnalysis.html';" 
                         disabled
                         style="background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
                          color: white; border: none; padding: 15px 5px; border-radius: 25px;
                          font-size: 1.1rem; cursor: not-allowed; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                           transition: all 0.3s ease; max-width: 400px; width: 100%; opacity: 0.5;">📊 ניתוח מתקדם</button>
                    </div>
                    <h3 dir="rtl" id="uploadedFilesTitle">קבצים שהועלו - מיד יוצגו נתונים:</h3>
                    <div class="files-list" id="filesList"></div>  
                </div>
                
                <div class="file-data-display" id="fileDataDisplay" style="display: none;">
                    <h3 style="text-align:center;">נתונים מהקבצים:</h3>
                    <div class="data-content" id="dataContent"></div>
                </div>
                
                <!-- תצוגת נתונים יפה -->
                <div id="dataDisplayContainer">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h2 style="color: #333; font-size: 2.5rem; margin-bottom: 10px;">📊 סיכום הנתונים שלך</h2>
                        <p style="color: #666; font-size: 1.2rem;">כל המידע החשוב במקום אחד</p>
                    </div>
                    
                    <div class="data-grid-container">
                        <!-- פרטים אישיים -->
                        <div class="data-card">
                            <h3 style="text-align:center;color: #333; margin-bottom: 20px; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px;">👤 פרטים אישיים</h3>
                            <div id="personalInfo" style="color: #555; line-height: 1.8;">
                                <!-- כאן יוצגו הפרטים האישיים -->
                            </div>
                        </div>
                        
                        <!-- גרף עוגה -->
                        <div class="data-card">
                            <h3 style="color: #333; margin-bottom: 20px; font-size: 1rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px;">🥧 חלוקת הצבירה לפי מוצרים</h3>
                            <canvas id="pieChart" style="max-height: 350px;"></canvas>
                        </div>
                    </div>
                    
                      <!-- טבלת סיכום מפורטת -->
                      <div class="data-card-table" style="background: rgba(255,255,255,0.95); padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
                          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                              <h3 style="color: #333; margin: 0; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px; text-align: right;">📋 סיכום מפורט לפי מוצרים</h3>
                              <button type="button" class="tbl-button" id="closeDetailedTable" onclick="closeDetailedTableDisplay()">סגור</button>
                          </div>
                          <div id="detailedSummary" style="overflow-x: auto;">
                              <!-- כאן תוצג הטבלה המפורטת -->
                          </div>
                    </div>
                    
                    
                </div>
                
                <!-- תצוגת נתונים יפה -->
                <div id="dataDisplayContainer">
                    <div style="text-align: right; margin-bottom: 30px;">
                        <h2 style="color: white; font-size: 2.5rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">📊 סיכום הנתונים שלך</h2>
                        <p style="color: rgba(255,255,255,0.9); font-size: 1.2rem;">כל המידע החשוב במקום אחד</p>
                    </div>
                    
                    <div class="data-grid-container">
                        <!-- פרטים אישיים -->
                        <div class="data-card">
                            <h3 style="color: #333; margin-bottom: 20px; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px;">👤 פרטים אישיים</h3>
                            <div id="personalInfo" dir="rtl" style="color: #555; line-height: 1.8;">
                                <!-- כאן יוצגו הפרטים האישיים -->
                            </div>
                        </div>
                        
                        <!-- גרף עוגה -->
                        <div dir="rtl" class="data-card">
                             <h3 style="color: #333; margin-bottom: 20px; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px; text-align:center;">🥧 חלוקת הצבירה לפי מוצרים</h3>
                            <canvas id="pieChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>
                    
                    <!-- טבלת סיכום מפורטת -->
                    <div dir="rtl" class="data-card">
                        <h3 style="color: #333; margin-bottom: 20px; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px;">📋 סיכום מפורט לפי מוצרים</h3>
                        <div dir="rtl" id="detailedSummary" style="overflow-x: auto;">
                            <!-- כאן תוצג הטבלה המפורטת -->
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px; display: flex; flex-direction: column; align-items: center; gap: 15px;"> 
                        <button class="cta-button" id="advancedAnalysisBtnMain2" onclick="sessionStorage.removeItem('riskProfile'); sessionStorage.removeItem('riskScore'); sessionStorage.removeItem('riskSource'); window.location.href='advancedAnalysis.html';" 
                         disabled
                         style="background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
                          color: white; border: none; padding: 15px 40px; border-radius: 25px;
                          font-size: 1.1rem; cursor: not-allowed; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                           transition: all 0.3s ease; max-width: 400px; width: 100%; opacity: 0.5;">📊 ניתוח מתקדם</button>
                    </div>
                </div>
                
                <div class="chart-container" id="chartContainer" style="display: none;">
                    <h3>תצוגת גרף סכומי יתרות</h3>
                    <div class="chart-wrapper">
                        <canvas id="myDoughnutChart"></canvas>
                    </div>
                    <div id="customLegend" class="custom-legend">
                        <h3>מקרא:</h3>
                    </div>
                    <div class="chart-actions" style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 2rem; flex-wrap: wrap; width: 100%;">
                        <button class="cta-button chart-action-btn" id="closeChartBtn" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4); padding: 10px 20px; font-size: 14px;">סגור</button>
                        <button class="cta-button chart-action-btn" id="advancedAnalysisBtn" style="background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%); box-shadow: 0 4px 15px #0183AA; padding: 10px 20px; font-size: 14px;">ניתוח מתקדם</button>
                        <button class="cta-button chart-action-btn delete-btn" id="closeAndDeleteBtn" style="padding: 10px 20px; font-size: 14px;">סגור ומחק קבצים</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- טופס ייעוץ פנסיוני -->
   <!-- Advanced Analysis Section -->
   <section class="advanced-analysis-section" id="advancedAnalysis" style="display: none;">
    <div class="container">
        <h2 class="section-title" dir="rtl">ניתוח נתונים מתקדם</h2>
        
            <div class="analysis-tabs">
                <button class="tab-button active" data-tab="returns">השוואת תשואות</button>
                <button class="tab-button" data-tab="fees">דמי ניהול</button>
                <button class="tab-button" data-tab="liquidity">נזילות</button>
                <button class="tab-button" data-tab="pathways">מסלולי פנסיה</button>
                <button class="tab-button" data-tab="retirement">גיל פרישה</button>
                <button class="tab-button" data-tab="summary">סיכום כללי</button>
            </div>

        <div class="tab-content">
            <!-- Returns Comparison Tab -->
            <div class="tab-panel active" id="returns-tab">
                <h3>השוואת תשואות למתחרים</h3>
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h4>תשואות לפי מוצר</h4>
                        <div id="returnsChart" class="chart-container-small"></div>
                    </div>
                    <div class="analysis-card">
                        <h4>השוואה לממוצע השוק</h4>
                        <div id="marketComparison" class="comparison-table"></div>
                    </div>
                </div>
            </div>

            <!-- Management Fees Tab -->
            <div class="tab-panel" id="fees-tab">
                <h3>השוואת שיעורי דמי ניהול</h3>
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h4>דמי ניהול שנתיים</h4>
                        <div id="feesChart" class="chart-container-small"></div>
                    </div>
                    <div class="analysis-card">
                        <h4>השפעה על התשואה</h4>
                        <div id="feesImpact" class="impact-analysis"></div>
                    </div>
                </div>
            </div>

            <!-- Liquidity Analysis Tab -->
            <div class="tab-panel" id="liquidity-tab">
                <h3>בחינת כספים נזילים ולא נזילים</h3>
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h4>פילוח נזילות</h4>
                        <div id="liquidityChart" class="chart-container-small"></div>
                    </div>
                    <div class="analysis-card">
                        <h4>זמינות כספים</h4>
                        <div id="availabilityTable" class="availability-table"></div>
                    </div>
                </div>
            </div>

            <!-- Pension Pathways Tab -->
            <div class="tab-panel" id="pathways-tab">
                <h3>ניתוח מסלולי פנסיה</h3>
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h4>מסלולי השקעה</h4>
                        <div id="pathwaysChart" class="chart-container-small"></div>
                    </div>
                    <div class="analysis-card">
                        <h4>המלצות אופטימיזציה</h4>
                        <div id="optimizationRecommendations" class="recommendations"></div>
                    </div>
                </div>
            </div>

            <!-- Retirement Analysis Tab -->
            <div class="tab-panel" id="retirement-tab">
                <h3>ניתוח נתונים לגיל פרישה</h3>
                <div class="analysis-grid">
                    <div class="analysis-card">
                        <h4>צבירת כספים צפויה</h4>
                        <div id="retirementAccumulation" class="retirement-analysis">
                            <div style="text-align: right; padding: 2rem; color: #666;">
                                <i class="fas fa-spinner fa-spin"></i><br>
                                טוען נתונים...
                            </div>
                        </div>
                    </div>
                    <div class="analysis-card">
                        <h4>הקצבאות הצפויות</h4>
                        <div id="retirementPensions" class="retirement-analysis">
                            <div style="text-align: right; padding: 2rem; color: #666;">
                                <i class="fas fa-spinner fa-spin"></i><br>
                                טוען נתונים...
                            </div>
                        </div>
                    </div>
                    <div class="analysis-card">
                        <h4>חישוב גיל פרישה</h4>
                        <div id="retirementAgeCalculation" class="retirement-analysis">
                            <div style="text-align: right; padding: 2rem; color: #666;">
                                <i class="fas fa-spinner fa-spin"></i><br>
                                טוען נתונים...
                            </div>
                        </div>
                    </div>
                    <div class="analysis-card">
                        <h4>המלצות לפרישה</h4>
                        <div id="retirementRecommendations" class="retirement-analysis">
                            <div style="text-align: right; padding: 2rem; color: #666;">
                                <i class="fas fa-spinner fa-spin"></i><br>
                                טוען נתונים...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Summary Tab -->
            <div class="tab-panel" id="summary-tab">
                <h3>סיכום כללי והמלצות</h3>
                <div class="summary-grid">
                    <div class="summary-card">
                        <h4>ציון כללי</h4>
                        <div id="overallScore" class="score-display"></div>
                    </div>
                    <div class="summary-card">
                        <h4>המלצות עיקריות</h4>
                        <div id="mainRecommendations" class="recommendations-list"></div>
                    </div>
                    <div class="summary-card">
                        <h4>דוח מפורט</h4>
                        <button id="generateReport" class="cta-button">יצירת דוח PDF</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="analysis-actions">
            <button class="cta-button" id="backToUpload">חזרה להעלאת קבצים</button>
            <button class="cta-button" id="exportData">ייצוא נתונים</button>
        </div>
    </div>
</section>

    <section class="features" id="services">
        <div class="containerCards" style="margin: 0 25px;">
        <div class="choose-us-title">
            <h2 class="choose-us-title-text">הכלים והשירותים שלנו</h2>
        </div>
        <div class="flex-container-row feature-card-container" style="margin-bottom: 30px;">
           
                <div class="feature-card">
                    <div class="feature-icon"><img src="advicing.png" width="120" height="auto"/></div>
                    <h3 class="feature-title">יעוץ פנסיוני אישי ומקצועי</h3>
                    <p class="feature-description"> אני אבנה עבורך אסטרטגיה פנסיונית מותאמת למטרות ולמצב הכלכלי הייחודי שלך</p>
                    <a href="#consultation" class="cta-button smallfont" onclick="openConsultationForm()">קבל יעוץ</a>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><img src="tesuot.png" width="100" height="auto"/></div>
                    <h3 class="feature-title">ניתוח תשואות מתקדם</h3>
                    <p class="feature-description">בכלים של האתר תוכל לבצע ניתוחים  בצורה מקצועית וייחודית</p>
                    <div class="tools-dropdown">
                        <button class="cta-button" id="toolsDropdownBtn"  onclick="toggleToolsDropdown()">השתמש בכלים ▼</button>
                        <div class="dropdown-content" id="toolsDropdown">
                            <a href="hashMenahalot.html">השוואת חברות מנהלות</a>
                            <a href="hasifotMeshulav.html">מחולל חשיפות</a>
                            <a href="VirtualInvest.html">השוואת תיק משולב מסלולים</a>
                            <a href="#">ציון משקל תשואה לשארפ</a>
                        </div>
                    </div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><img src="manwithcomputure.png" width="100" height="auto"/></i></div>
                    <h3 class="feature-title">מחשבונים  מגוונים</h3>
                    <p class="feature-description">במחשבונים של האתר תוכל לחשב ערך עתידי, הפקדה נדרשת לסכום מטרה והחזרי הלוואה חודשיים</p>
                    <div class="calculator-dropdown">
                        <button class="cta-button" id="calculatorDropdownBtn" onclick="toggleCalculatorDropdown()">בחר מחשבון ▼</button>
                        <div class="dropdown-content" id="calculatorDropdown">
                            <a href="prisatMaanak.html">פריסת מענק פרישה</a>
                            <a href="ribitderibit.html">חישוב ערך עתידי</a>
                            <a href="loan.html">סימולטור הלוואה</a>
                            <a href="hafkada.html">מחשבון הפקדה לסכום מטרה</a>
                            <a href="hashDmeyNihul.html">השוואת דמי ניהול</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex-container-row feature-card-container" style="margin-bottom: 30px;">
                
                <div class="feature-card">
                    <div class="feature-icon"><img src="ofisikon.png" width="100" height="auto"/></div>
                    <h3 class="feature-title">התאמה  לאופי סיכון</h3>
                    <p class="feature-description">באמצעות שאלון סיכון קצר אוכל לאפיין את רמת הסיכון שלך ולבדוק את התאמת מסלולי ההשקעה שלך לרמת הסיכון.</p>
                    <a href="#" onclick="openRiskQuestModal(); return false;" class="cta-button smallfont">עבור לשאלון סיכון 🎯</a>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><img src="sherut.png" width="100" height="auto"/></div>
                    <h3 class="feature-title">ייעוץ פרישה</h3>
                    <p class="feature-description">תכנון פרישה נכון ימקסם את ההכנסות נטו שלך בתקופת הפנסיה תוך ניצול מקסימלי של הטבות המס</p>
                    <a href="#contact" class="cta-button smallfont" onclick="openConsultationForm()">צור קשר</a>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><img src="gemelorpolisa.png" width="100" height="auto"/></div>
                    <h3 class="feature-title">חסכון פרטי</h3>
                    <p class="feature-description"><span style="font-weight: bold;">קופת גמל להשקעה</span> או <span style="font-weight: bold;">פוליסת חסכון?</span> שתיהן מאפשרות להשקיע באופן פשוט, ליהנות מניהול מקצועי וממגוון מסלולי השקעה – אך יש ביניהן הבדלים מהותיים שכדאי להכיר.</p>
                    <a href="#contact" class="cta-button smallfont" onclick="openComparisonModal()">להשוואה</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Tables Section -->
    <section id="products" style="display: none; padding: 20px 0;">
        <div class="container" style="max-width: 1400px; margin: 0 auto;">
            <div id="allTheTables" class="allTheTables"></div>
        </div>
    </section>



<!-- Modal להשוואה -->
<div class="comparison-modal" id="comparisonModal">
   	<div class="comparison-card">
        <i onclick="closeComparisonModal()" class="fas fa-times" style="font-size: 2rem; cursor: pointer; color: #dc3545; margin-bottom: 2rem;"></i>
		<h2>קופת גמל להשקעה או פוליסת חיסכון – במה לבחור?</h2>
		<p>
			עולם ההשקעות הפרטיות מציע שתי אפשרויות מרכזיות לחיסכון נזיל ולטווח ארוך:
			<strong>קופת גמל להשקעה</strong> ו־<strong>פוליסת חיסכון</strong>.
			שתיהן מאפשרות להשקיע באופן פשוט, ליהנות מניהול מקצועי וממגוון מסלולי השקעה – אך יש ביניהן הבדלים מהותיים שכדאי להכיר.
		</p>
		
		<h3>⚖️ קופת גמל להשקעה – חיסכון עם יתרון מס</h3>
		
		<h4>יתרונות</h4>
		<ul>
			<li><strong>פטור ממס על רווחים ריאליים בגיל פרישה:</strong> ניתן להמיר את הכסף לקצבה חודשית פטורה ממס.</li>
			<li><strong>ניתן לנייד בין גופים מוסדיים</strong> – ללא אירוע מס.</li>
			<li><strong>דמי ניהול נמוכים יותר מפוליסת חסכון</strong> – ניתן למשוך את הכסף בכל עת (מס בשיעור של 25% על הרווח הריאלי).</li>
		</ul>
		
		<h4>חסרונות</h4>
		<ul class="cons-list">
			<li><strong>תקרת הפקדה שנתית מוגבלת</strong> (כ - 81 אלף ש"ח לשנת 2025).</li>
		</ul>
		
		<h3>🏦 פוליסת חיסכון – ניהול ללא תקרת הפקדה</h3>
		
		<h4>יתרונות</h4>
		<ul>
			<li><strong>אין תקרת הפקדה:</strong> ניתן להשקיע כל סכום.</li>
		</ul>
		
		<h4>חסרונות</h4>
		<ul class="cons-list">
			<li><strong>אין פטור ממס בגיל פרישה.</strong></li>
			<li><strong>דמי ניהול לרוב גבוהים יותר</strong> מקופת גמל להשקעה.</li>
			<li><strong>לא ניתן לנייד בין חברות הביטוח.</strong></li>
		</ul>
		
		<div class="summary-box">
			<h3>🧭 אז מה מתאים לך?</h3>
			<p><strong>מחפש חיסכון לטווח ארוך עם יתרון מס בפרישה?</strong> → קופת גמל להשקעה.</p>
			<p><strong>רוצה להשקיע סכום גדול?</strong> → פוליסת חסכון או שילוב בין המוצרים.</p>
			<p style="margin-top: 1.5rem; font-style: italic; color: #0183AA;">
				שתי האופציות חכמות – הבחירה הנכונה תלויה בצרכים ובסכום ההשקעה.
			</p>
		</div>
		
		<!-- טבלת 5 המסלולים המובילים -->
		<div class="top-performers-section">
			<h3>🏆 5 המסלולים המובילים בקופות גמל להשקעה</h3>
			<div id="topPerformersContainer">
				<div class="loading-spinner">
					<i class="fas fa-spinner fa-spin"></i>
					<p>טוען נתונים...</p>
				</div>
			</div>
		</div>
		
		<button class="close-comparison-btn" onclick="closeComparisonModal()">חזרה</button>
	</div>
</div>

 	<div class="buttons-grid count-6 ">
        <a class="grid-button " href="https://shaham-orlan.co.il/customers-gate/%d7%9e%d7%99%d7%93%d7%a2-%d7%9b%d7%9b%d7%9c%d7%99-%d7%9c%d7%9c%d7%a7%d7%95%d7%97%d7%95%d7%aa/" target="https://shaham-orlan.co.il/customers-gate/%d7%9e%d7%99%d7%93%d7%a2-%d7%9b%d7%9b%d7%9c%d7%99-%d7%9c%d7%9c%d7%a7%d7%95%d7%97%d7%95%d7%aa/">
            מידע כללי ללקוחות															</a>
        <a class="grid-button " href="https://shaham-orlan.co.il/%d7%98%d7%a4%d7%a1%d7%99%d7%9d-%d7%a9%d7%99%d7%9e%d7%95%d7%a9%d7%99%d7%99%d7%9d/" target="https://shaham-orlan.co.il/%d7%98%d7%a4%d7%a1%d7%99%d7%9d-%d7%a9%d7%99%d7%9e%d7%95%d7%a9%d7%99%d7%99%d7%9d/">
            טפסים שימושיים															</a>
        <a class="grid-button " href="https://shaham-orlan.co.il/%d7%9e%d7%99%d7%93%d7%a2-%d7%90%d7%99%d7%a9%d7%99-%d7%91%d7%90%d7%99%d7%a0%d7%98%d7%a8%d7%a0%d7%98/" target="https://shaham-orlan.co.il/%d7%9e%d7%99%d7%93%d7%a2-%d7%90%d7%99%d7%a9%d7%99-%d7%91%d7%90%d7%99%d7%a0%d7%98%d7%a8%d7%a0%d7%98/">
            מידע אישי באינטרנט															</a>
        <a class="grid-button " href="https://shaham-orlan.co.il/our-agents/" target="https://shaham-orlan.co.il/our-agents/">
            הסוכנים שלנו															</a>
        <a class="grid-button " href="https://shaham-orlan.co.il/%d7%91%d7%99%d7%98%d7%95%d7%97-%d7%95%d7%a4%d7%99%d7%a0%d7%a0%d7%a1%d7%99%d7%9d-%d7%91%d7%92%d7%95%d7%91%d7%94-%d7%94%d7%90%d7%95%d7%96%d7%a0%d7%99%d7%99%d7%9d/" target="https://shaham-orlan.co.il/%d7%91%d7%99%d7%98%d7%95%d7%97-%d7%95%d7%a4%d7%99%d7%a0%d7%a0%d7%a1%d7%99%d7%9d-%d7%91%d7%92%d7%95%d7%91%d7%94-%d7%94%d7%90%d7%95%d7%96%d7%a0%d7%99%d7%99%d7%9d/">
            ערוץ הפודקאסט שלנו															</a>
        <a class="grid-button " href="https://shaham-orlan.co.il/%d7%91%d7%9c%d7%95%d7%92/" target="https://shaham-orlan.co.il/%d7%91%d7%9c%d7%95%d7%92/">
            הבלוג שלנו	</a>
    </div>

    <!-- מידע מקצועי על המוצרים -->
    <section class="features" id="professional-info" style="background: white; padding: 4rem 0;">
        <div class="containerCards" style="margin: 0 25px;">
            <div class="choose-us-title" style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                <h3 class="choose-us-title-text mutzarimText">📚 מידע מקצועי על המוצרים</h3>
                <button class="cta-button" id="toggleProfessionalInfo" onclick="toggleProfessionalInfoSection()" 
                    style="max-width: 200px; font-size: 1.1rem;">
                    <i class="fas fa-chevron-down"></i> פתח
                </button>
            </div>
            <div id="professionalInfoCards" class="flex-container-row feature-card-container" style="margin-bottom: 30px; display: none;">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-piggy-bank" style="font-size: 4rem;"></i></div>
                    <h3 class="feature-title">קרן פנסיה</h3>
                    <p class="feature-description">למד על קרן פנסיה, מרכיביה, הטבות המס וכללי המשיכה</p>
                    <button class="cta-button smallfont" onclick="openProfessionalInfoModal('pensia')">למד עוד</button>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-chart-line" style="font-size: 4rem;"></i></div>
                    <h3 class="feature-title">קופת גמל להשקעה</h3>
                    <p class="feature-description">מידע מקיף על קופת גמל להשקעה, יתרונות והטבות מס</p>
                    <button class="cta-button smallfont" onclick="openProfessionalInfoModal('hashkaa')">למד עוד</button>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-graduation-cap" style="font-size: 4rem;"></i></div>
                    <h3 class="feature-title">קרן השתלמות</h3>
                    <p class="feature-description">הבן את היתרונות של קרן השתלמות ומיסוי רבינוביץ</p>
                    <button class="cta-button smallfont" onclick="openProfessionalInfoModal('hishtalmut')">למד עוד</button>
                </div>
            </div>
            <div id="professionalInfoCards2" class="flex-container-row feature-card-container" style="display: none;">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-coins" style="font-size: 4rem;"></i></div>
                    <h3 class="feature-title">קופת גמל</h3>
                    <p class="feature-description">כל מה שצריך לדעת על קופת גמל לעמית שכיר ועצמאי</p>
                    <button class="cta-button smallfont" onclick="openProfessionalInfoModal('gemel')">למד עוד</button>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-file-invoice-dollar" style="font-size: 4rem;"></i></div>
                    <h3 class="feature-title">פוליסת חסכון</h3>
                    <p class="feature-description">גלה את היתרונות של פוליסת חסכון ומסלולי ההשקעה</p>
                    <button class="cta-button smallfont" onclick="openProfessionalInfoModal('polisa')">למד עוד</button>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-child" style="font-size: 4rem;"></i></div>
                    <h3 class="feature-title">חסכון לכל ילד</h3>
                    <p class="feature-description">מידע על חסכון לכל ילד והיתרונות המיוחדים של התכנית</p>
                    <button class="cta-button smallfont" onclick="openProfessionalInfoModal('yeled')">למד עוד</button>
                </div>
            </div>
        </div>
    </section>

    <section class="cta-section">
        <div class="container">
            <h2 dir="rtl" class="cta-title">מוכן להתחיל לתכנן את עתידך הפנסיוני?</h2>
            <p class="cta-subtitle">קבל יעוץ מקצועי ותתחיל לנהל את הכספים שלך בדרך הנכונה והרווחית</p>
            <a href="#consultation" class="cta-button-white" onclick="openConsultationForm()"> יעוץ אישי</a>
        </div>
    </section>
<div class="col-lg-9 mx-auto text-center">			
	<div class="intro-title title-size--medium">יצירת קשר</div>	
    <div class="intro-content"><p>השאירו את פרטיכם וניצור עמכם קשר בהקדם.</p></div>
</div>	
<div class="simple-form-container">
		<div class="header-line has-h2">
			<div class="h2">
				&nbsp;			</div>

			<img src="/wp-content/themes/orlan/images/line.png" alt="" title="">
		</div>
		<div class="agent-bg">
			<div class="agent-form">
				
<div class="wpcf7 js" id="wpcf7-f1428-p906-o1" lang="en-US" dir="ltr" data-wpcf7-id="1428">
<div class="screen-reader-response"><p role="status" aria-live="polite" aria-atomic="true"></p> <ul></ul></div>
<form action="/%d7%a6%d7%a8%d7%95-%d7%a7%d7%a9%d7%a8/#wpcf7-f1428-p906-o1" method="post" class="wpcf7-form init" aria-label="Contact form" novalidate="novalidate" data-status="init">
<div style="display: none;">
<input type="hidden" name="_wpcf7" value="1428">
<input type="hidden" name="_wpcf7_version" value="6.0">
<input type="hidden" name="_wpcf7_locale" value="en_US">
<input type="hidden" name="_wpcf7_unit_tag" value="wpcf7-f1428-p906-o1">
<input type="hidden" name="_wpcf7_container_post" value="906">
<input type="hidden" name="_wpcf7_posted_data_hash" value="">
<input type="hidden" name="_wpcf7cf_hidden_group_fields" value="[&quot;current_agent_text&quot;]">
<input type="hidden" name="_wpcf7cf_hidden_groups" value="[&quot;group-1&quot;]">
<input type="hidden" name="_wpcf7cf_visible_groups" value="[]">
<input type="hidden" name="_wpcf7cf_repeaters" value="[]">
<input type="hidden" name="_wpcf7cf_steps" value="{}">
<input type="hidden" name="_wpcf7cf_options" value="{&quot;form_id&quot;:1428,&quot;conditions&quot;:[{&quot;then_field&quot;:&quot;group-1&quot;,&quot;and_rules&quot;:[{&quot;if_field&quot;:&quot;is_customer&quot;,&quot;operator&quot;:&quot;equals&quot;,&quot;if_value&quot;:&quot;\u05db\u05df&quot;}]}],&quot;settings&quot;:{&quot;animation&quot;:&quot;yes&quot;,&quot;animation_intime&quot;:200,&quot;animation_outtime&quot;:200,&quot;conditions_ui&quot;:&quot;normal&quot;,&quot;notice_dismissed&quot;:false,&quot;notice_dismissed_rollback-cf7-5.8&quot;:true}}">
<input type="hidden" name="_wpcf7_recaptcha_response" value="0cAFcWeA4XYqYWdD3BDYyFxctIcnRys_Y3-ZkZ1xrMH0Ha8LfT_NFU0tWNt4zfcPk7W-PHHtpIIVnl7aREoY6dZkCUzBLDD8p-s5dCi82e_LOamLYyaNwGEglkkEF8cETUE14a8mvc-IP4KoINi5auBWu1y78K1AmmcpzY8bwuzCdc-tKkQJofhnXIQtoqoQaZv5bIwASMof_cYm1Q-m8jXz4nqOJAqEKwKrhydxgL3ymuoDS_6tBAaZgsPnke0KITBzZhKKS9ITyEp0zOp8AYa-dyOGBfT8pSxai2IyRrbYdIFvxNHOKuEaHb9RI4xOU6tIc76_1zKYvSsJfaDPGiK03qJMsOx407t9Pn1ndNUPTV-esknJwBzh6zflD3YUfwPZVlLTKyMumNiLbiKxG81w6lQ0afzknFVPttVhr2PyeXHbCjunbo9oz_CCTX_ClYyf5XvvPbm3OeKQFpfjdCxIQXqWECBeaj89Sw31epvP9yCdFj49JL3BWjmbTqtLthO86q9-ONqYAf6e8UfoiU9iSYL3ufHF8zt4cD27F04nRTe8z2KhfQ9ckmEIen4PEAgdH1p1K6hspX2lK4QeqTToCW2Jq_d0bjXuC2BPWnraFaqSqMDN5Y3AiyWnENDJtUUcJfIQTdCvGvAdkmwddXWwZln0aJ5SSKwwKcTDR2KlKbd3eMG50UXk3BkY2HfVdH-2TY9mr42XyM4F2PJKPZxKpToSqrcPhuSWJBkTbFV5jJbUOmDglBWlQYfwetXVUiDcd-gl4fuaz1DtzRbigQdg6icAgq3AVIY9o0Yzyxs76uiNEPPk9PQ86IIz1ydRXoc3cQujPbhnJMJCjaOvX9GCVw_bJQxo77_4i_jzvepY1XpHSixawfZVZZPnzfeJrp8ZWtUmbLWBcyk8RIyNvVDBmiYNo6MWU7V-GRoUgZzLeq1r0Gtfwpmznyz44CweIECxsz5177RwQspV6U30v9t-sm3GBO5SUgbgjrurVj4dhwbRdXQ0CCHBvfscwPQJ8qrJMFfHKZQZ6yCwD86w4UQTTs3UUt8xRLdcneipXDGchUAvzB053PrUSNN1SxtbQTLd9ZuYd1H2EwmRiNEgNGunelntADDo5gSlHD_DhTLtA9JMsGc_QhldhO2JsejmUIxfVYpge2fownisNLHIEdggrt7E9ePGRJffkd8UMf66LTg2X8hcQh3P84o2e1sB0cVs83no5XomuQDsdx5yVUr5Y9grq5BWb98HNSiFzr8L7b-dD5ESuqPj79ZVuCZnqXGItVdZ4zSgajYmeHPr5wjcMfVzfivyMgXSW6RvhwyIISWfbNRGbIqZbqsLYNejcfgZVM9joSCEyHOY5x-spUXALC1DqxHct5V11aGvT7TX15p_kSIbHoHp1ua5WkY9JcQf17-g-IRER9Ir1uGX3tCrUPrmZEG03K3VuHad9U7-zcWyQpqu1HuWeid4U5QxVtVcEWVPlwB1wA7NWZfwkOCCniWoIVdVXqRP-dcM6Zm1Y9N5ETkoMPUtgXsqDxXDQnQ-qdQ8UmfCs4vx9qc1-t1NsbOxf4YODkeizpGnNMRqM4Qh4cO2S2lbjK_ry8J1f_NYBOI8NsuvdxyHTbL9vrwIxPQ7l5MgpVhQ">
</div>
<div class="agents-form join customers" dir="rtl">
	<div class="input-col">
		<p><span class="wpcf7-form-control-wrap" data-name="firstname"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" aria-required="true" aria-invalid="false" placeholder="שם פרטי" value="" type="text" name="firstname"></span>
		</p>
	</div>
	<div class="input-col">
		<p><span class="wpcf7-form-control-wrap" data-name="lastname"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" aria-required="true" aria-invalid="false" placeholder="שם משפחה" value="" type="text" name="lastname"></span>
		</p>
	</div>
	<div class="input-col">
		<p><span class="wpcf7-form-control-wrap" data-name="phone"><input dir="rtl" size="40" maxlength="400" class="wpcf7-form-control wpcf7-tel wpcf7-validates-as-required wpcf7-text wpcf7-validates-as-tel" aria-required="true" aria-invalid="false" placeholder="טלפון נייד" value="" type="tel" name="phone"></span>
		</p>
	</div>
	<div class="input-col">
		<p><span class="wpcf7-form-control-wrap" data-name="email"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-email wpcf7-validates-as-required wpcf7-text wpcf7-validates-as-email" aria-required="true" aria-invalid="false" placeholder="כתובת אימייל" value="" type="email" name="email"></span>
		</p>
	</div>
	<div class="input-col">
		<p><span class="wpcf7-form-control-wrap" data-name="message-type"><select class="wpcf7-form-control wpcf7-select wpcf7-validates-as-required" aria-required="true" aria-invalid="false" name="message-type"><option value="" disabled="disabled">מהות הפנייה</option><option value="קבלת הצעת מחיר ביטוח רכוש">קבלת הצעת מחיר ביטוח רכוש</option><option value="קבלת הצעת מחיר ביטוחי חיים בריאות">קבלת הצעת מחיר ביטוחי חיים בריאות</option><option value="קבלת הצעת מחיר פיננסים">קבלת הצעת מחיר פיננסים</option><option value="קבלת שירות כללי">קבלת שירות כללי</option><option value="אחר">אחר</option></select></span>
		</p>
	</div>
	<div class="input-col radios">
		<p><span class="radios-label">האם את/ה מבוטח/ת אצלנו כיום?</span><span class="wpcf7-form-control-wrap" data-name="is_customer"><span class="wpcf7-form-control wpcf7-radio"><span class="wpcf7-list-item first"><label><input style="margin-right: 5px;" type="radio" name="is_customer" value="כן"><span class="wpcf7-list-item-label" style="margin: 0 5px;">כן</span></label></span><span class="wpcf7-list-item last"><label><input type="radio" name="is_customer" value="לא"><span style="margin: 0 5px;" class="wpcf7-list-item-label">לא</span></label></span></span></span>
		</p>
	</div>
	<div class="input-col">
		<div data-id="group-1" data-orig_data_id="group-1" data-class="wpcf7cf_group" style="height: auto;" class="wpcf7cf-hidden">
			<p><span class="wpcf7-form-control-wrap" data-name="current_agent_text"><input size="40" maxlength="400" class="wpcf7-form-control wpcf7-text" aria-invalid="false" placeholder="הקלד/י את שם הסוכן" value="" type="text" name="current_agent_text"></span>
			</p>
		</div>
	</div>
	<div class="input-col">
	</div>
	<div class="input-col full pp">
		<p><span class="wpcf7-form-control-wrap" data-name="pp-agree"><span class="wpcf7-form-control wpcf7-acceptance"><span class="wpcf7-list-item"><label><input style="margin-left:15px" type="checkbox" name="pp-agree" value="1" aria-invalid="false"><span style="text-align: justify;" class="wpcf7-list-item-label">אני מוסר את המידע מרצוני החופשי ובהסכמתי המלאה מבלי שחלה עליה חובה חוקית לעשות כן. ידוע לי כי המידע עשוי להימסר לצדדים שלישיים על מנת שאקבל את השירותים ו/או המוצרים הביטוחיים המבוקשים על ידי. כמו כן ידוע לי כי אוכל לבקש לתקן ולעיין במידע אודותיי בהתאם לדיני הפרטיות. ככל שלא אמסור את המידע, מטבע הדברים, לא אוכל לקבל את השירותים ו/או המוצרים המוצעים. שם בעלת השליטה במאגר המידע: שחם אורלן סוכנות לביטוח בע"מ | מייל: info@shaham-orlan.co.il | טלפון: 03-920666 | כתובת סניף ראשי: רח' היצירה 3, פתח – תקווה.</span></label></span></span></span>
		</p>
	</div>
	<div class="submit-col">
		<p><input class="wpcf7-form-control wpcf7-submit has-spinner" id="agents-submit-form" type="submit" value="שלח" disabled=""><span class="wpcf7-spinner"></span>
		</p>
	</div>
</div><div class="wpcf7-response-output" aria-hidden="true"></div>
</form>
</div>
			</div>
		</div>
	</div>
<div class="logos">
        <div class="logos-slide">
    <img src="altshuler-logo.png" id="altshuler-logo" alt="Altshuler Logo">
    <img src="yalin-logo.png" class="yalin-logo" alt="Yalin Logo">
    <img src="migdal-logo.png" class="migdal-logo" alt="Migdal Logo">
    <img src="meitav-logo.png" class="meitav-logo" alt="Meitav Logo">
    <img src="menora-logo.png" class="menora-logo" alt="Menora Logo">
    <img src="mor-logo.png" class="mor-logo" alt="Mor Logo">
    <img src="clal-logo.png" class="clal-logo" alt="Clal Logo">
    <img src="fenix-logo.png" class="fenix-logo" alt="Fenix Logo">
    <img src="analist-logo.png" class="analist-logo" alt="Analist Logo">
    <img src="ayalon-logo.png" class="ayalon-logo" alt="Ayalon Logo">
    <img src="hachshara-logo.png" class="hachshara-logo" alt="Hachshara Logo">
    <img src="harel-logo.png" class="harel-logo" alt="Harel Logo">

    <!-- Duplicate logos for seamless scrolling -->
    <img src="altshuler-logo.png" class="altshuler-logo" alt="Altshuler Logo">
    <img src="yalin-logo.png" class="yalin-logo" alt="Yalin Logo">
    <img src="migdal-logo.png" class="migdal-logo" alt="Migdal Logo">
    <img src="meitav-logo.png" class="meitav-logo" alt="Meitav Logo">
    <img src="menora-logo.png" class="menora-logo" alt="Menora Logo">
    <img src="mor-logo.png" class="mor-logo" alt="Mor Logo">
    <img src="clal-logo.png" class="clal-logo" alt="Clal Logo">
    <img src="fenix-logo.png" class="fenix-logo" alt="Fenix Logo">
    <img src="analist-logo.png" class="analist-logo" alt="Analist Logo">
    <img src="ayalon-logo.png" class="ayalon-logo" alt="Ayalon Logo">
    <img src="hachshara-logo.png" class="hachshara-logo" alt="Hachshara Logo">
    <img src="harel-logo.png" class="harel-logo" alt="Harel Logo">
</div>

    </div>

<script>
    // משתנים לניתוח מתקדם - נשמרים רק ב-sessionStorage
    var alreadyShown;
    
    function letStart(){
        const fileUploadSection = document.getElementById('fileUpload');
        
        // Show file upload section first
        if(window.innerWidth>768){
            fileUploadSection.style.display = 'flex';   
        }else{
            fileUploadSection.style.display = 'block';
        }
        
        document.getElementById('fileUploadArea').style.display = 'block';
        document.getElementById('sectionHeader').style.display = 'flex';
        
        // Then scroll to it (after a tiny delay to let it render)
        setTimeout(() => {
            if (fileUploadSection) {
                fileUploadSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }, 100);
    }

        // Function to show product tables
        async function showProductTables(productType) {
            // Hide other sections
            const productsSection = document.getElementById('products');
            if (!productsSection) return;
            
            // Show products section
            productsSection.style.display = 'block';
            
            // Scroll to products section
            productsSection.scrollIntoView({ behavior: 'smooth' });
            
            // Map product type to internal name and call appropriate function
            const productMap = {
                'קרנות השתלמות': 'קרנות השתלמות',
                'קופות גמל': 'תגמולים ואישית לפיצויים',
                'קופות גמל להשקעה': 'קופת גמל להשקעה',
                'חסכון לילד': 'קופת גמל להשקעה - חסכון לילד',
                'פוליסות חסכון': 'פוליסות חסכון',
                'קרנות פנסיה חדשות': 'קרנות חדשות',
                'קרנות פנסיה כלליות': 'קרנות כלליות'
            };
            
            const internalName = productMap[productType];
            
            if (productType === 'קרנות פנסיה חדשות' || productType === 'קרנות פנסיה כלליות') {
                // Call pension function
                if (typeof maslulimP === 'function') {
                    await maslulimP(1, internalName, 0);
                }
            } else {
                // Call regular products function
                if (typeof maslulim === 'function') {
                    await maslulim(1, internalName, 0);
                }
            }
            
            // Close mobile menu if open
            const navMenu = document.getElementById('navMenu');
            const hamburger = document.getElementById('hamburger');
            if (navMenu && hamburger) {
                navMenu.classList.remove('active');
                hamburger.classList.remove('active');
            }
        }

        // פונקציה לפתיחה/סגירה של הרשימה הנפתחת בתפריט הניווט
        function toggleNavProductsDropdown(event) {
            if (!event) event = window.event;
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            const dropdown = document.getElementById('navProductsDropdown');
            if (!dropdown) return false;
            // Find the link - could be event.target or its parent
            let link = null;
            if (event && event.target) {
                link = event.target.closest ? event.target.closest('a') : null;
                if (!link && event.target.tagName === 'A') link = event.target;
            }
            if (!link) link = dropdown.closest('.nav-dropdown')?.querySelector('a');
            
            // במסכים גדולים, התפריט נפתח ב-hover (CSS), אז לא צריך לעשות כלום
            if (window.innerWidth > 768) {
                return false;
            }
            
            // Close other dropdowns and reset their text
            document.querySelectorAll('.dropdown-content.show').forEach(d => {
                if (d !== dropdown) {
                    d.classList.remove('show');
                    const parentLi = d.closest('.nav-dropdown');
                    const parentLink = parentLi?.querySelector('a');
                    if (parentLink) {
                        if (d.id === 'navCalculatorDropdown') {
                            parentLink.innerHTML = 'מחשבונים ▼';
                        } else if (d.id === 'navToolsDropdown') {
                            parentLink.innerHTML = 'כלי השוואה ▼';
                        }
                    }
                }
            });
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                if (link) link.innerHTML = 'מוצרים ותשואות ▼';
            } else {
                dropdown.classList.add('show');
                if (link) link.innerHTML = 'מוצרים ותשואות ▲';
            }
            
            return false;
        }

        function toggleNavCalculatorDropdown(event) {
            if (!event) event = window.event;
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            const dropdown = document.getElementById('navCalculatorDropdown');
            if (!dropdown) return false;
            // Find the link - could be event.target or its parent
            let link = null;
            if (event && event.target) {
                link = event.target.closest ? event.target.closest('a') : null;
                if (!link && event.target.tagName === 'A') link = event.target;
            }
            if (!link) link = dropdown.closest('.nav-dropdown')?.querySelector('a');
            
            // במסכים גדולים, התפריט נפתח ב-hover (CSS), אז לא צריך לעשות כלום
            if (window.innerWidth > 768) {
                return false;
            }
            
            // Close other dropdowns and reset their text
            document.querySelectorAll('.dropdown-content.show').forEach(d => {
                if (d !== dropdown) {
                    d.classList.remove('show');
                    const parentLi = d.closest('.nav-dropdown');
                    const parentLink = parentLi?.querySelector('a');
                    if (parentLink) {
                        if (d.id === 'navProductsDropdown') {
                            parentLink.innerHTML = 'מוצרים ותשואות ▼';
                        } else if (d.id === 'navToolsDropdown') {
                            parentLink.innerHTML = 'כלי השוואה ▼';
                        }
                    }
                }
            });
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                if (link) link.innerHTML = 'מחשבונים ▼';
            } else {
                dropdown.classList.add('show');
                if (link) link.innerHTML = 'מחשבונים ▲';
            }
            
            // Prevent any default behavior
            return false;
        }
        
        // פונקציה לפתיחה/סגירה של הרשימה הנפתחת בתפריט הניווט - כלי השוואה
        function toggleNavToolsDropdown(event) {
            if (!event) event = window.event;
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            const dropdown = document.getElementById('navToolsDropdown');
            if (!dropdown) return false;
            // Find the link - could be event.target or its parent
            let link = null;
            if (event && event.target) {
                link = event.target.closest ? event.target.closest('a') : null;
                if (!link && event.target.tagName === 'A') link = event.target;
            }
            if (!link) link = dropdown.closest('.nav-dropdown')?.querySelector('a');
            
            // במסכים גדולים, התפריט נפתח ב-hover (CSS), אז לא צריך לעשות כלום
            if (window.innerWidth > 768) {
                return false;
            }
            
            // Close other dropdowns and reset their text
            document.querySelectorAll('.dropdown-content.show').forEach(d => {
                if (d !== dropdown) {
                    d.classList.remove('show');
                    const parentLi = d.closest('.nav-dropdown');
                    const parentLink = parentLi?.querySelector('a');
                    if (parentLink) {
                        if (d.id === 'navProductsDropdown') {
                            parentLink.innerHTML = 'מוצרים ותשואות ▼';
                        } else if (d.id === 'navCalculatorDropdown') {
                            parentLink.innerHTML = 'מחשבונים ▼';
                        }
                    }
                }
            });
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                if (link) link.innerHTML = 'כלי השוואה ▼';
            } else {
                dropdown.classList.add('show');
                if (link) link.innerHTML = 'כלי השוואה ▲';
            }
            
            return false;
        }

        // פונקציה לפתיחה/סגירה של הרשימה הנפתחת
        function toggleCalculatorDropdown() {
            const dropdown = document.getElementById('calculatorDropdown');
            const button = document.getElementById('calculatorDropdownBtn');
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                button.classList.remove('active');
                button.innerHTML = 'בחר מחשבון ▼';
            } else {
                dropdown.classList.add('show');
                button.classList.add('active');
                button.innerHTML = 'בחר מחשבון ▲';
            }
        }

        // סגירת הרשימה הנפתחת כשלוחצים מחוץ לה
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('calculatorDropdown');
            const button = document.getElementById('calculatorDropdownBtn');
            
            if (!dropdown.contains(event.target) && !button.contains(event.target)) {
                dropdown.classList.remove('show');
                button.classList.remove('active');
                button.innerHTML = 'בחר מחשבון ▼';
            }
            
            // Close nav dropdowns when clicking outside
            document.querySelectorAll('.dropdown-content.show').forEach(d => {
                if (!d.contains(event.target)) {
                    const parentLi = d.closest('.nav-dropdown');
                    const parentLink = parentLi?.querySelector('a');
                    if (parentLink && !parentLink.contains(event.target)) {
                        d.classList.remove('show');
                        if (d.id === 'navProductsDropdown') {
                            parentLink.innerHTML = 'מוצרים ותשואות ▼';
                        } else if (d.id === 'navCalculatorDropdown') {
                            parentLink.innerHTML = 'מחשבונים ▼';
                        } else if (d.id === 'navToolsDropdown') {
                            parentLink.innerHTML = 'כלי השוואה ▼';
                        }
                    }
                }
            });
        });

        // סגירת הרשימה הנפתחת כשלוחצים על קישור
        document.addEventListener('click', function(event) {
            if (event.target.closest('.dropdown-content a')) {
                const dropdown = document.getElementById('calculatorDropdown');
                const button = document.getElementById('calculatorDropdownBtn');
                
                dropdown.classList.remove('show');
                button.classList.remove('active');
                button.innerHTML = 'בחר מחשבון ▼';
            }
            
            // Close nav dropdown when clicking on links
            if (event.target.closest('#navCalculatorDropdown a')) {
                const navDropdown = document.getElementById('navCalculatorDropdown');
                const navLink = navDropdown.closest('.nav-dropdown')?.querySelector('a');
                
                if (navDropdown) navDropdown.classList.remove('show');
                if (navLink) navLink.innerHTML = 'מחשבונים ▼';
            }
            
            // Close other nav dropdowns when clicking on their links
            if (event.target.closest('#navProductsDropdown a')) {
                const navDropdown = document.getElementById('navProductsDropdown');
                const navLink = navDropdown.closest('.nav-dropdown')?.querySelector('a');
                
                if (navDropdown) navDropdown.classList.remove('show');
                if (navLink) navLink.innerHTML = 'מוצרים ותשואות ▼';
            }
            
            if (event.target.closest('#navToolsDropdown a')) {
                const navDropdown = document.getElementById('navToolsDropdown');
                const navLink = navDropdown.closest('.nav-dropdown')?.querySelector('a');
                
                if (navDropdown) navDropdown.classList.remove('show');
                if (navLink) navLink.innerHTML = 'כלי השוואה ▼';
            }
        });

        // Ensure nav dropdown links work properly
        document.querySelectorAll('#navCalculatorDropdown a').forEach(link => {
            link.addEventListener('click', function(e) {
                // Don't prevent default - let the link work normally
                e.stopPropagation();
                
                // Close dropdown after a short delay to allow navigation
                setTimeout(() => {
                    const dropdown = document.getElementById('navCalculatorDropdown');
                    const dropdownLink = dropdown?.closest('.nav-dropdown')?.querySelector('a');
                    
                    if (dropdown) {
                        dropdown.classList.remove('show');
                    }
                    if (dropdownLink) {
                        dropdownLink.innerHTML = 'מחשבונים ▼';
                    }
                }, 100);
            });
        });
        
        

        // פונקציה לפתיחה/סגירה של רשימת הכלים
        function toggleToolsDropdown() {
            const dropdown = document.getElementById('toolsDropdown');
            const button = document.getElementById('toolsDropdownBtn');
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                button.classList.remove('active');
                button.innerHTML = 'השתמש בכלים ▼';
            } else {
                dropdown.classList.add('show');
                button.classList.add('active');
                button.innerHTML = 'השתמש בכלים ▲';
            }
        }

        // סגירת רשימת הכלים כשלוחצים מחוץ לה
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('toolsDropdown');
            const button = document.getElementById('toolsDropdownBtn');
            
            if (!dropdown.contains(event.target) && !button.contains(event.target)) {
                dropdown.classList.remove('show');
                button.classList.remove('active');
                button.innerHTML = 'השתמש בכלים ▼';
            }
        });

        // סגירת רשימת הכלים כשלוחצים על קישור
        document.addEventListener('click', function(event) {
            if (event.target.closest('.tools-dropdown .dropdown-content a')) {
                const dropdown = document.getElementById('toolsDropdown');
                const button = document.getElementById('toolsDropdownBtn');
                
                dropdown.classList.remove('show');
                button.classList.remove('active');
                button.innerHTML = 'השתמש בכלים ▼';
            }
        });
        // וידוא שהדף תמיד מתחיל בחלק העליון
        window.addEventListener('load', function() {
            window.scrollTo(0, 0);
        });
        
        window.addEventListener('beforeunload', function() {
            window.scrollTo(0, 0);
        });
        
        // פונקציה לפתיחה/סגירה של סעקשן מידע מקצועי
        function toggleProfessionalInfoSection() {
            const cards1 = document.getElementById('professionalInfoCards');
            const cards2 = document.getElementById('professionalInfoCards2');
            const button = document.getElementById('toggleProfessionalInfo');
            
            if (cards1.style.display === 'none') {
                // פתיחה
                cards1.style.display = 'flex';
                cards2.style.display = 'flex';
                button.innerHTML = '<i class="fas fa-chevron-up"></i> סגור';
                
                // אנימציית פתיחה חלקה
                cards1.style.opacity = '0';
                cards2.style.opacity = '0';
                setTimeout(() => {
                    cards1.style.transition = 'opacity 0.5s ease';
                    cards2.style.transition = 'opacity 0.5s ease';
                    cards1.style.opacity = '1';
                    cards2.style.opacity = '1';
                }, 10);
            } else {
                // סגירה
                cards1.style.transition = 'opacity 0.3s ease';
                cards2.style.transition = 'opacity 0.3s ease';
                cards1.style.opacity = '0';
                cards2.style.opacity = '0';
                
                setTimeout(() => {
                    cards1.style.display = 'none';
                    cards2.style.display = 'none';
                }, 300);
                
                button.innerHTML = '<i class="fas fa-chevron-down"></i> פתח';
            }
        }
        
        // וידוא שהדף תמיד בחלק העליון כשמרעננים
        if (window.history.scrollRestoration) {
            window.history.scrollRestoration = 'manual';
        }
        let sumSugMutzar = {
                    '1': [0, 0,0,0,0], '2': [0, 0,0,0,0], '2_1': [0, 0,0,0,0], '2_2': [0, 0,0,0,0], '3': [0, 0,0,0,0],
                    '4': [0, 0,0,0,0], '5': [0, 0,0,0,0], '6': [0, 0,0,0,0], '7': [0, 0,0,0,0], '8': [0, 0,0,0,0],
                    '9': [0, 0,0,0,0], '10': [0, 0,0,0,0]
                };
        
        let taarichLeyda = '';let DataAll=[];  
        let kodMaslulSet = new Set();let yitrotKaspeyPizoyim=[];
        let pratimIshim;let yitrotLefiMutzar;let yitrotLeGilPrisha;
        let masluleiHashkaa=[];let sheabudIkulHalvaa=[];let pirteiHeshbon=[];
        // Mobile menu toggle
        const hamburger = document.getElementById('hamburger');
        const navMenu = document.getElementById('navMenu');

        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        // Close menu when clicking on a link
        navMenu.addEventListener('click', (e) => {
            if (e.target.tagName === 'A') {
                hamburger.classList.remove('active');
                navMenu.classList.remove('active');
            }
        });

        // File Upload Functionality
        let uploadedFiles = [];
        let myChart = null;
        let dataMislaka = null;
        
        // Product type descriptions
        const sugTochnitOHeshbon = {
            '1': 'פוליסת ביטוח חיים משולב חיסכון',
            '2': 'קרן פנסיה',
            '2_1': 'קרן פנסיה ותיקה',
            '2_2': 'קרן פנסיה חדשה',
            '3': 'קופת גמל',
            '4': 'קרן השתלמות',
            '5': 'פוליסת חיסכון טהור',
            '6': 'פוליסת סיכון טהור (ריסק מוות ו/או פוליסת אכ"ע SA)',
            '7': 'ביטוח חיים משכנתא',
            '8': 'פוליסת סיכון טהור קולקטיב',
            '9': 'קופת גמל להשקעה',
            '10': 'חיסכון לכל ילד'
        };
        
        const chartColors = ['#F37253','#0A2540','#4CAF50','#2196F3','#FFC107','#9C27B0','#FF5722','#607D8B','#795548','#E91E63'];
        
        // Chart.js plugin for center text
        const totalAmountPlugin = {
            id: 'totalAmountPlugin',
            beforeDraw(chart) {
                if (chart.config.options.plugins && chart.config.options.plugins.centerText) {
                    const ctx = chart.ctx;
                    const centerConfig = chart.config.options.plugins.centerText;
                    const txt = centerConfig.text;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.font = `bold 30px ${centerConfig.fontStyle || 'Arial'}`;
                    ctx.fillStyle = centerConfig.color || '#000';
                    ctx.fillText(txt, (chart.chartArea.left + chart.chartArea.right)/2, (chart.chartArea.top + chart.chartArea.bottom)/2);
                }
            }
        };
        Chart.register(totalAmountPlugin);
        
        const fileInput = document.getElementById('fileInput');
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileUpload = document.getElementById('fileUpload');
        const selectFilesBtn = document.getElementById('selectFilesBtn');
        const uploadedFilesDiv = document.getElementById('uploadedFiles');
        const filesList = document.getElementById('filesList');
        const processFilesBtn = document.getElementById('processFiles');
        const deleteFilesBtn = document.getElementById('deleteFiles');
        const fileDataDisplay = document.getElementById('fileDataDisplay');
        const dataContent = document.getElementById('dataContent');
        const closeChartBtn = document.getElementById('closeChartBtn');
        const closeAndDeleteBtn = document.getElementById('closeAndDeleteBtn');
        const advancedAnalysisBtn = document.getElementById('advancedAnalysisBtn');
        const backToUploadBtn = document.getElementById('backToUpload');
        const exportDataBtn = document.getElementById('exportData');
        const generateReportBtn = document.getElementById('generateReport');
        const closeFileUploadSectionBtn = document.getElementById('closeFileUploadSection');

        function cleanVal(val, def = null) {
            if (val === undefined || val === null || typeof val === 'object') return def;
            return val;
        }

        // הופך ערך ל-array תמיד (undefined/null → [], אובייקט יחיד → [obj], מערך → 그대로)
        function toArray(val) {
            if (!val) return [];
            return Array.isArray(val) ? val : [val];
        }

        function getElementText(parent, tag) {
            let isNil
            const el = parent?.getElementsByTagName?.(tag)?.[0];
            if (!el) return null;
            isNil = el.getAttribute?.('xsi:nil') === 'true';
             if (isNil) return null;
            //  אם יש צורך להחזיר ערך מיוחד עבור אלמנטים עם xsi
            let pnil={
                2:'p2:nil',
                3:'p3:nil', 
                4:'p4:nil',
                5:'p5:nil',
                6:'p6:nil',
                7:'p7:nil', 
                8:'p8:nil'
            }
            for(const k in pnil){
                 if(el.getAttribute?.(pnil[k])==='true') return null;
            }
            return (el.textContent ?? '').trim() || null;
        }

        // חיתוך תאריך מהכותרת בפורמט YYYYMMDD
        function sliceDate8(v) {
            const s = cleanVal(v, null);
            if (!s) return null;
            return String(s).slice(6, 8)+"/"+String(s).slice(4, 6)+"/"+String(s).slice(0, 4);
        }

        // שמירת 9 הספרות האחרונות של ת"ז/מזהה לקוח
        function last9Digits(v) {
            const s = cleanVal(v, null);
            if (!s) return null;
            const onlyDigits = String(s).replace(/\D+/g, '');
            if (!onlyDigits) return null;
            return onlyDigits.slice(-9);
        }
        function num(val) {
            if (val == null || val === '') return null;
            const n = Number(val);
            return Number.isFinite(n) ? n : val;
        }
        function parseDateYYYYMMDD(val) {
            if (!val || String(val).length < 8) return val ?? null;
            const s = String(val);
            return `${s.slice(6,8)}/${s.slice(4,6)}/${s.slice(0,4)}`;
        }

        // Drag and drop functionality
        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.classList.add('dragover');
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.classList.remove('dragover');
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });

        // העלאת קבצים
        fileUploadArea.addEventListener('click', (e) => {
            // Prevent double triggering
            if (e.target === fileUploadArea || e.target.closest('.file-upload-area')) {
                fileInput.click();
            }
        });

        // טיפול בקבצים שהועלו
        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        // Button click handler
        selectFilesBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            // Reset file input to allow selecting same files again
            fileInput.value = '';
            fileInput.click();
            
        });

         // שמירת הקבצים ב אוסף uploadedFiles
        function handleFiles(files) {
            // ⚡ RESET uploadedFiles - don't accumulate from previous uploads
            uploadedFiles = [];
            
            Array.from(files).forEach(file => {
                if (isValidFile(file)) {
                    uploadedFiles.push(file);
                }
            });
            
            displayUploadedFiles();
            
            if(uploadedFiles.length > 0) {
                setTimeout(() => {
                    processFilesBtn.click();
                }, 3500);
            }
        }

        function isValidFile(file) {
            const validTypes = [
                'text/xml',
                'application/xml',
                'application/xml-external-parsed-entity'
            ];
            return validTypes.includes(file.type) || 
                   file.name.toLowerCase().endsWith('.xml');
        }

        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = e => resolve(e.target.result);
                reader.onerror = reject;
                reader.readAsText(file);
            });
        }

    // הצגת הקבצים שהועלו   
        function displayUploadedFiles() {
            if (uploadedFiles.length === 0) {
                uploadedFilesDiv.style.display = 'none';
                fileUploadArea.style.display = 'block';
                return;
            }

            uploadedFilesDiv.style.display = 'block';
            fileUploadArea.style.display = 'none';
            filesList.innerHTML = '';
            let gemelFiles =0;let pensiaHfiles =0;let pensiaVfiles =0;let bituachfiles=0;
                const fileItem = document.createElement('div');
            const fileIcon = getFileIcon(uploadedFiles[0].type);
                fileItem.className = 'file-item';
            uploadedFiles.forEach((file, index) => {
                if(file.name.includes('KGM')){gemelFiles++;}
                if(file.name.includes('PNN')){pensiaHfiles++;}
                if(file.name.includes('PNO')){pensiaVfiles++;}
                if(file.name.includes('ING') || file.name.includes('INP') || file.name.includes('INK')
            || file.name.includes('INM')){bituachfiles++;}
            });

            let parts = [];

            if (gemelFiles > 0) parts.push(`${gemelFiles} קבצי גמל`);
            if (pensiaHfiles > 0) parts.push(`${pensiaHfiles} קבצי פנסיה חדשה`);
            if (pensiaVfiles > 0) parts.push(`${pensiaVfiles} קבצי פנסיה ותיקה`);
            if (bituachfiles > 0) parts.push(`${bituachfiles} קבצי ביטוח`);

            const fileSentence = "הועלו " + parts.join(", ");
                fileItem.innerHTML = `
                    <div dir="rtl" class="file-info" style="text-align: right;">
                        <i class="file-icon ${fileIcon}"></i>
                        <div style="display:flex;justify-content:right;">
                            <div class="file-name" >${fileSentence}</div>
                        </div>
                    </div>
                `;
                filesList.appendChild(fileItem);

        }

        function getFileIcon(fileType) {
            if (fileType.includes('xml')) {
                return 'fas fa-file-code';
            } else {
                return 'fas fa-file';
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Process files button
        processFilesBtn.addEventListener('click', async () => {
            // ⚡ RESET ALL GLOBAL VARIABLES BEFORE PROCESSING
            taarichLeyda = '';
            dataMislaka = null;
            sumSugMutzar = {
                '1': [0, 0,0,0,0], '2': [0, 0,0,0,0], '2_1': [0, 0,0,0,0], '2_2': [0, 0,0,0,0], '3': [0, 0,0,0,0],
                '4': [0, 0,0,0,0], '5': [0, 0,0,0,0], '6': [0, 0,0,0,0], '7': [0, 0,0,0,0], '8': [0, 0,0,0,0],
                '9': [0, 0,0,0,0], '10': [0, 0,0,0,0]
            };
            pirteiHeshbon = [];
            DataAll = [];
            kodMaslulSet = new Set();
            yitrotKaspeyPizoyim = [];
            pratimIshim = '';
            yitrotLefiMutzar = '';
            yitrotLeGilPrisha = '';
            masluleiHashkaa = [];
            sheabudIkulHalvaa = [];
            
            // Destroy existing chart if any
            if (myChart) {
                myChart.destroy();
                myChart = null;
            }
            
            uploadedFilesTitle.style.display = 'none';
            filesList.style.display = 'none';
            if (uploadedFiles.length === 0) {
                console.warn('⚠️ No files to process!');
                return;
            }    
           
            fileDataDisplay.style.display = 'none';
            try {
                const groupedSums = {};
                let overallTotalSum = 0;
                let shemPrati = '';
                let shemMishpacha = '';
                let misparCellulari = '';
                let eMail = '';
                let misparZihuyLakoach = '';
                let taarichNechnut = '';
                let gilPrishaValue = '';
                let gil = '';
                
                let sumSugMutzarGilPrishaTzafuy = {};
                let sumSugMutzarGilPrishaLeloPremiyot = {};
                let kitzvaSugMutzarGilPrishaTzafuy = {};
                let kitzvaSugMutzarGilPrishaLeloPremiyot = {};
                
                for (const file of uploadedFiles) {
                    const xmlString = await readFileAsText(file);
                    const result = new DOMParser().parseFromString(xmlString, "text/xml");
                    let pensiaVatikaOHadasha = '';
                    
                    try {
                        // Helper function to get element text content
                        //const getElementText = (parent, tagName) => {
                       //     const element = parent.getElementsByTagName(tagName)[0];
                       //     return element ? element.textContent.trim() : '';
                       // };

                        const mimshak = result.getElementsByTagName('Mimshak')[0];
                        if (!mimshak) {
                            throw new Error('לא נמצא אלמנט Mimshak בקובץ XML');
                        }
                        const yeshutYatzran = mimshak.getElementsByTagName('YeshutYatzran')[0];
                        if (!yeshutYatzran) {
                                throw new Error('לא נמצא אלמנט YeshutYatzran בקובץ XML');
                        }
                        const mutzarim = yeshutYatzran.getElementsByTagName('Mutzarim')[0];
                        const mutzar = mutzarim ? mutzarim.getElementsByTagName('Mutzar')[0] : null;
                        if (!mutzar) {
                            console.warn('לא נמצאו נתוני מוצר בקובץ זה—דילוג.');
                            await connection.commit();
                            return;
                        }
                        const netuneiMutzar = mutzar.getElementsByTagName('NetuneiMutzar')[0];
                        const sugMutzar = cleanVal(getElementText(netuneiMutzar, 'SUG-MUTZAR'));
                        const yeshutLakoach = netuneiMutzar ? netuneiMutzar.getElementsByTagName('YeshutLakoach')[0] : null;
                    
                        /*פרטים אישיים*/
                        if(shemPrati===''){shemPrati = cleanVal(yeshutLakoach ? getElementText(yeshutLakoach, 'SHEM-PRATI') : '')};
                        if(shemMishpacha===''){shemMishpacha = cleanVal(yeshutLakoach ? getElementText(yeshutLakoach, 'SHEM-MISHPACHA') : '')};
                        if(misparCellulari===''){misparCellulari = cleanVal(yeshutLakoach ? getElementText(yeshutLakoach, 'MISPAR-CELLULARI') : '') || ''};
                        if(eMail===''){eMail = cleanVal(yeshutLakoach ? getElementText(yeshutLakoach, 'E-MAIL') : '') || ''};
                        if(misparZihuyLakoach===''){ misparZihuyLakoach = last9Digits(yeshutLakoach ? getElementText(yeshutLakoach, 'MISPAR-ZIHUY-LAKOACH') : '')};
                        
                        if(taarichLeyda===''){ 
                            taarichLeyda = cleanVal(yeshutLakoach ? getElementText(yeshutLakoach, 'TAARICH-LEYDA') : '');
                            
                            const birthYear = parseInt(taarichLeyda.slice(0,4));
                            const currentYear = new Date().getFullYear();
                            gil = currentYear - birthYear;
                            
                            // שמירה ב-sessionStorage לשימוש בעמוד הניתוח המתקדם
                            sessionStorage.setItem('gilForAdvancedAnalysis', gil);
                            sessionStorage.setItem('ageToRetirementForAdvancedAnalysis', 67-Number(gil));
                        };
                        
                        pratimIshim={shemPrati,shemMishpacha,misparCellulari,eMail,misparZihuyLakoach,taarichLeyda,gil};
                       
                        /*יתרות מוצרים*/
                        const heshbonotOPolisot = mutzar.getElementsByTagName('HeshbonotOPolisot')[0];
                        const heshbonotElements = heshbonotOPolisot ? heshbonotOPolisot.getElementsByTagName('HeshbonOPolisa') : [];
                        const heshbonot = Array.from(heshbonotElements);
                        for (const heshbon of heshbonot) {

                            let mekademGilPrishaTzafuy = '';
                            if(taarichNechnut==='') {taarichNechnut = sliceDate8(cleanVal(getElementText(heshbon, 'TAARICH-NECHONUT')))};
                            if(sugMutzar==='2') {pensiaVatikaOHadasha = cleanVal(getElementText(heshbon, 'PENSIA-VATIKA-O-HADASHA'))};
                            const statusPolisaOCheshbon=cleanVal(getElementText(heshbon,'STATUS-POLISA-O-CHESHBON'))
                            const taarichHitztarfutMutzar = cleanVal(getElementText(heshbon, 'TAARICH-HITZTARFUT-MUTZAR'));
                            const maslulBituach = heshbon.getElementsByTagName('MaslulBituach')[0];
                            const shemMaslulHabituah = cleanVal(maslulBituach ? getElementText(maslulBituach, 'SHEM-MASLUL-HABITUAH') : '') || '';
                            const sugPolisa=cleanVal(getElementText(heshbon,'SUG-POLISA'))
                            const prtTakzivElements = heshbon.getElementsByTagName('PirteiTaktziv');
                            const prtTakziv = Array.from(prtTakzivElements);
                            const ksafimPturim = cleanVal(getElementText(heshbon,'TIKUN-190'))
                            var PirteiHafkadaAchrona=[]
                            var pirteiHaasaka=[]
                            for (const p of prtTakziv) {

                                const blockItrot = p.getElementsByTagName('BlockItrot')[0];
                                const yitrotElement = blockItrot ? blockItrot.getElementsByTagName('Yitrot')[0] : null;
                                const perutYitrotElements = yitrotElement ? yitrotElement.getElementsByTagName('PerutYitrot') : [];
                                const yitrot = Array.from(perutYitrotElements);
                                const pirteiHafkadaHarona=p.getElementsByTagName('PirteiHafkadaAchrona')[0] || null;
                                if (statusPolisaOCheshbon==='1' && pirteiHafkadaHarona){
                                    const PerutPirteiHafkadaAchronaElements=pirteiHafkadaHarona.getElementsByTagName('PerutPirteiHafkadaAchrona');
                                    const PerutPirteiHafkadaAchrona=Array.from(PerutPirteiHafkadaAchronaElements);
                                    for (const hafkadaAchrona of PerutPirteiHafkadaAchrona) {
                                        const taarichHafkadHachrona=cleanVal(getElementText(hafkadaAchrona,'TAARICH-ERECH-HAFKADA'));
                                        const sugHafkada=cleanVal(getElementText(hafkadaAchrona,'SUG-HAFKADA'));
                                        const totalHafkadaHachrona=cleanVal(getElementText(hafkadaAchrona,'TOTAL-HAFKADA'))
                                        if(PirteiHafkadaAchrona.length===0){
                                            PirteiHafkadaAchrona.push({
                                                taarichHafkadHachrona:taarichHafkadHachrona,
                                                sugHafkada:sugHafkada,
                                                totalHafkadaHachrona:totalHafkadaHachrona   
                                            })
                                        }
                                        else{
                                            
                                            if(Number(PirteiHafkadaAchrona[0].taarichHafkadHachrona)<Number(taarichHafkadHachrona)){
                                                PirteiHafkadaAchrona=[];
                                                PirteiHafkadaAchrona.push({
                                                    taarichHafkadHachrona:taarichHafkadHachrona,
                                                    sugHafkada:sugHafkada,
                                                    totalHafkadaHachrona:totalHafkadaHachrona   
                                                })
                                            }
                                        }
                                        
                                    }
                                }
                            
                                for (const yitra of yitrot) {
                                    const totalChisachonMtzbr = cleanVal(getElementText(yitra, 'TOTAL-CHISACHON-MTZBR')) || 0;
                                    const totalErkeiPidion = cleanVal(getElementText(yitra, 'TOTAL-ERKEI-PIDION')) || 0;
                                    if(sugMutzar!=='2'){
                                        sumSugMutzar[sugMutzar][0] = (sumSugMutzar[sugMutzar][0] || 0) + parseFloat(totalErkeiPidion);    
                                        // סכומים נשמרים רק ב-sessionStorage בסוף התהליך
                                    }
                                    else{
                                        if(pensiaVatikaOHadasha==='1'){
                                            sumSugMutzar[sugMutzar+'_1'][0] = (sumSugMutzar[sugMutzar+'_1'][0] || 0) + parseFloat(totalErkeiPidion);    
                                        }
                                        else{
                                            sumSugMutzar[sugMutzar+'_2'][0] = (sumSugMutzar[sugMutzar+'_2'][0] || 0) + parseFloat(totalErkeiPidion);    
                                        }

                                    }
                                }
                               
                            }
                          
                            /*יתרות לגיל פרישה*/
                            if(sugMutzar==='1' || (sugMutzar==='2' && pensiaVatikaOHadasha==='2')) {
                                const yitraLefiGilPrisha = heshbon.getElementsByTagName('YitraLefiGilPrisha')[0];
                                if(yitraLefiGilPrisha) {
                                    const kupot = yitraLefiGilPrisha.getElementsByTagName('Kupot')[0];
                                    const kupa = kupot ? kupot.getElementsByTagName('Kupa')[0] : null;
                                    
                                    const tzviratLeloPremiyot = parseFloat(cleanVal(getElementText(yitraLefiGilPrisha, 'TZVIRAT-CHISACHON-CHAZUYA-LELO-PREMIYOT')) || 0);
                                    const totalMitztaberTzafuy = parseFloat(cleanVal(getElementText(yitraLefiGilPrisha, 'TOTAL-CHISACHON-MITZTABER-TZAFUY')) || 0);
                                    const kitzvaTzfuya = parseFloat(cleanVal(getElementText(yitraLefiGilPrisha, 'KITZVAT-HODSHIT-TZFUYA')) || 0);
                                    const schumKitzvat = parseFloat(cleanVal(kupa ? getElementText(kupa, 'SCHUM-KITZVAT-ZIKNA') : '') || 0);
                                    const gilPrisha = cleanVal(getElementText(yitraLefiGilPrisha, 'GIL-PRISHA')) || '';
                                    mekademGilPrishaTzafuy=cleanVal(getElementText(yitraLefiGilPrisha, 'MEKADEM-MOVTACH-LEPRISHA')) || '';
                                    // הוספת הערכים לאובייקטים המתאימים
                                    const mutzarKey = sugMutzar === '2' ? sugMutzar + '_' + pensiaVatikaOHadasha : sugMutzar;
                                    sumSugMutzar[mutzarKey][1] = sumSugMutzar[mutzarKey][1] + tzviratLeloPremiyot;
                                    sumSugMutzar[mutzarKey][2] = sumSugMutzar[mutzarKey][2] + totalMitztaberTzafuy;
                                    sumSugMutzar[mutzarKey][3] = sumSugMutzar[mutzarKey][3] + kitzvaTzfuya;
                                    sumSugMutzar[mutzarKey][4] = sumSugMutzar[mutzarKey][4] + schumKitzvat;
                                    
                                    if(!gilPrishaValue && gilPrisha) {
                                        gilPrishaValue = gilPrisha;
                                    }
                                }
                            }
                            
                            /*פירוט חשבונות ברמת החשבון*/
                            let shemMaasik='';

                            var maasikimSet = new Set();
                            const shemYatzran = getElementText(yeshutYatzran, 'SHEM-YATZRAN');
                            const yeshutMaasikElements = netuneiMutzar ? netuneiMutzar.getElementsByTagName('YeshutMaasik') : [];
                            const yeshutMaasikArray = Array.from(yeshutMaasikElements);
                            for (const yeshutMaasik of yeshutMaasikArray) { 
                                const mprMaasikBeYatzran = cleanVal(getElementText(yeshutMaasik, 'MPR-MAASIK-BE-YATZRAN'));
                                const shemMaasik = cleanVal(getElementText(yeshutMaasik, 'SHEM-MAASIK')) || 'לא ידוע';
                                const misparMezaheMaasik = cleanVal(getElementText(yeshutMaasik, 'MISPAR-MEZAHE-MAASIK')) || '';
                                const sugMezaheMaasik = cleanVal(getElementText(yeshutMaasik, 'SUG-MEZAHE-MAASIK')) || ''; 
                            
                                maasikimSet.add(`${sugMezaheMaasik}-${misparMezaheMaasik}-${mprMaasikBeYatzran}-${shemMaasik}`)   
                            }
                    
                            const misparPolisaOHeshbon = cleanVal(getElementText(heshbon, 'MISPAR-POLISA-O-HESHBON'), 0);
                            const shemTochnit = cleanVal(getElementText(heshbon, 'SHEM-TOCHNIT'));
                            const tsua = heshbon.getElementsByTagName('Tsua')[0];
                            const sheurTesuaNetoH = cleanVal(tsua ? getElementText(tsua, 'SHEUR-TSUA-NETO') : '', '');

                            const perutShiabudIkul = heshbon.getElementsByTagName('PerutShiabudIkul')[0];
                            const hutalSHiabud = cleanVal(perutShiabudIkul ? getElementText(perutShiabudIkul, 'HUTAL-SHIABUD') : '');
                            const hutalIkul = cleanVal(perutShiabudIkul ? getElementText(perutShiabudIkul, 'HUTAL-IKUL') : '');
                            
                            const halvaa = heshbon.getElementsByTagName('Halvaa')[0];
                            const yeshHalvaaBamutzar = cleanVal(halvaa ? getElementText(halvaa, 'YESH-HALVAA-BAMUTZAR') : '');
                            
                            const pirteyTvia = heshbon.getElementsByTagName('PirteyTvia')[0];
                            const yeshTvia = cleanVal(pirteyTvia ? getElementText(pirteyTvia, 'YESH-TVIA') : '');
                            sheabudIkulHalvaa.push({
                                sugMutzar:sugMutzar,
                                pensiaVatikaOHadasha:pensiaVatikaOHadasha,
                                misparPolisaOHeshbon:misparPolisaOHeshbon,
                                hutalSHiabud:hutalSHiabud,
                                hutalIkul:hutalIkul,
                                yeshHalvaaBamutzar:yeshHalvaaBamutzar,
                                yeshTvia:yeshTvia
                            });
                            

                            for (const p of prtTakziv) {
                                const haasaka= p.getElementsByTagName('PirteiHaasaka')[0]
                                kodChisuvSacharHeshbon = cleanVal(getElementText(haasaka, 'KOD-CHISHUV-SACHAR-POLISA-O-HESHBON')) || 0;
                                sacharPolisa=cleanVal(getElementText(haasaka,'SACHAR-POLISA')) || 0;
                                pirteiHaasaka.push({
                                    kodChisuvSacharHeshbon:kodChisuvSacharHeshbon,
                                    sacharPolisa:sacharPolisa
                                }
                                )
                                
   
                                const blockItrot = p.getElementsByTagName('BlockItrot')[0];
                                const yitrotElement = blockItrot ? blockItrot.getElementsByTagName('Yitrot')[0] : null;
                                const perutYitrot =yitrotElement? yitrotElement.getElementsByTagName('PerutYitrot') : "";
                                const pirteiOved = p.getElementsByTagName('PirteiOved')[0];
                                const sugTochnitOhHeshbon = cleanVal(pirteiOved ? getElementText(pirteiOved, 'SUG-TOCHNIT-O-CHESHBON') : '');
                                const mprMaasikBeYatzran = cleanVal(pirteiOved ? getElementText(pirteiOved, 'MPR-MAASIK-BE-YATZRAN') : '');
                                
                                if(mprMaasikBeYatzran){
                                    maasikimSet=Array.from(maasikimSet);
                                    for(const maasikim of maasikimSet){
                                        if(maasikim.split('-')[2]===mprMaasikBeYatzran && Number(maasikim.split('-')[0])!==6){
                                            shemMaasik=maasikim.split('-')[3];
                                            break;
                                        }
                                        else{
                                            shemMaasik='לא ידוע';
                                        }
                                    }

                                }
                                let yitratKaspeyTagmulimValue = 0;
                                const nesilutTag = yitrotElement ? yitrotElement.getElementsByTagName('NesilutTag') : null;
                                if (nesilutTag) {
                                    const nesilutTagArray = Array.from(nesilutTag);
                                    for (const nesilut of nesilutTagArray) {
                                        const yitratKaspeyTagmulim = cleanVal(getElementText(nesilut, 'YITRAT-KASPEY-TAGMULIM')) || 0;
                                        yitratKaspeyTagmulimValue = yitratKaspeyTagmulimValue + parseFloat(yitratKaspeyTagmulim);
                                    }
                                }
                                let pitzuimPturimMaavidimKodmim=0;
                                let erechPidionPitzuimLeKitzbaMaavidimKodmim=0;
                                let tzviratPitzuimMaavidimKodmimBeretzefKitzba=0;
                                let tzviratPitzuimMaavidimKodmimBeretzefZechuyot=0;
                                let tzviratPitzuim31121999LeKitzba=0;
                                let erechPidionPitzuimMaasikNochechi=0;
                                let erechPidionMarkivPitzuimLemasNochechi=0;
                                let erechPidionPitzuimMaavidimKodmimRetzefZehuyut=0;
                                let erechPidionPitzuimLeHonMaavidimKodmim=0;
                                let yitratPitzuimLeLoHitchashbenot=0;
                                let kayamRetzefPitzuimKitzba=0;
                                let kayamRetzefPitzuimZechuyot=0;

                                const kaspeyPizoyimElements = yitrotElement ? yitrotElement.getElementsByTagName('YitrotShonot') : null;
                                if (kaspeyPizoyimElements && kaspeyPizoyimElements.length > 0) {
                                    const kaspeyPizoyim = kaspeyPizoyimElements[0];
                                    pitzuimPturimMaavidimKodmim = cleanVal(getElementText(kaspeyPizoyim, 'TZVIRAT-PITZUIM-PTURIM-MAAVIDIM-KODMIM')) || 0;
                                    erechPidionPitzuimLeKitzbaMaavidimKodmim = cleanVal(getElementText(kaspeyPizoyim, 'ERECH-PIDION-PITZUIM-LEKITZBA-MAAVIDIM-KODMIM')) || 0;
                                    tzviratPitzuimMaavidimKodmimBeretzefKitzba = cleanVal(getElementText(kaspeyPizoyim, 'TZVIRAT-PITZUIM-MAAVIDIM-KODMIM-BERETZEF-KITZBA')) || 0;
                                    tzviratPitzuimMaavidimKodmimBeretzefZechuyot = cleanVal(getElementText(kaspeyPizoyim, 'TZVIRAT-PITZUIM-MAAVIDIM-KODMIM-BERETZEF-ZECHUYOT')) || 0;
                                    tzviratPitzuim31121999LeKitzba = cleanVal(getElementText(kaspeyPizoyim, 'TZVIRAT-PITZUIM-31-12-1999-LEKITZBA')) || 0;
                                    erechPidionPitzuimMaasikNochechi = cleanVal(getElementText(kaspeyPizoyim, 'ERECH-PIDION-PITZUIM-MAASIK-NOCHECHI')) || 0;
                                    erechPidionMarkivPitzuimLemasNochechi = cleanVal(getElementText(kaspeyPizoyim, 'ERECH-PIDION-MARKIV-PITZUIM-LEMAS-NOCHECHI')) || 0;
                                    erechPidionPitzuimMaavidimKodmimRetzefZehuyut = cleanVal(getElementText(kaspeyPizoyim, 'ERECH-PIDION-PITZUIM-MAAVIDIM-KODMIM-RETZEF-ZEHUYUT')) || 0;
                                    erechPidionPitzuimLeHonMaavidimKodmim = cleanVal(getElementText(kaspeyPizoyim, 'ERECH-PIDION-PITZUIM-LEHON-MAAVIDIM-KODMIM')) || 0;
                                    yitratPitzuimLeLoHitchashbenot = cleanVal(getElementText(kaspeyPizoyim, 'YITRAT-PITZUIM-LELO-HITCHASHBENOT')) || 0;
                                    kayamRetzefPitzuimKitzba = cleanVal(getElementText(kaspeyPizoyim, 'KAYAM-RETZEF-PITZUIM-KITZBA')) || 0;
                                    kayamRetzefPitzuimZechuyot = cleanVal(getElementText(kaspeyPizoyim, 'KAYAM-RETZEF-ZECHUYOT-PITZUIM')) || 0;
                                    if(pitzuimPturimMaavidimKodmim>0 || erechPidionPitzuimLeKitzbaMaavidimKodmim>0 
                                    || tzviratPitzuimMaavidimKodmimBeretzefKitzba>0 || tzviratPitzuimMaavidimKodmimBeretzefZechuyot>0
                                    || tzviratPitzuim31121999LeKitzba>0 || erechPidionPitzuimMaasikNochechi>0 ||
                                    erechPidionMarkivPitzuimLemasNochechi>0 || erechPidionPitzuimMaavidimKodmimRetzefZehuyut>0
                                    || erechPidionPitzuimLeHonMaavidimKodmim>0 || yitratPitzuimLeLoHitchashbenot>0){
                                    yitrotKaspeyPizoyim.push({
                                        sugMutzar: sugMutzar,
                                        misparPolisaOHeshbon: misparPolisaOHeshbon,
                                        pitzuimPturimMaavidimKodmim: parseFloat(pitzuimPturimMaavidimKodmim),
                                        erechPidionPitzuimLeKitzbaMaavidimKodmim: parseFloat(erechPidionPitzuimLeKitzbaMaavidimKodmim),
                                        tzviratPitzuimMaavidimKodmimBeretzefKitzba: parseFloat(tzviratPitzuimMaavidimKodmimBeretzefKitzba),
                                        tzviratPitzuimMaavidimKodmimBeretzefZechuyot: parseFloat(tzviratPitzuimMaavidimKodmimBeretzefZechuyot),
                                        tzviratPitzuim31121999LeKitzba: parseFloat(tzviratPitzuim31121999LeKitzba),
                                        erechPidionPitzuimMaasikNochechi: parseFloat(erechPidionPitzuimMaasikNochechi),
                                        erechPidionMarkivPitzuimLemasNochechi: parseFloat(erechPidionMarkivPitzuimLemasNochechi),
                                        erechPidionPitzuimMaavidimKodmimRetzefZehuyut: parseFloat(erechPidionPitzuimMaavidimKodmimRetzefZehuyut),
                                        erechPidionPitzuimLeHonMaavidimKodmim: parseFloat(erechPidionPitzuimLeHonMaavidimKodmim),
                                        yitratPitzuimLeLoHitchashbenot: parseFloat(yitratPitzuimLeLoHitchashbenot),
                                        kayamRetzefPitzuimKitzba: kayamRetzefPitzuimKitzba,
                                        kayamRetzefPitzuimZechuyot: kayamRetzefPitzuimZechuyot
                                    });
                                    }
                                    

                                }
                         
                                let totalChisachon = 0;
                                const perutYitrotArray = Array.from(perutYitrot);
                                if (perutYitrotArray) {
                                
                                    for (const yitra of perutYitrotArray) {
                                        const totalChisachonMtzbr = cleanVal(getElementText(yitra, 'TOTAL-CHISACHON-MTZBR')) || 0;
                                        const totalErkeiPidion = cleanVal(getElementText(yitra, 'TOTAL-ERKEI-PIDION')) || 0;
                                        totalChisachon = totalChisachon + parseFloat(totalErkeiPidion);
                                    }
                                }

                                // ----- דמי ניהול (ריבוי רשומות) -----
                                let dmeyNihulSet = new Set();
                                let actualFeeFromDeposit = 0;
                                let actualFeeFromBalance = 0;
                                
                                const perutHotzaot = p.getElementsByTagName('PerutHotzaot')[0];
                                const mivneDmeiNihul = perutHotzaot ? perutHotzaot.getElementsByTagName('MivneDmeiNihul')[0] : null;
                                const dmeyElements = mivneDmeiNihul ? mivneDmeiNihul.getElementsByTagName('PerutMivneDmeiNihul') : [];
                                const dmey = Array.from(dmeyElements);
                                
                                for (const d of dmey) {
                                    const sugHotzaa = cleanVal(getElementText(d, 'SUG-HOTZAA')) || 0;
                                    const sheurDmeiNihul = cleanVal(getElementText(d, 'SHEUR-DMEI-NIHUL')) || '';
                                    const dmeiNihulAchidim = cleanVal(getElementText(d, 'DMEI-NIHUL-ACHIDIM'));
                                
                                    const kayemetHatava = cleanVal(getElementText(d, 'KAYEMET-HATAVA')) || '';
                                    const sugHatava = cleanVal(getElementText(d, 'SUG-HATAVA')) || '';
                                    const achozHatava = cleanVal(getElementText(d, 'ACHOZ-HATAVA')) || '';
                                    dmeyNihulSet.add(`${sugHotzaa}-${dmeiNihulAchidim}-${sheurDmeiNihul}`);
                                    
                                    // אם dmeiNihulAchidim = 1 (באחוזים)
                                    if (dmeiNihulAchidim === '1' || dmeiNihulAchidim === 1) {
                                        if (sugHotzaa === '1' || sugHotzaa === 1) {
                                            // דמי ניהול מצבירה
                                            actualFeeFromBalance = parseFloat(sheurDmeiNihul) || 0;
                                        } else if (sugHotzaa === '2' || sugHotzaa === 2) {
                                            // דמי ניהול מהפקדה
                                            actualFeeFromDeposit = parseFloat(sheurDmeiNihul) || 0;
                                        }
                                    }
                                }


                                const perutMasluleiHashkaaElements = p.getElementsByTagName('PerutMasluleiHashkaa');
                                const maslulim = Array.from(perutMasluleiHashkaaElements);
                                
                                // ריכוז מסלולים תחת מספר החשבון - כל מסלול פעם אחת עם סכום מצטבר
                                let maslulMap = new Map(); // מפה לקבץ מסלולים לפי קוד
                                
                                for (const maslul of maslulim) {
                                    const kodMaslolHashkaa = cleanVal(getElementText(maslul,'KOD-MASLUL-HASHKAA')) || '';
                                    pensiaVatikaOHadasha !=='' && pensiaVatikaOHadasha !=='null' ? kodMaslulSet.add(`${kodMaslolHashkaa}-${sugMutzar}-${pensiaVatikaOHadasha}`):
                                    kodMaslolHashkaa !=='' && kodMaslolHashkaa !=='null' ? kodMaslulSet.add(`${kodMaslolHashkaa}-${sugMutzar}-0`):'';
                                    const shemMaslulHashkaa = cleanVal(getElementText(maslul,'SHEM-MASLUL-HASHKAA')) || '';
                                    const schumTzvira = parseFloat(cleanVal(getElementText(maslul,'SCHUM-TZVIRA-BAMASLUL')) || 0);
                                    if(schumTzvira==0){continue;}
                                    
                                    // דמי ניהול - אחידים לכל המסלולים באותו חשבון מ-PerutMivneDmeiNihul
                                    // רק אם אין שם נתונים, ניקח מהמסלול עצמו
                                    const sheurDmeyNihulHafkadMivne = actualFeeFromDeposit || 
                                        parseFloat(cleanVal(getElementText(maslul,'SHEUR-DMEI-NIHUL-HAFKADA-MIVNE')) || 0);
                                    const sheurDmeyNihulHisachonMivne = actualFeeFromBalance || 
                                        parseFloat(cleanVal(getElementText(maslul,'SHEUR-DMEI-NIHUL-HISACHON-MIVNE')) || 0);
                                    
                                    const tesuaNeto = cleanVal(getElementText(maslul,'TSUA-NETO')) || '';
                                    const shiurAlotShnatitZpuiaLmslulHashkah = cleanVal(getElementText(maslul,'SHIUR-ALUT-SHNATIT-ZPUIA-LMSLUL-HASHKAH')) || '';
                                    const kodSugMaslul = cleanVal(getElementText(maslul,'KOD-SUG-MASLUL')) || '';
                                    
                                    // אם המסלול כבר קיים במפה, הוסף את הסכום
                                    if (maslulMap.has(kodMaslolHashkaa)) {
                                        const existingMaslul = maslulMap.get(kodMaslolHashkaa);
                                        existingMaslul.schumTzvira += schumTzvira;
                                        existingMaslul.count += 1; // ספירת מופעים
                                    } else {
                                        // מסלול חדש - הוסף למפה
                                       if(totalChisachon>0){
                                            maslulMap.set(kodMaslolHashkaa,{
                                                kodMaslolHashkaa,
                                                shemMaslulHashkaa,
                                                schumTzvira,
                                                sheurDmeyNihulHafkadMivne,
                                                sheurDmeyNihulHisachonMivne,
                                                tesuaNeto,
                                                shiurAlotShnatitZpuiaLmslulHashkah,
                                                kodSugMaslul,
                                                pensiaVatikaOHadasha, 
                                                count: 1
                                            });
                                              
                                        }
                                    }
                                }
                                
                                // המרת המפה למערך לסיכום
                                const maslulDetails = Array.from(maslulMap.values());
                                const totalSchumTzviraBamaslul = maslulDetails.reduce((sum, maslul) => sum + maslul.schumTzvira, 0);
                             
                                
                                const mafyenMaslulim='maslulim-'+misparPolisaOHeshbon;
                                // בניית אובייקט עם רק מאפיינים שיש להם ערך
                                const heshbonObj = {
                                  misparPolisaOHeshbon:misparPolisaOHeshbon,
                                  statusPolisaOCheshbon:statusPolisaOCheshbon,
                                  sugMutzar:sugMutzar,
                                  shemTochnit:shemTochnit,
                                  totalChisachon:totalChisachon.toLocaleString('he-IL', {maximumFractionDigits: 0})+""+"שח",
                                  totalChisachonV:parseFloat(totalChisachon),
                                  mafyenMaslulim:maslulDetails
                                };
                                
                                // הוספת מאפיינים אופציונליים רק אם יש להם ערך
                                if (ksafimPturim) heshbonObj.ksafimPturim = ksafimPturim;
                                if (sugPolisa) heshbonObj.sugPolisa = sugPolisa;
                                if (mekademGilPrishaTzafuy) heshbonObj.mekademGilPrishaTzafuy = mekademGilPrishaTzafuy;
                                if (taarichHitztarfutMutzar) heshbonObj.taarichHitztarfutMutzar = taarichHitztarfutMutzar;
                                if (shemMaslulHabituah) heshbonObj.shemMaslulHabituah = shemMaslulHabituah;
                                if (shemMaasik) heshbonObj.shemMaasik = shemMaasik;
                                if (yitratKaspeyTagmulimValue && yitratKaspeyTagmulimValue > 0) {
                                    heshbonObj.yitratKaspeyTagmulimValue = Math.round(yitratKaspeyTagmulimValue);
                                }
                                if (yitrotKaspeyPizoyim && Array.isArray(yitrotKaspeyPizoyim) && yitrotKaspeyPizoyim.length > 0) {
                                    heshbonObj.yitrotKaspeyPizoyim = yitrotKaspeyPizoyim;
                                }
                                if (PirteiHafkadaAchrona && Array.isArray(PirteiHafkadaAchrona) && PirteiHafkadaAchrona.length > 0) {
                                    heshbonObj.PirteiHafkadaAchrona = PirteiHafkadaAchrona;
                                }
                                if (pirteiHaasaka && Array.isArray(pirteiHaasaka) && pirteiHaasaka.length > 0) {
                                    heshbonObj.pirteiHaasaka = pirteiHaasaka;
                                }
                                
                                pirteiHeshbon.push(heshbonObj);
                               PirtPirteiHafkadaAchrona=[];
                                pirteiHaasaka=[];
                               yitrotKaspeyPizoyim=[];
                               
                            }
                           
                        }
                          
                    } catch (err) {
                        console.error(`❌ Error in file ${file.name}:`, err);
                    }
                } // סגירת הלולאה for (const file of uploadedFiles)
                 DataAll.push(pratimIshim);
                 DataAll.push(sumSugMutzar);
                 DataAll.push(pirteiHeshbon.filter(item=>Number(item.totalChisachonV)>0));
                 
                 // איסוף נתוני פיצויים מכל החשבונות
                 let allPitzuimData = [];
                 pirteiHeshbon.forEach(item => {
                     if (item.yitrotKaspeyPizoyim && item.yitrotKaspeyPizoyim.length > 0) {
                         allPitzuimData = allPitzuimData.concat(item.yitrotKaspeyPizoyim);
                     }
                 });
                 DataAll.push(allPitzuimData);

                 const kaspeyTagmulimData=DataAll[2].filter(item=>item.yitratKaspeyTagmulimValue>0);
                let kaspeyTagmulimSum=0;
                 kaspeyTagmulimData.forEach(item=>{
                    if(item.yitratKaspeyTagmulimValue && item.yitratKaspeyTagmulimValue>0){
                        kaspeyTagmulimSum+=item.yitratKaspeyTagmulimValue;  
                    } 
                 });
                 
                         
                const kodMaslulDetails=DataAll[2]
                let summary = {};
                kodMaslulDetails.forEach(product => {
                    product.mafyenMaslulim.forEach(mslul => {
                        const key = `${product.sugMutzar}__${mslul.shemMaslulHashkaa}`;

                        if (!summary[key]) {
                        summary[key] = {
                            sugMutzar:product.sugMutzar,
                            shemMaslulHashkaa: mslul.shemMaslulHashkaa,
                            totalSchumTzvira: 0
                        };
                        }

                        summary[key].totalSchumTzvira += mslul.schumTzvira || 0;
                    });
                                    
                });
                const result = Object.values(summary);
                result.forEach(item => {
                    item.sugMutzar=sugTochnitOHeshbon[item.sugMutzar];
                });
                
                // הצגת הנתונים על המסך
                displayDataOnScreen(pratimIshim, sumSugMutzar, result, sheabudIkulHalvaa, DataAll[3]);
                console.log(DataAll)
                // הדפסת סיכום הנתונים שנאספו מכל הקבצים
            

            } catch (error) {
                dataContent.innerHTML = `<div style="color: #ff6b6b; text-align: right; padding: 2rem;">
                    <i class="fas fa-exclamation-triangle"></i><br>
                    שגיאה בקריאת הקבצים: ${error.message}
                </div>`;
            }
        });

        function calculateSummary(mutzarim) {
            let totalBalance = 0;
            let totalContributions = 0;
            let totalManagementFees = 0;
            const productTypes = {};

            mutzarim.forEach(mutzar => {
                mutzar.heshbonotOPolisot.forEach(heshbon => {
                    heshbon.perutYitrot.forEach(yitra => {
                        totalBalance += yitra.totalErkeiPidion;
                        totalContributions += yitra.totalHafkadot;
                        totalManagementFees += yitra.dmeiNihulShnatiim;
                        
                        const productType = mutzar.sugMutzarDescription;
                        if (!productTypes[productType]) {
                            productTypes[productType] = 0;
                        }
                        productTypes[productType] += yitra.totalErkeiPidion;
                    });
                });
            });

            return {
                totalBalance,
                totalContributions,
                totalManagementFees,
                productTypes,
                totalProducts: mutzarim.length
            };
        }

        function displayFileData(allData) {
            let html = '';
            
            allData.forEach(fileData => {
                html += `<div style="margin-bottom: 2rem;">`;
                html += `<h4 style="color: #0183AA; margin-bottom: 1rem;">${fileData.fileName}</h4>`;
                
                if (fileData.data.error) {
                    html += `<div style="background: #f8d7da; padding: 1rem; border-radius: 8px; border: 1px solid #f5c6cb; color: #721c24;">
                        <i class="fas fa-exclamation-triangle"></i> ${fileData.data.error}
                    </div>`;
                } else if (fileData.data.type === 'xml') {
                    const pensionData = fileData.data.data;
                    
                    // Participant Information
                    if (Object.keys(pensionData.participantInfo).length > 0) {
                        html += '<div style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e2e8f0; margin-bottom: 1rem;">';
                        html += '<h5 style="color: #0183AA; margin-bottom: 0.5rem;"><i class="fas fa-user"></i> פרטי המשתתף</h5>';
                        html += '<table class="data-table">';
                        Object.entries(pensionData.participantInfo).forEach(([key, value]) => {
                            if (value) {
                                html += `<tr><td><strong>${key}:</strong></td><td>${value}</td></tr>`;
                            }
                        });
                        html += '</table></div>';
                    }
                    
                    // Summary Information
                    if (Object.keys(pensionData.summary).length > 0) {
                        html += '<div style="background: #e8f5e8; padding: 1rem; border-radius: 8px; border: 1px solid #c3e6c3; margin-bottom: 1rem;">';
                        html += '<h5 style="color: #28a745; margin-bottom: 0.5rem;"><i class="fas fa-chart-line"></i> סיכום כללי</h5>';
                        html += '<table class="data-table">';
                        Object.entries(pensionData.summary).forEach(([key, value]) => {
                            if (value) {
                                html += `<tr><td><strong>${key}:</strong></td><td>${value}</td></tr>`;
                            }
                        });
                        html += '</table></div>';
                    }
                    
                    // Balances
                    if (Object.keys(pensionData.balances).length > 0) {
                        html += '<div style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e2e8f0; margin-bottom: 1rem;">';
                        html += '<h5 style="color: #0183AA; margin-bottom: 0.5rem;"><i class="fas fa-wallet"></i> יתרות</h5>';
                        html += '<table class="data-table">';
                        Object.entries(pensionData.balances).forEach(([type, balance]) => {
                            html += `<tr><td><strong>${type}:</strong></td><td>${balance.amount || 'לא זמין'} ${balance.currency || ''}</td></tr>`;
                        });
                        html += '</table></div>';
                    }
                    
                    // Contributions
                    if (pensionData.contributions.length > 0) {
                        html += '<div style="background: white; padding: 1rem; border-radius: 8px; border: 1px solid #e2e8f0; margin-bottom: 1rem;">';
                        html += '<h5 style="color: #0183AA; margin-bottom: 0.5rem;"><i class="fas fa-coins"></i> הפקדות</h5>';
                        html += '<table class="data-table">';
                        html += '<thead><tr><th>תאריך</th><th>סכום</th><th>סוג</th><th>מעסיק</th></tr></thead><tbody>';
                        
                        pensionData.contributions.slice(0, 10).forEach(contrib => {
                            html += '<tr>';
                            html += `<td>${contrib.date || ''}</td>`;
                            html += `<td>${contrib.amount || ''}</td>`;
                            html += `<td>${contrib.type || ''}</td>`;
                            html += `<td>${contrib.employer || ''}</td>`;
                            html += '</tr>';
                        });
                        html += '</tbody></table>';
                        
                        if (pensionData.contributions.length > 10) {
                            html += `<p style="text-align: right; color: #666; margin-top: 1rem;">
                                מציג 10 הפקדות ראשונות מתוך ${pensionData.contributions.length} הפקדות
                            </p>`;
                        }
                        html += '</div>';
                    }
                    
                    // Raw XML preview
                    html += '<div style="background: #f8f9fa; padding: 1rem; border-radius: 8px; border: 1px solid #dee2e6;">';
                    html += '<h5 style="color: #6c757d; margin-bottom: 0.5rem;"><i class="fas fa-code"></i> תצוגת XML (חלקית)</h5>';
                    html += `<pre style="background: #2d3748; color: #e2e8f0; padding: 1rem; border-radius: 4px; overflow-x: auto; font-size: 0.8rem;">${fileData.data.rawContent}</pre>`;
                    html += '</div>';
                }
                
                html += '</div>';
            });
            
            dataContent.innerHTML = html;
        }

        // Delete files button
        deleteFilesBtn.addEventListener('click', () => {
            closeDataDisplay();
        });

        // Close chart button
        closeChartBtn.addEventListener('click', () => {
            document.getElementById('chartContainer').style.display = 'none';
            uploadedFilesDiv.style.display = 'none';
            fileDataDisplay.style.display = 'none';
            fileUploadArea.style.display = 'none';
            fileUpload.style.display = 'none';

        });

        // Close and delete button
        closeAndDeleteBtn.addEventListener('click', () => {
                // ניקוי sessionStorage של נתוני ניתוח מתקדם לפני ריענון
                sessionStorage.removeItem('gilForAdvancedAnalysis');
                sessionStorage.removeItem('ageToRetirementForAdvancedAnalysis');
                sessionStorage.removeItem('sumHonForAdvancedAnalysis');
                sessionStorage.removeItem('sumKitzvaForAdvancedAnalysis');
                sessionStorage.removeItem('riskProfile');
                sessionStorage.removeItem('riskScore');
                sessionStorage.removeItem('riskSource');
                sessionStorage.removeItem('advancedAnalysisData');
                
                // רענון הדף
                window.location.reload();
        });

        // Smooth scroll to file upload section
        document.querySelectorAll('a[href="#fileUpload"]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Check if process is active - only check if containers are visible (not none)
                const isProcessActive = (uploadedFilesDiv.style.display === 'block' || uploadedFilesDiv.style.display === 'flex') || 
                                     (fileDataDisplay.style.display === 'block' || fileDataDisplay.style.display === 'flex') || 
                                     (document.getElementById('chartContainer').style.display === 'block' || document.getElementById('chartContainer').style.display === 'flex');
                
                if (isProcessActive) {
                    closeDataDisplay(); 
                    
                }
                
                const fileUploadSection = document.getElementById('fileUpload');
                if (fileUploadSection) {
                    fileUploadSection.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // Add a subtle highlight effect
                    fileUploadSection.style.transition = 'box-shadow 0.3s ease';
                    fileUploadSection.style.boxShadow = '0 0 30px #0183AA';
                    
                    setTimeout(() => {
                        fileUploadSection.style.boxShadow = '';
                    }, 2000);
                }
            });
        });
        
        // Advanced Analysis functionality
        advancedAnalysisBtn.addEventListener('click', () => {
            // ניקוי רמת סיכון לפני מעבר לניתוח מתקדם
            sessionStorage.removeItem('riskProfile');
            sessionStorage.removeItem('riskScore');
            sessionStorage.removeItem('riskSource');
           
            window.location.href = 'advancedAnalysis.html';
        });

        backToUploadBtn.addEventListener('click', () => {
            document.getElementById('advancedAnalysis').style.display = 'none';
            document.getElementById('fileUpload').scrollIntoView({ behavior: 'smooth' });
        });

        exportDataBtn.addEventListener('click', () => {
            exportAnalysisData();
        });

        generateReportBtn.addEventListener('click', () => {
            generatePDFReport();
        });

        // Close file upload section button
        closeFileUploadSectionBtn.addEventListener('click', () => {
            closeDataDisplay();
        });
        function closeDataDisplay(){ 
            Swal.fire({
                title: '<span style="color: #333; font-size: 1.5rem;">האם אתה בטוח?</span>',
                html: '<p style="color: #666; font-size: 1.1rem;">הדף ירוענן וכל הנתונים יימחקו</p>',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#dc3545',
                cancelButtonColor: '#6c757d',
                confirmButtonText: 'כן, רענן את הדף',
                cancelButtonText: 'ביטול',
                width: 'clamp(300px, 90vw, 500px)',
                customClass: {
                    confirmButton: 'swal-confirm-btn',
                    cancelButton: 'swal-cancel-btn'
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    // ניקוי sessionStorage של נתוני ניתוח מתקדם לפני ריענון
                    sessionStorage.removeItem('gilForAdvancedAnalysis');
                    sessionStorage.removeItem('ageToRetirementForAdvancedAnalysis');
                    sessionStorage.removeItem('sumHonForAdvancedAnalysis');
                    sessionStorage.removeItem('sumKitzvaForAdvancedAnalysis');
                    sessionStorage.removeItem('riskProfile');
                    sessionStorage.removeItem('riskScore');
                    sessionStorage.removeItem('riskSource');
                    sessionStorage.removeItem('advancedAnalysisData');
                    
                    // רענון הדף - הדרך הכי נקייה לאפס הכל!
                    window.location.reload();
                }
            });
        }

        // Tab switching functionality
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabName = button.getAttribute('data-tab');
                switchTab(tabName);
            });
        });

        function performAdvancedAnalysis() {
            if (!dataMislaka) {
                document.getElementById('advancedAnalysis').style.display = 'none';
                alert('אין נתונים זמינים לניתוח');
                return;
            }

            // Perform different types of analysis
            analyzeReturns();
            analyzeFees();
            analyzeLiquidity();
            analyzePathways();
            analyzeRetirement();
            generateSummary();
        }

        function analyzePathways() {
            const pathwaysData = calculatePathwaysAnalysis();
            displayPathwaysChart(pathwaysData);
            displayOptimizationRecommendations(pathwaysData);
        }

        function calculatePathwaysAnalysis() {
            if (!dataMislaka || !dataMislaka.data) {
                return {
                    totalPathways: 0,
                    pathwayTypes: {},
                    averageReturn: 0,
                    recommendations: []
                };
            }

            let totalPathways = 0;
            let pathwayTypes = {};
            let totalReturn = 0;
            let returnCount = 0;

            for (const fileData of dataMislaka.data) {
                if (fileData.data && fileData.data.accounts) {
                    for (const account of fileData.data.accounts) {
                        if (account.pathways) {
                            for (const pathway of account.pathways) {
                                totalPathways++;
                                const pathwayName = pathway.shemMasulHashkaa || 'לא ידוע';
                                pathwayTypes[pathwayName] = (pathwayTypes[pathwayName] || 0) + 1;
                                
                                if (pathway.tsuaNeto) {
                                    totalReturn += pathway.tsuaNeto;
                                    returnCount++;
                                }
                            }
                        }
                    }
                }
            }

            const averageReturn = returnCount > 0 ? totalReturn / returnCount : 0;

            return {
                totalPathways,
                pathwayTypes,
                averageReturn,
                recommendations: generatePathwayRecommendations(pathwayTypes, averageReturn)
            };
        }

        function displayPathwaysChart(data) {
            const ctx = document.getElementById('pathwaysChart');
            if (!ctx) return;

            const labels = Object.keys(data.pathwayTypes);
            const values = Object.values(data.pathwayTypes);

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF',
                            '#FF9F40'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function displayOptimizationRecommendations(data) {
            const container = document.getElementById('optimizationRecommendations');
            if (!container) return;

            container.innerHTML = data.recommendations.map(rec => 
                `<div class="recommendation-item">${rec}</div>`
            ).join('');
        }

        function generatePathwayRecommendations(pathwayTypes, averageReturn) {
            const recommendations = [];
            
            if (Object.keys(pathwayTypes).length > 5) {
                recommendations.push('יש לך יותר מדי מסלולי השקעה - שקול לאחד מסלולים דומים');
            }
            
            if (averageReturn < 3) {
                recommendations.push('התשואות נמוכות - שקול להעביר למסלולים עם פוטנציאל תשואה גבוה יותר');
            }
            
            if (Object.keys(pathwayTypes).length < 2) {
                recommendations.push('יש לך מעט מדי מסלולי השקעה - שקול לגוון את התיק');
            }
            
            return recommendations.length > 0 ? recommendations : ['התיק שלך מאוזן ומגוון'];
        }

        function analyzeReturns() {
            const returnsData = calculateReturnsAnalysis();
            displayReturnsChart(returnsData);
            displayMarketComparison(returnsData);
        }

        function analyzeFees() {
            const feesData = calculateFeesAnalysis();
            displayFeesChart(feesData);
            displayFeesImpact(feesData);
        }

        function analyzeLiquidity() {
            const liquidityData = calculateLiquidityAnalysis();
            displayLiquidityChart(liquidityData);
            displayAvailabilityTable(liquidityData);
        }

        function analyzeRetirement() {
            const retirementData = calculateRetirementAnalysis();
            
            displayRetirementAccumulation(retirementData);
            displayRetirementPensions(retirementData);
            displayRetirementAgeCalculation(retirementData);
            displayRetirementRecommendations(retirementData);
        }

        function calculateRetirementAnalysis() {
            if (!dataMislaka || !dataMislaka.data) {
                return {
                    currentAge: 0,
                    retirementAge: 0,
                    yearsToRetirement: 0,
                    currentBalance: 0,
                    projectedBalance: 0,
                    monthlyPension: 0,
                    annualPension: 0,
                    pensionReplacementRate: 0
                };
            }


            // Extract participant info from all files
            let participantInfo = null;
            let birthDate = null;
            let currentAge = 35; // Default age
            
            // Search through all files for participant info
            for (const fileData of dataMislaka.data) {
                if (fileData.data && fileData.data.participantInfo) {
                    participantInfo = fileData.data.participantInfo;
                    birthDate = participantInfo.taarichLeyda;
                    if (birthDate) break; // Found birth date, stop searching
                }
            }
            
            // Calculate current age
            if (birthDate && birthDate.length >= 8) {
                const year = parseInt(birthDate.substring(0, 4));
                const month = parseInt(birthDate.substring(4, 6));
                const day = parseInt(birthDate.substring(6, 8));
                const birthDateObj = new Date(year, month - 1, day);
                const today = new Date();
                currentAge = today.getFullYear() - birthDateObj.getFullYear();
                if (today.getMonth() < birthDateObj.getMonth() || 
                    (today.getMonth() === birthDateObj.getMonth() && today.getDate() < birthDateObj.getDate())) {
                    currentAge--;
                }
            }

            // Default retirement age (67 for men, 62 for women - simplified)
            const retirementAge = 67;
            const yearsToRetirement = Math.max(0, retirementAge - currentAge);

            // Calculate current balance
            const currentBalance = dataMislaka.summary ? dataMislaka.summary.totalBalance : 0;

            // Project future balance based on product types
            let projectedBalanceWithContributions = 0;
            let projectedBalanceWithoutContributions = 0;
            let monthlyPensionWithContributions = 0;
            let monthlyPensionWithoutContributions = 0;
            
            // Calculate based on actual data from PDF
            let productDetails = [];
            
            if (dataMislaka.data && dataMislaka.data.length > 0) {
                // Group by product type
                let productGroups = {};
                
                for (const fileData of dataMislaka.data) {
                    if (fileData.data && fileData.data.accounts && fileData.data.accounts.length > 0) {
                        
                        for (const account of fileData.data.accounts) {
                            const sugMutzar = account.sugMutzar;
                            const sugMutzarDescription = account.sugMutzarDescription;
                            
                            // Calculate current balance for this account
                            let accountBalance = 0;
                            if (account.balances && account.balances.length > 0) {
                                account.balances.forEach(balance => {
                                    accountBalance += balance.totalErkeiPidion || 0;
                                });
                            }
                            
                            // Group by product type
                            if (!productGroups[sugMutzarDescription]) {
                                productGroups[sugMutzarDescription] = {
                                    productType: sugMutzarDescription,
                                    currentBalance: 0,
                                    projectedWithoutContributions: 0,
                                    projectedWithContributions: 0,
                                    monthlyPensionWithoutContributions: 0,
                                    monthlyPensionWithContributions: 0,
                                    pensionRelevant: true,
                                    hasYitraLefiGilPrisha: false
                                };
                            }
                            
                            productGroups[sugMutzarDescription].currentBalance += accountBalance;
                            
                            // Check if has YitraLefiGilPrisha block
                            let hasYitraBlock = false;
                            let yitraData = null;
                            
                            // Search for YitraLefiGilPrisha in the account data
                            if (account.yitraLefiGilPrisha) {
                                hasYitraBlock = true;
                                yitraData = account.yitraLefiGilPrisha;
                                productGroups[sugMutzarDescription].hasYitraLefiGilPrisha = true;
                            }
                            
                            // Calculate projections based on product type and Yitra block
                            if (sugMutzarDescription === 'קרן פנסיה ותיקה') {
                                if (hasYitraBlock && yitraData) {
                                    // Use data from YitraLefiGilPrisha block
                                    const totalChisachonMitztaberTzafuy = yitraData.totalChisachonMitztaberTzafuy || 0;
                                    const tzviratChisachonChzuyaLeloPremiyot = yitraData.tzviratChisachonChzuyaLeloPremiyot || 0;
                                    
                                    productGroups[sugMutzarDescription].projectedWithContributions += totalChisachonMitztaberTzafuy;
                                    productGroups[sugMutzarDescription].projectedWithoutContributions += tzviratChisachonChzuyaLeloPremiyot;
                                    
                                    // Get pension data from Kupot
                                    if (yitraData.kupot && yitraData.kupot.length > 0) {
                                        for (const kupa of yitraData.kupot) {
                                            const schumKitzvatZikna = kupa.schumKitzvatZikna || 0;
                                            const kitzvatHodshitTzfuya = kupa.kitzvatHodshitTzfuya || 0;
                                            
                                            productGroups[sugMutzarDescription].monthlyPensionWithContributions += schumKitzvatZikna;
                                            productGroups[sugMutzarDescription].monthlyPensionWithoutContributions += kitzvatHodshitTzfuya;
                                        }
                                    }
                                } else {
                                    // No Yitra block - use default calculation
                                    productGroups[sugMutzarDescription].projectedWithoutContributions += accountBalance;
                                    productGroups[sugMutzarDescription].monthlyPensionWithoutContributions += accountBalance * 0.001; // 0.1% monthly
                                }
                            } else if (sugMutzarDescription === 'קרן פנסיה חדשה') {
                                if (hasYitraBlock && yitraData) {
                                    // Use data from YitraLefiGilPrisha block
                                    const totalChisachonMitztaberTzafuy = yitraData.totalChisachonMitztaberTzafuy || 0;
                                    const tzviratChisachonChzuyaLeloPremiyot = yitraData.tzviratChisachonChzuyaLeloPremiyot || 0;
                                    
                                    productGroups[sugMutzarDescription].projectedWithContributions += totalChisachonMitztaberTzafuy;
                                    productGroups[sugMutzarDescription].projectedWithoutContributions += tzviratChisachonChzuyaLeloPremiyot;
                                    
                                    // Get pension data from Kupot
                                    if (yitraData.kupot && yitraData.kupot.length > 0) {
                                        for (const kupa of yitraData.kupot) {
                                            const schumKitzvatZikna = kupa.schumKitzvatZikna || 0;
                                            const kitzvatHodshitTzfuya = kupa.kitzvatHodshitTzfuya || 0;
                                            
                                            productGroups[sugMutzarDescription].monthlyPensionWithContributions += schumKitzvatZikna;
                                            productGroups[sugMutzarDescription].monthlyPensionWithoutContributions += kitzvatHodshitTzfuya;
                                        }
                                    }
                                } else {
                                    // No Yitra block - use default calculation
                                    const annualReturn = 0.06; // 6% annual return
                                    const monthlyContribution = 1500; // Estimated monthly contribution
                                    const annualContribution = monthlyContribution * 12;
                                    
                                    let projectedBalance = accountBalance;
                                    for (let i = 0; i < yearsToRetirement; i++) {
                                        projectedBalance = projectedBalance * (1 + annualReturn) + annualContribution;
                                    }
                                    
                                    productGroups[sugMutzarDescription].projectedWithContributions += projectedBalance;
                                    productGroups[sugMutzarDescription].monthlyPensionWithContributions += projectedBalance * 0.004; // 4% withdrawal rate
                                    
                                    // Also add without contributions
                                    productGroups[sugMutzarDescription].projectedWithoutContributions += accountBalance;
                                    productGroups[sugMutzarDescription].monthlyPensionWithoutContributions += accountBalance * 0.004;
                                }
                            } else if (sugMutzarDescription === 'קופת גמל' || sugMutzarDescription === 'קופת גמל להשקעה') {
                                // קופות גמל
                                if (hasYitraBlock && yitraData) {
                                    // Has Yitra block - use existing data
                                    const totalChisachonMitztaberTzafuy = yitraData.totalChisachonMitztaberTzafuy || 0;
                                    const tzviratChisachonChzuyaLeloPremiyot = yitraData.tzviratChisachonChzuyaLeloPremiyot || 0;
                                    
                                    productGroups[sugMutzarDescription].projectedWithContributions += totalChisachonMitztaberTzafuy;
                                    productGroups[sugMutzarDescription].projectedWithoutContributions += tzviratChisachonChzuyaLeloPremiyot;
                                } else {
                                    // No Yitra block - use current balance
                                    productGroups[sugMutzarDescription].projectedWithoutContributions += accountBalance;
                                    productGroups[sugMutzarDescription].projectedWithContributions += accountBalance;
                                }
                                productGroups[sugMutzarDescription].pensionRelevant = false; // Not relevant for pensions
                            } else if (sugMutzarDescription === 'קרן השתלמות') {
                                // קרן השתלמות
                                if (hasYitraBlock && yitraData) {
                                    // Has Yitra block - use existing data
                                    const totalChisachonMitztaberTzafuy = yitraData.totalChisachonMitztaberTzafuy || 0;
                                    const tzviratChisachonChzuyaLeloPremiyot = yitraData.tzviratChisachonChzuyaLeloPremiyot || 0;
                                    
                                    productGroups[sugMutzarDescription].projectedWithContributions += totalChisachonMitztaberTzafuy;
                                    productGroups[sugMutzarDescription].projectedWithoutContributions += tzviratChisachonChzuyaLeloPremiyot;
                                } else {
                                    // No Yitra block - use current balance
                                    productGroups[sugMutzarDescription].projectedWithoutContributions += accountBalance;
                                    productGroups[sugMutzarDescription].projectedWithContributions += accountBalance;
                                }
                                productGroups[sugMutzarDescription].pensionRelevant = false; // Not relevant for pensions
                            } else {
                                // Other products (insurance companies) - with contributions
                                const annualReturn = 0.05;
                                const monthlyContribution = 1000;
                                const annualContribution = monthlyContribution * 12;
                                
                                let projectedBalance = accountBalance;
                                for (let i = 0; i < yearsToRetirement; i++) {
                                    projectedBalance = projectedBalance * (1 + annualReturn) + annualContribution;
                                }
                                
                                productGroups[sugMutzarDescription].projectedWithContributions += projectedBalance;
                                productGroups[sugMutzarDescription].monthlyPensionWithContributions += projectedBalance * 0.004;
                                
                                productGroups[sugMutzarDescription].projectedWithoutContributions += accountBalance;
                                productGroups[sugMutzarDescription].monthlyPensionWithoutContributions += accountBalance * 0.004;
                            }
                        }
                    }
                }
                
                // Convert to array
                productDetails = Object.values(productGroups);
                
                // Calculate totals
                for (const product of productDetails) {
                    projectedBalanceWithContributions += product.projectedWithContributions;
                    projectedBalanceWithoutContributions += product.projectedWithoutContributions;
                    monthlyPensionWithContributions += product.monthlyPensionWithContributions;
                    monthlyPensionWithoutContributions += product.monthlyPensionWithoutContributions;
                }
                
            }
            
            // Use the higher value (with contributions) as the main projection
            const projectedBalance = Math.max(projectedBalanceWithContributions, projectedBalanceWithoutContributions);
            const monthlyPension = Math.max(monthlyPensionWithContributions, monthlyPensionWithoutContributions);
            const annualPension = monthlyPension * 12;
            
            // Calculate replacement rate (assuming current income)
            const currentIncome = 15000; // Default assumption
            const pensionReplacementRate = (monthlyPension / currentIncome) * 100;

            return {
                currentAge,
                retirementAge,
                yearsToRetirement,
                currentBalance,
                projectedBalance,
                projectedBalanceWithContributions,
                projectedBalanceWithoutContributions,
                monthlyPension,
                monthlyPensionWithContributions,
                monthlyPensionWithoutContributions,
                annualPension,
                pensionReplacementRate,
                productDetails,
                monthlyContribution: 1500, // Default assumption
                annualContribution: 1500 * 12
            };
        }

        function displayRetirementAccumulation(data) {
            const container = document.getElementById('retirementAccumulation');
            
            let html = '<div class="retirement-summary">';
            html += '<h4>סיכום כללי</h4>';
            html += `<div class="retirement-item">
                <span class="retirement-label">יתרה נוכחית:</span>
                <span class="retirement-value"><span class="currency-value">${new Intl.NumberFormat('he-IL', {style: 'currency', currency: 'ILS'}).format(data.currentBalance).replace('₪', '₪ ').trim()}</span></span>
            </div>`;
            html += `<div class="retirement-item">
                <span class="retirement-label">שנים עד פרישה:</span>
                <span class="retirement-value">${data.yearsToRetirement} שנים</span>
            </div>`;
            html += '</div>';

            html += '<div class="retirement-details">';
            html += '<h4>פירוט לפי סוג מוצר</h4>';
            html += '<table class="data-table" dir="rtl">';
            html += '<thead><tr><th>סוג מוצר</th><th>יתרה נוכחית</th><th>צבירה צפויה (ללא הפקדות)</th><th>צבירה צפויה (עם הפקדות)</th></tr></thead>';
            html += '<tbody>';

            if (data.productDetails) {
                for (const product of data.productDetails) {
                    const currentBalanceFormatted = new Intl.NumberFormat('he-IL', {style: 'currency', currency: 'ILS'}).format(product.currentBalance).replace('₪', '₪ ').trim();
                    const projectedWithoutFormatted = new Intl.NumberFormat('he-IL', {style: 'currency', currency: 'ILS'}).format(product.projectedWithoutContributions).replace('₪', '₪ ').trim();
                    const projectedWithFormatted = new Intl.NumberFormat('he-IL', {style: 'currency', currency: 'ILS'}).format(product.projectedWithContributions).replace('₪', '₪ ').trim();
                    
                    html += `<tr>
                        <td><span class="product-type">${product.productType}</span></td>
                        <td><span class="currency-value">${currentBalanceFormatted}</span></td>
                        <td><span class="currency-value">${projectedWithoutFormatted}</span></td>
                        <td><span class="currency-value">${projectedWithFormatted}</span></td>
                    </tr>`;
                }
            }

            html += '</tbody></table></div>';
            container.innerHTML = html;
        }

        function displayRetirementPensions(data) {
            const container = document.getElementById('retirementPensions');
            
            let html = '<div class="retirement-summary">';
            html += '<h4>סיכום קצבאות</h4>';
            html += `<div class="retirement-item">
                <span class="retirement-label">קצבה חודשית (עם הפקדות):</span>
                <span class="retirement-value"><span class="currency-value">${new Intl.NumberFormat('he-IL', {style: 'currency', currency: 'ILS'}).format(data.monthlyPensionWithContributions).replace('₪', '₪ ').trim()}</span></span>
            </div>`;
            html += `<div class="retirement-item">
                <span class="retirement-label">קצבה חודשית (ללא הפקדות):</span>
                <span class="retirement-value"><span class="currency-value">${new Intl.NumberFormat('he-IL', {style: 'currency', currency: 'ILS'}).format(data.monthlyPensionWithoutContributions).replace('₪', '₪ ').trim()}</span></span>
            </div>`;
            html += '</div>';

            html += '<div class="retirement-details">';
            html += '<h4>פירוט קצבאות לפי סוג מוצר</h4>';
            html += '<table class="data-table" dir="rtl">';
            html += '<thead><tr><th>סוג מוצר</th><th>קצבה חודשית (ללא הפקדות)</th><th>קצבה חודשית (עם הפקדות)</th><th>הערות</th></tr></thead>';
            html += '<tbody>';

            if (data.productDetails) {
                for (const product of data.productDetails) {
                    const monthlyPensionWithout = product.monthlyPensionWithoutContributions || 0;
                    const monthlyPensionWith = product.monthlyPensionWithContributions || 0;
                    const notes = product.pensionRelevant ? '' : 'לא רלוונטי';
                    
                    const pensionWithoutFormatted = monthlyPensionWithout > 0 ? 
                        new Intl.NumberFormat('he-IL', {style: 'currency', currency: 'ILS'}).format(monthlyPensionWithout).replace('₪', '₪ ').trim() : 
                        `<span class="not-relevant">${notes}</span>`;
                    
                    const pensionWithFormatted = monthlyPensionWith > 0 ? 
                        new Intl.NumberFormat('he-IL', {style: 'currency', currency: 'ILS'}).format(monthlyPensionWith).replace('₪', '₪ ').trim() : 
                        `<span class="not-relevant">${notes}</span>`;
                    
                    html += `<tr>
                        <td><span class="product-type">${product.productType}</span></td>
                        <td>${monthlyPensionWithout > 0 ? `<span class="currency-value">${pensionWithoutFormatted}</span>` : pensionWithoutFormatted}</td>
                        <td>${monthlyPensionWith > 0 ? `<span class="currency-value">${pensionWithFormatted}</span>` : pensionWithFormatted}</td>
                        <td><span class="not-relevant">${notes}</span></td>
                    </tr>`;
                }
            }

            html += '</tbody></table></div>';
            container.innerHTML = html;
        }

        function displayRetirementAgeCalculation(data) {
            const container = document.getElementById('retirementAgeCalculation');
            
            container.innerHTML = `
                <div class="retirement-item">
                    <span class="retirement-label">גיל נוכחי:</span>
                    <span class="retirement-value">${data.currentAge} שנים</span>
                </div>
                <div class="retirement-item">
                    <span class="retirement-label">גיל פרישה:</span>
                    <span class="retirement-value">${data.retirementAge} שנים</span>
                </div>
                <div class="retirement-item">
                    <span class="retirement-label">שנים עד פרישה:</span>
                    <span class="retirement-value">${data.yearsToRetirement} שנים</span>
                </div>
                <div class="retirement-item">
                    <span class="retirement-label">תאריך פרישה משוער:</span>
                    <span class="retirement-value">${new Date().getFullYear() + data.yearsToRetirement}</span>
                </div>
            `;
        }

        function displayRetirementRecommendations(data) {
            const container = document.getElementById('retirementRecommendations');
            
            let recommendations = [];
            
            if (data.pensionReplacementRate < 70) {
                recommendations.push('מומלץ להגדיל את ההפקדות החודשיות');
            }
            
            if (data.yearsToRetirement < 10) {
                recommendations.push('יש להתחיל לתכנן את הפרישה בקרוב');
            }
            
            if (data.currentBalance < 500000) {
                recommendations.push('מומלץ לבדוק אפשרויות השקעה נוספות');
            }
            
            if (recommendations.length === 0) {
                recommendations.push('התיק שלך מאוזן היטב לפרישה');
            }
            
            container.innerHTML = `
                <div class="recommendations">
                    ${recommendations.map(rec => `<p>• ${rec}</p>`).join('')}
                </div>
            `;
        }

        function generateSummary() {
            const summaryData = calculateOverallSummary();
            displayOverallScore(summaryData);
            displayMainRecommendations(summaryData);
        }

        function calculateReturnsAnalysis() {
            // Mock data for demonstration - replace with real calculations
            return {
                productReturns: {
                    'קרן פנסיה': 6.2,
                    'קופת גמל': 5.8,
                    'קרן השתלמות': 4.5
                },
                marketAverage: 5.5,
                benchmark: 5.8
            };
        }

        function calculateFeesAnalysis() {
            return {
                annualFees: {
                    'קרן פנסיה': 1.2,
                    'קופת גמל': 0.8,
                    'קרן השתלמות': 0.6
                },
                impactOnReturns: {
                    'קרן פנסיה': -0.8,
                    'קופת גמל': -0.5,
                    'קרן השתלמות': -0.3
                }
            };
        }

        function calculateLiquidityAnalysis() {
            return {
                liquid: 35,
                semiLiquid: 45,
                illiquid: 20,
                availability: {
                    'מיידי': 15,
                    '30 יום': 20,
                    '90 יום': 30,
                    'שנה+': 35
                }
            };
        }

        function calculatePathwaysAnalysis() {
            return {
                pathways: {
                    'שמרני': 25,
                    'מאוזן': 45,
                    'אגרסיבי': 30
                },
                recommendations: [
                    'הגדלת החלק האגרסיבי ל-40%',
                    'הפחתת דמי ניהול',
                    'פיזור טוב יותר בין המוצרים'
                ]
            };
        }

        function calculateOverallSummary() {
            return {
                score: 78,
                recommendations: [
                    'התיק שלך מאוזן היטב',
                    'יש מקום לשיפור בתשואות',
                    'דמי הניהול סבירים',
                    'מומלץ לבדוק מסלולים נוספים'
                ]
            };
        }

        function displayReturnsChart(data) {
            const container = document.getElementById('returnsChart');
            container.innerHTML = '<canvas id="returnsChartCanvas"></canvas>';
            
            const ctx = document.getElementById('returnsChartCanvas').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(data.productReturns),
                    datasets: [{
                        label: 'תשואה שנתית (%)',
                        data: Object.values(data.productReturns),
                        backgroundColor: chartColors.slice(0, Object.keys(data.productReturns).length)
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function displayMarketComparison(data) {
            const container = document.getElementById('marketComparison');
            let tableHTML = '<table class="data-table"><tr><th>מוצר</th><th>תשואה שלך</th><th>ממוצע שוק</th><th>הפרש</th></tr>';
            
            Object.entries(data.productReturns).forEach(([product, returnValue]) => {
                const isHigher = returnValue > data.marketAverage;
                const difference = (returnValue - data.marketAverage).toFixed(1);
                const color = isHigher ? 'green' : 'red';
                const sign = isHigher ? '+' : '';
                
                tableHTML += `<tr>
                    <td>${product}</td>
                    <td>${returnValue}%</td>
                    <td>${data.marketAverage}%</td>
                    <td style="color: ${color}">${sign}${difference}%</td>
                </tr>`;
            });
            
            tableHTML += '</table>';
            container.innerHTML = tableHTML;
        }

        function displayFeesChart(data) {
            const container = document.getElementById('feesChart');
            container.innerHTML = '<canvas id="feesChartCanvas"></canvas>';
            
            const ctx = document.getElementById('feesChartCanvas').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(data.annualFees),
                    datasets: [{
                        data: Object.values(data.annualFees),
                        backgroundColor: chartColors.slice(0, Object.keys(data.annualFees).length)
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        function displayFeesImpact(data) {
            const container = document.getElementById('feesImpact');
            let html = '<div class="recommendations"><h5>השפעת דמי ניהול על התשואה:</h5>';
            
            Object.entries(data.impactOnReturns).forEach(([product, impact]) => {
                html += `<p><strong>${product}:</strong> ${impact}% פחות תשואה שנתית</p>`;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        function displayLiquidityChart(data) {
            const container = document.getElementById('liquidityChart');
            container.innerHTML = '<canvas id="liquidityChartCanvas"></canvas>';
            
            const ctx = document.getElementById('liquidityChartCanvas').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['נזיל', 'חצי נזיל', 'לא נזיל'],
                    datasets: [{
                        data: [data.liquid, data.semiLiquid, data.illiquid],
                        backgroundColor: ['#28a745', '#ffc107', '#dc3545']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        function displayAvailabilityTable(data) {
            const container = document.getElementById('availabilityTable');
            let tableHTML = '<table class="data-table"><tr><th>זמינות</th><th>אחוז</th><th>סכום משוער</th></tr>';
            
            Object.entries(data.availability).forEach(([period, percentage]) => {
                const amount = (dataMislaka.summary.totalBalance * percentage / 100).toLocaleString();
                tableHTML += `<tr>
                    <td>${period}</td>
                    <td>${percentage}%</td>
                    <td>₪ ${amount}</td>
                </tr>`;
            });
            
            tableHTML += '</table>';
            container.innerHTML = tableHTML;
        }

        function displayPathwaysChart(data) {
            const container = document.getElementById('pathwaysChart');
            container.innerHTML = '<canvas id="pathwaysChartCanvas"></canvas>';
            
            const ctx = document.getElementById('pathwaysChartCanvas').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(data.pathways),
                    datasets: [{
                        label: 'אחוז מהתיק',
                        data: Object.values(data.pathways),
                        backgroundColor: ['#28a745', '#ffc107', '#dc3545']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function displayOptimizationRecommendations(data) {
            const container = document.getElementById('optimizationRecommendations');
            let html = '<div class="recommendations"><h5>המלצות אופטימיזציה:</h5>';
            
            data.recommendations.forEach(rec => {
                html += `<p>• ${rec}</p>`;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        function displayOverallScore(data) {
            const container = document.getElementById('overallScore');
            container.innerHTML = `
                <div class="score-display">${data.score}</div>
                <p>ציון כללי מתוך 100</p>
            `;
        }

        function displayMainRecommendations(data) {
            const container = document.getElementById('mainRecommendations');
            let html = '<div class="recommendations-list">';
            
            data.recommendations.forEach(rec => {
                html += `<p>• ${rec}</p>`;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        function switchTab(tabName) {
            // Remove active class from all tabs and panels
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(panel => panel.classList.remove('active'));
            
            // Add active class to selected tab and panel
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        function exportAnalysisData() {
            if (!dataMislaka) {
                alert('אין נתונים לייצוא');
                return;
            }
            
            const exportData = {
                ...dataMislaka,
                analysis: {
                    returns: calculateReturnsAnalysis(),
                    fees: calculateFeesAnalysis(),
                    liquidity: calculateLiquidityAnalysis(),
                    pathways: calculatePathwaysAnalysis(),
                    summary: calculateOverallSummary()
                },
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `pension_analysis_${dataMislaka.idNumber}_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function generatePDFReport() {
            alert('פונקציית יצירת דוח PDF תהיה זמינה בקרוב');
        }
        
        // Global functions to access dataMislaka
        window.getDataMislaka = function() {
            return dataMislaka;
        };
        
        window.hasDataMislaka = function() {
            return dataMislaka !== null;
        };
        
        window.clearDataMislaka = function() {
            dataMislaka = null;
        };

        // פונקציות לטופס ייעוץ פנסיוני
        function openConsultationForm() {
            const modal = document.getElementById('consultationFormModal');
            modal.classList.add('show');
            document.body.style.overflow = 'hidden'; // מונע גלילה ברקע
        }

        function closeConsultationForm() {
            const modal = document.getElementById('consultationFormModal');
            modal.classList.remove('show');
            document.body.style.overflow = 'auto'; // מחזיר גלילה
            // ניקוי הטופס
            document.getElementById('consultationForm').reset();
        }
        
        // פונקציות להצגת והסתרת Modal ההשוואה
        function showComparisonModal() {
            const modal = document.getElementById('comparisonModal');
            modal.classList.add('show');
            document.body.style.overflow = 'hidden'; // מונע גלילה ברקע
            
            // טעינת נתוני המסלולים המובילים
            loadTopPerformers();
        }
        
        function loadTopPerformers() {
            // המתנה לטעינת הנתונים
            if (typeof datanetunimKlaliXM === 'undefined' || !datanetunimKlaliXM) {
                setTimeout(loadTopPerformers, 500);
                return;
            }
            
            // סינון רק קופות גמל להשקעה
            const gemelData = datanetunimKlaliXM.filter(item => 
                item.mozar === 'קופת גמל להשקעה' &&
                item.tesuam !== undefined &&
                item.tesuam !== null &&
                !isNaN(item.tesuam)
            );
            
            // מיון לפי תשואה שנתית (tesuam) - מהגבוה לנמוך
            gemelData.sort((a, b) => b.tesuam - a.tesuam);
            
            // לקיחת 5 הראשונים
            const top5 = gemelData.slice(0, 5);
            
            // יצירת HTML לטבלה
            let tableHTML = `
                <table class="performers-table" dir="rtl">
                    <thead>
                        <tr>
                            <th>דירוג</th>
                            <th class="mh-column">מ"ה</th>
                            <th>שם המסלול</th>
                            <th>חברה מנהלת</th>
                            <th>תשואה חודשית</th>
                            <th>תשואה שנתית</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            top5.forEach((item, index) => {
                const rank = index + 1;
                const returnPercentage = item.tesuam.toFixed(2);
                const monthlyReturn = (item.tusaAharona !== undefined && item.tusaAharona !== null && !isNaN(parseFloat(item.tusaAharona))) ? Number(item.tusaAharona).toFixed(2) : '—';
                
                tableHTML += `
                    <tr>
                        <td class="rank-cell">${rank}</td>
                        <td class="mh-column">${item.mh}</td>
                        <td class="name-cell">${item.shemkupa}</td>
                        <td class="company-cell">${item.menahelet}</td>
                        <td class="return-cell">${monthlyReturn}${monthlyReturn !== '—' ? '%' : ''}</td>
                        <td class="return-cell">${returnPercentage}%</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
                <p style="text-align: center; margin-top: 1rem; color: #666; font-size: 0.9rem;">
                    * נתונים מבוססים על תשואה ל-12 חודשים אחרונים
                </p>
            `;
            
            // הצגת הטבלה
            document.getElementById('topPerformersContainer').innerHTML = tableHTML;
        }
        
        function openComparisonModal() {
            const modal = document.getElementById('comparisonModal');
            modal.classList.add('show');
            document.body.style.overflow = 'hidden'; // מונע גלילה ברקע
            
            // טעינת 5 המסלולים המובילים
            loadTopPerformers();
        }
        
        function closeComparisonModal() {
            const modal = document.getElementById('comparisonModal');
            modal.classList.remove('show');
            document.body.style.overflow = 'auto'; // מחזיר גלילה
        }
        
        // סגירת ה-modal בלחיצה על הרקע
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('comparisonModal');
            if (e.target === modal) {
                closeComparisonModal();
            }
        });

        // טיפול בשליחת הטופס
        document.addEventListener('DOMContentLoaded', function() {
            const consultationForm = document.getElementById('consultationForm');
            if (consultationForm) {
                consultationForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const fullName = document.getElementById('fullName').value;
                    const phoneNumber = document.getElementById('phoneNumber').value;
                    const email = document.getElementById('email').value;
                    const message = document.getElementById('message').value;
                    
                    // כאן תוכל להוסיף לוגיקה לשליחת הנתונים לשרת
                    
                    // הודעת הצלחה
                    alert('תודה! פרטיך נשלחו בהצלחה. נחזור אליך תוך 24 שעות.');
                    
                    // סגירת הטופס
                    closeConsultationForm();
                });
            }
            
            // סגירת הטופס בלחיצה על הרקע
            const modal = document.getElementById('consultationFormModal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeConsultationForm();
                    }
                });
            }
        });
       
        // פונקציה להצגת הנתונים על המסך
        function displayDataOnScreen(pratimIshim, sumSugMutzar, pathwaySummary, statusData, pitzuimData) {
            // הצגת הפרטים האישיים
            const personalInfoDiv = document.getElementById('personalInfo');
          /*  personalInfoDiv.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>👤 שם פרטי:</strong> ${pratimIshim.shemPrati || 'לא זמין'}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>👥 שם משפחה:</strong> ${pratimIshim.shemMishpacha || 'לא זמין'}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>🆔 מספר זיהוי:</strong> ${pratimIshim.misparZihuyLakoach || 'לא זמין'}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>🎂 גיל:</strong> ${pratimIshim.gil || 'לא זמין'}
                </div>

                <div style="margin-bottom: 15px;">
                    <strong>📱 מספר סלולרי:</strong> ${pratimIshim.misparCellulari || 'לא זמין'}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>📧 כתובת דו"אל:</strong> ${pratimIshim.eMail || 'לא זמין'}
                </div>
            `;*/
            personalInfoDiv.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>👤 שם פרטי:</strong> ${"ישראל"}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>👥 שם משפחה:</strong> ${"ישראלי"}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>🆔 מספר זיהוי:</strong> ${'1234567890'}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>🎂 גיל:</strong> ${"57"}
                </div>

                <div style="margin-bottom: 15px;">
                    <strong>📱 מספר סלולרי:</strong> ${'052-1234567'}
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>📧 כתובת דו"אל:</strong> ${'israeli@gmail.com'}
                </div>`
            // הוספת אלמנט שיווקי לקבלת ייעוץ פנסיוני
            personalInfoDiv.innerHTML += `
                <div style="margin-top: 35px; padding: 20px; background: linear-gradient(135deg, #0183AA, #764ba2); border-radius: 15px; text-align: center;
                 color: white; box-shadow: 0 8px 25px #0183AA;">
                    <div style="font-size: 2.5rem; margin-bottom: 15px;">💼</div>
                    <h4 style="font-size: 1.3rem; margin-bottom: 10px; font-weight: bold;">רוצה ייעוץ פנסיוני מקצועי?</h4>
                    <p style="font-size: 1rem; margin-bottom: 20px; opacity: 0.9; line-height: 1.5;">
                        קבל ייעוץ אישי מותאם לפרופיל הפיננסי שלך<br>
                        ובדוק אם אתה מנצל את כל הזכויות שלך
                    </p>
                    <button id="consultationFormBtn" onclick="openConsultationForm()">
                        📞 קבל ייעוץ פנסיוני
                    </button>
                </div>
            `;

            // יצירת גרף עוגה תלת מימד
            createPieChart(sumSugMutzar);

            // יצירת טבלה מפורטת
            createDetailedTable(sumSugMutzar);

            // יצירת טבלת סיכום לפי מסלול ומוצר
            createPathwaySummaryTable(pathwaySummary);

            // יצירת טבלת פיצויים
            createPitzuimTable(pitzuimData);

            // יצירת טבלת סטטוס שעבוד, עיקול, הלוואה ותביעה
             createStatusTable(statusData);
            

            

            // הצגת התצוגה
            document.getElementById('dataDisplayContainer').style.display = 'block';
            
            // הפעלת כפתור ניתוח מתקדם לאחר טעינת הנתונים
            const advBtns = document.querySelectorAll('#advancedAnalysisBtnMain2, #advancedAnalysisBtn');
            advBtns.forEach(btn => {
                if (btn) {
                    btn.disabled = false;
                    btn.style.opacity = '1';
                    btn.style.cursor = 'pointer';
                }
            });
        }

        // פונקציה ליצירת גרף עוגה תלת מימד
        function createPieChart(sumSugMutzar) {
            const ctx = document.getElementById('pieChart').getContext('2d');
            
            // הכנת נתונים לגרף
            const chartData = [];
            const chartLabels = [];
            const colors = [
                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
                '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#FF6384'
            ];

            const shemTochnit = {
                '1': 'פוליסת ביטוח חיים משולב חיסכון',
                '2': 'קרן פנסיה',
                '2_1': 'קרן פנסיה ותיקה',
                '2_2': 'קרן פנסיה חדשה',
                '3': 'קופת גמל',
                '4': 'קרן השתלמות',
                '5': 'פוליסת חיסכון טהור',
                '6': 'פוליסת סיכון טהור',
                '7': 'ביטוח חיים משכנתא',
                '8': 'פוליסת סיכון טהור קולקטיב',
                '9': 'קופת גמל להשקעה',
                '10': 'חיסכון לכל ילד'
            };

            let colorIndex = 0;
            for (let key in sumSugMutzar) {
                // בדיקה אם זה מערך או ערך יחיד
                let value = 0;
                if (Array.isArray(sumSugMutzar[key])) {
                    value = sumSugMutzar[key][0] || 0;
                } else {
                    value = sumSugMutzar[key] || 0;
                }
                
                // המרה מפורמט מחרוזת למספר אם נדרש
                if (typeof value === 'string') {
                    // הסרת תווים לא מספריים
                    const numericValue = parseFloat(value.replace(/[^\d.-]/g, ''));
                    value = isNaN(numericValue) ? 0 : numericValue;
                }
                
               
                
                if (value > 0) {
                    chartLabels.push(shemTochnit[key] || 'לא ידוע');
                    chartData.push(value);
                    colorIndex++;
                }
            }

            

            // בדיקה אם יש נתונים להצגה
            if (chartData.length === 0) {
                ctx.fillStyle = '#666';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('אין נתונים להצגה', ctx.canvas.width / 2, ctx.canvas.height / 2);
                return;
            }

            // יצירת הגרף
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: colors.slice(0, chartData.length),
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false // נסתיר את המקרא הרגיל
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${context.label}: ₪${value.toLocaleString('he-IL', {maximumFractionDigits: 0})} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true,
                        duration: 2000
                    }
                }
            });

            // יצירת מקרא מותאם אישית
            createCustomLegend(chartLabels, chartData, colors);
        }

        // פונקציה ליצירת מקרא מותאם אישית
        function createCustomLegend(labels, data, colors) {
            const total = data.reduce((a, b) => a + b, 0);
            const chartContainer = document.getElementById('pieChart').parentElement;
            
            // הוספת הסכום הכולל מתחת למקרא
            const chartCanvas = document.getElementById('pieChart');
            const totalDiv = document.createElement('div');
            
            if(window.innerWidth > 768){
                totalDiv.style.cssText = `
                    position: relative;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 15px;
                    margin-top: 20px;
                    text-align: center;
                    padding: 15px 20px;
                    background: linear-gradient(135deg, #f5f7fa 0%, #e8eef5 100%);
                    border-radius: 12px;
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
                `;
                totalDiv.innerHTML = `
                    <span style="font-size: 1.1rem; color: #0183AA; font-weight: bold;">סכום כולל:</span>
                    <span style="font-size: 1.5rem; color: #0183AA; font-weight: bold;">₪${total.toLocaleString('he-IL', {maximumFractionDigits: 0})}</span>
                `;
            }else{
                totalDiv.style.cssText = `
                    position: relative;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 10px;
                    margin-top: 15px;
                    margin-bottom: 10px;
                    text-align: center;
                    padding: 10px;
                    background: linear-gradient(135deg, #f5f7fa 0%, #e8eef5 100%);
                    border-radius: 10px;
                `;
                totalDiv.innerHTML = `
                <span style="font-size: 14px; color: #0183AA; font-weight: bold;">סכום כולל:</span>
                <span style="font-size: 16px; color: #0183AA; font-weight: bold;">₪${total.toLocaleString('he-IL')}</span>
            `;
            }

            // יצירת אלמנט למקרא
            const legendDiv = document.createElement('div');
            legendDiv.style.cssText = `
                margin-top: 20px;
                text-align: right;
                direction: rtl;
            `;

            // יצירת פריטי המקרא
            labels.forEach((label, index) => {
                const percentage = ((data[index] / total) * 100).toFixed(1);
                const legendItem = document.createElement('div');
                legendItem.style.cssText = `
                    display: flex;
                    align-items: center;
                    justify-content: flex-end;
                    margin-bottom: 8px;
                    padding: 5px 0;
                `;

                const colorBox = document.createElement('div');
                colorBox.style.cssText = `
                    width: 20px;
                    height: 20px;
                    background-color: ${colors[index]};
                    border-radius: 3px;
                    margin-left: 10px;
                    border: 2px solid #fff;
                    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
                `;

                const labelText = document.createElement('span');
                labelText.style.cssText = `
                    font-size: 0.9rem;
                    color: #333;
                    font-weight: 500;
                `;
                labelText.textContent = `${label} (${percentage}%)`;

                legendItem.appendChild(labelText);
                legendItem.appendChild(colorBox);
                legendDiv.appendChild(legendItem);
            });

            chartContainer.appendChild(legendDiv);
            
            // הוספת הסכום הכולל מתחת למקרא
            chartContainer.appendChild(totalDiv);
        }

        // פונקציה ליצירת טבלה מפורטת
        function createDetailedTable(sumSugMutzar) {
            const tableDiv = document.getElementById('detailedSummary');
            
            const shemTochnit = {
                '1': 'פוליסת ביטוח חיים משולב חיסכון',
                '2': 'קרן פנסיה',
                '2_1': 'קרן פנסיה ותיקה',
                '2_2': 'קרן פנסיה חדשה',
                '3': 'קופת גמל',
                '4': 'קרן השתלמות',
                '5': 'פוליסת חיסכון טהור',
                '6': 'פוליסת סיכון טהור',
                '7': 'ביטוח חיים משכנתא',
                '8': 'פוליסת סיכון טהור קולקטיב',
                '9': 'קופת גמל להשקעה',
                '10': 'חיסכון לכל ילד'
            };

            const isMobile = window.innerWidth <= 768;
            let tableHTML = '';

            if (isMobile) {
                // תצוגת כרטיסיות למובייל
                tableHTML = '<div class="cards-container-mobile">';
                
                for (let key in sumSugMutzar) {
                    if (sumSugMutzar[key][0] > 0) {
                        const originalTotalValue = sumSugMutzar[key][0];
                        
                        for (let i = 0; i < sumSugMutzar[key].length; i++) {
                            if (sumSugMutzar[key][i] === 0) {
                                if(i===1){
                                    let years;
                                    const birthYear = parseInt(taarichLeyda.slice(0,4));
                                    const retirementAge = 67;
                                    const currentYear = new Date().getFullYear();
                                    years = retirementAge - (currentYear - birthYear);
                                    
                                    const calculatedValue = Math.pow(1.04, years) * originalTotalValue;
                                    
                                    sumSugMutzar[key][i] = calculatedValue.toLocaleString('he-IL', {maximumFractionDigits: 0})+" "+'₪'
                                }
                                else {
                                    sumSugMutzar[key][i]='לא רלבנטי'
                                }
                            }
                            else{
                                sumSugMutzar[key][i]=sumSugMutzar[key][i].toLocaleString('he-IL', {maximumFractionDigits: 0})+" "+'₪'
                            }
                        }
                        
                        tableHTML += `
                            <div class="product-card-mobile">
                                <h4 style="color: #0183AA; margin-bottom: 15px; font-size: 1.1rem; font-weight: bold; text-align: center; border-bottom: 2px solid #0183AA; padding-bottom: 8px;">
                                    ${shemTochnit[key]}
                                </h4>
                                <div class="card-row">
                                    <span class="card-label">סכום כולל:</span>
                                    <span class="card-value" style="color: #2c3e50;">${sumSugMutzar[key][0]}</span>
                                </div>
                                <div class="card-row">
                                    <span style="font-weight: bold;" class="card-label yitrotgilprish">יתרות לגיל פרישה:</span>
                                </div>

                        `;
                        
                        if (sumSugMutzar[key][1] !== 'לא רלבנטי') {
                            tableHTML += `
                                <div class="card-row">
                                    <span class="card-label">צבירה ללא פרמיות:</span>
                                    <span class="card-value" style="color: #27ae60;">${sumSugMutzar[key][1]}</span>
                                </div>
                            `;
                        }
                        
                        if (sumSugMutzar[key][2] !== 'לא רלבנטי') {
                            tableHTML += `
                                <div class="card-row">
                                    <span class="card-label">צבירה עם פרמיות:</span>
                                    <span class="card-value" style="color: #3498db;">${sumSugMutzar[key][2]}</span>
                                </div>
                            `;
                        }
                        
                        if (sumSugMutzar[key][3] !== 'לא רלבנטי') {
                            tableHTML += `
                                <div class="card-row">
                                    <span class="card-label">קצבה ללא פרמיות:</span>
                                    <span class="card-value" style="color: #e74c3c;">${sumSugMutzar[key][3]}</span>
                                </div>
                            `;
                        }
                        
                        if (sumSugMutzar[key][4] !== 'לא רלבנטי') {
                            tableHTML += `
                                <div class="card-row">
                                    <span class="card-label">קצבה עם פרמיות:</span>
                                    <span class="card-value" style="color: #f39c12;">${sumSugMutzar[key][4]}</span>
                                </div>
                            `;
                        }
                        
                        tableHTML += '</div>';
                    }
                }
                
                tableHTML += '</div>';
                tableHTML += `
                    <div style="margin-top: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px; border-right: 4px solid #0183AA;">
                        <p style="color: #555; font-size: 0.85rem; margin: 0; text-align: right; line-height: 1.5;">
                            <strong>הערה:</strong> בקופות גמל, קרנות השתלמות וקרן ותיקה החישוב מבוצע לפי 4% שנתי עד גיל 67
                        </p>
                    </div>
                `;
            } else {
                // תצוגת טבלה למסכים גדולים
                tableHTML = `
                    <table id="detailedTable" dir="rtl" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                        <thead>
                            <tr style="background: linear-gradient(45deg, #0183AA, #764ba2); color: white;">
                                 <th style="padding: 10px; text-align: right; border: 1px solid #ddd; border-bottom: none; white-space: nowrap;"></th>
                                 <th style="padding: 10px; text-align: right; border: 1px solid #ddd; border-bottom: none; white-space: nowrap;"></th>
                                <th colspan="4" style="padding: 10px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">יתרות לגיל פרישה</th>
                            </tr>
                            <tr style="background: linear-gradient(45deg, #0183AA, #764ba2); color: white;">
                                <th style="padding: 10px; text-align: center; border: 1px solid #ddd;border-top: none; white-space: nowrap;">סוג מוצר</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #ddd;border-top: none; white-space: nowrap;">סכום כולל</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">צבירה ללא פרמיות</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">צבירה עם פרמיות</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">קצבה ללא פרמיות</th>
                                <th style="padding: 10px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">קצבה עם פרמיות</th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                for (let key in sumSugMutzar) {
                    if (sumSugMutzar[key][0] > 0) {
                        const originalTotalValue = sumSugMutzar[key][0];
                        
                        for (let i = 0; i < sumSugMutzar[key].length; i++) {
                            if (sumSugMutzar[key][i] === 0) {
                                if(i===1){
                                    let years;
                                    const birthYear = parseInt(taarichLeyda.slice(0,4));
                                    const retirementAge = 67;
                                    const currentYear = new Date().getFullYear();
                                    years = retirementAge - (currentYear - birthYear);
                                    
                                    const calculatedValue = Math.pow(1.04, years) * originalTotalValue;
                                    
                                    sumSugMutzar[key][i] = calculatedValue.toLocaleString('he-IL', {maximumFractionDigits: 0})+" "+'₪'
                                }
                                else {
                                    sumSugMutzar[key][i]='לא רלבנטי'
                                }
                            }
                            else{
                                sumSugMutzar[key][i]=sumSugMutzar[key][i].toLocaleString('he-IL', {maximumFractionDigits: 0})+" "+'₪'
                            }
                        }
                        tableHTML += `
                            <tr style="background: rgba(102, 126, 234, 0.1);">
                                <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold; white-space: nowrap;">${shemTochnit[key]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: right; color: #2c3e50; white-space: nowrap;">${sumSugMutzar[key][0]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: right; color: #27ae60; white-space: nowrap;">${sumSugMutzar[key][1]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: right; color: #3498db; white-space: nowrap;">${sumSugMutzar[key][2]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: right; color: #e74c3c; white-space: nowrap;">${sumSugMutzar[key][3]}</td>
                                <td style="padding: 12px; border: 1px solid #ddd; text-align: right; color: #f39c12; white-space: nowrap;">${sumSugMutzar[key][4]}</td>
                            </tr>
                        `;
                    }
                }

                tableHTML += `
                        </tbody>
                    </table>
                    <div style="margin-top: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px; border-right: 4px solid #0183AA;">
                        <p id="detailedTableNote" style="color: #555; font-size: 0.9rem; margin: 0; text-align: right; line-height: 1.5;">
                            <strong>הערה:</strong> בקופות גמל, קרנות השתלמות וקרן ותיקה החישוב מבוצע לפי 4% שנתי עד גיל 67
                        </p>
                    </div>
                `;
            }

            tableDiv.innerHTML = tableHTML;
            
            // חישוב סכומים לניתוח מתקדם
            setTimeout(() => {
                let sumHon = 0;
                let sumKitzva = 0;
                
                // מוצרים הוניים - מילות מפתח
                const equityKeywords = ['השתלמות', 'חיסכון טהור', 'גמל להשקעה', 'חיסכון לכל ילד'];
                // מוצרי קצבה - מילות מפתח
                const pensionKeywords = ['ביטוח חיים', 'פנסיה', 'קופת גמל'];
                
                // בדיקה אם זה מובייל (כרטיסיות) או דסקטופ (טבלה)
                const isMobile = window.innerWidth <= 768;
                
                if (isMobile) {
                    // קריאה מכרטיסיות במובייל
                    const cards = tableDiv.querySelectorAll('.product-card-mobile');
                    
                    cards.forEach((card, index) => {
                        const productName = card.querySelector('h4').textContent.trim();
                        const amountElement = card.querySelector('.card-row .card-value');
                        if (!amountElement) return;
                        
                        const amountText = amountElement.textContent.trim();
                        const amount = parseFloat(amountText.replace(/[₪,\s]/g, '')) || 0;
                        
                        // סיווג לפי מילות מפתח
                        const isEquity = equityKeywords.some(keyword => productName.includes(keyword));
                        const isPension = pensionKeywords.some(keyword => productName.includes(keyword));
                        
                        if (isEquity) {
                            sumHon += amount;
                        } else if (isPension) {
                            sumKitzva += amount;
                        }
                    });
                } else {
                    // קריאה מטבלה בדסקטופ
                    const table = tableDiv.querySelector('table tbody');
                    if (!table) {
                        console.warn('⚠️ לא נמצאה טבלה');
                        return;
                    }
                    
                    const rows = table.querySelectorAll('tr');
                    
                    for (let i = 0; i < rows.length; i++) {
                        const cells = rows[i].children;
                        if (cells.length < 2) continue;
                        
                        const productName = cells[0].textContent.trim();
                        const amountText = cells[1].textContent.trim();
                        
                        // דלג על כותרת
                        if (!productName || productName === 'סוג מוצר' || !amountText) {
                            continue;
                        }
                        
                        const amount = parseFloat(amountText.replace(/[₪,\s]/g, '')) || 0;
                        
                        // סיווג לפי מילות מפתח
                        const isEquity = equityKeywords.some(keyword => productName.includes(keyword));
                        const isPension = pensionKeywords.some(keyword => productName.includes(keyword));
                        
                        if (isEquity) {
                            sumHon += amount;
                        } else if (isPension) {
                            sumKitzva += amount;
                        }
                    }
                }
                
              
                // שמירת סכומים בסיסיים
                sessionStorage.setItem('sumHonForAdvancedAnalysis', sumHon);
                sessionStorage.setItem('sumKitzvaForAdvancedAnalysis', sumKitzva);
                
                // שמירת נתונים מפורטים לניתוח מתקדם
                const advancedAnalysisData = {
                    sumSugMutzar: sumSugMutzar,          // פירוט לפי מוצר
                    pirteiHeshbon: pirteiHeshbon || [],   // פרטי חשבונות
                    masluleiHashkaa: masluleiHashkaa || [], // מסלולי השקעה
                    yitrotLefiMutzar: yitrotLefiMutzar || {}, // יתרות לפי מוצר
                    pratimIshim: pratimIshim || {}        // פרטים אישיים
                };
                
                sessionStorage.setItem('advancedAnalysisData', JSON.stringify(advancedAnalysisData));
            }, 100);
        }

        // פונקציה ליצירת טבלת סיכום לפי מסלול ומוצר
        function createPathwaySummaryTable(pathwaySummary) {
            if (!pathwaySummary || pathwaySummary.length === 0) {
                return;
            }

            // עיבוד נתונים - מזיגה לפי סוג מוצר + סוג מסלול
            const processedData = [];
            const processedKeys = new Set();
            
            pathwaySummary.forEach(item => {
                // זיהוי סוג המסלול
                let maslulType = 'כללי'; // ברירת מחדל
                if (item.shemMaslulHashkaa && typeof getMaslulType === 'function') {
                    const detectedType = getMaslulType(item.shemMaslulHashkaa);
                    if (detectedType && detectedType !== 'לא ידוע') {
                        maslulType = detectedType;
                    }
                }
                
                // מפתח למזיגה: סוג מוצר + סוג מסלול
                const mergeKey = `${item.sugMutzar}_${maslulType}`;
                
                if (processedKeys.has(mergeKey)) {
                    // מזיגה עם רשומה קיימת
                    const existingIndex = processedData.findIndex(data => 
                        data.sugMutzar === item.sugMutzar && data.maslulType === maslulType
                    );
                    
                    if (existingIndex !== -1) {
                        // חיבור הסכומים
                        processedData[existingIndex].totalSchumTzvira += item.totalSchumTzvira;
                    }
                } else {
                    // רשומה חדשה
                    processedKeys.add(mergeKey);
                    processedData.push({
                        sugMutzar: item.sugMutzar,
                        maslulType: maslulType,
                        totalSchumTzvira: item.totalSchumTzvira
                    });
                }
            });

            if (processedData.length === 0) {
                return;
            }

            // יצירת אלמנט חדש לטבלה
            const pathwayTableDiv = document.createElement('div');
            pathwayTableDiv.className = 'data-card';
            pathwayTableDiv.style.marginTop = '30px';

            const isMobile = window.innerWidth <= 768;
            let tableHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: #333; margin-top: 20px; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px; text-align: right;">📊 סיכום לפי סוג מסלול ומוצר</h3>
                    <button style="max-width: 50px;" type="button" class="tbl-button" id="closePathwayTable" onclick="closePathwayTableDisplay()">סגור</button>
                </div>
                <div id="pathwayTableContent">
            `;

            // מיון הנתונים לפי סוג מוצר ואז לפי סכום צבירה
            processedData.sort((a, b) => {
                if (a.sugMutzar !== b.sugMutzar) {
                    return a.sugMutzar.localeCompare(b.sugMutzar);
                }
                return b.totalSchumTzvira - a.totalSchumTzvira;
            });

            let totalSum = 0;

            if (isMobile) {
                // תצוגת כרטיסיות למובייל
                tableHTML += '<div class="cards-container-mobile">';
                
                processedData.forEach(item => {
                    const formattedAmount = new Intl.NumberFormat('he-IL', {
                        style: 'currency',
                        currency: 'ILS',
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    }).format(item.totalSchumTzvira).replace('₪', '₪ ').trim();
                    
                    totalSum += item.totalSchumTzvira;

                    tableHTML += `
                        <div class="product-card-mobile">
                            <h4 style="color: #0183AA; margin-bottom: 12px; font-size: 1rem; font-weight: bold; text-align: center; border-bottom: 2px solid #0183AA; padding-bottom: 8px;">
                                ${item.sugMutzar}
                            </h4>
                            <div class="card-row">
                                <span class="card-label">סוג מסלול:</span>
                                <span class="card-value" style="color: #2c3e50;">${item.maslulType}</span>
                            </div>
                            <div class="card-row">
                                <span class="card-label">סכום צבירה:</span>
                                <span class="card-value" style="color: #27ae60;">${formattedAmount}</span>
                            </div>
                        </div>
                    `;
                });
                
                // הוספת כרטיס סך הכל
                const formattedTotalSum = new Intl.NumberFormat('he-IL', {
                    style: 'currency',
                    currency: 'ILS',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(totalSum).replace('₪', '₪ ').trim();
                
                tableHTML += `
                    <div class="product-card-mobile" style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); border: 2px solid #0183AA;">
                        <div class="card-row" style="border-bottom: none;">
                            <span class="card-label" style="font-size: 1.1rem; color: #0183AA;">סך הכל:</span>
                            <span class="card-value" style="font-size: 1.2rem; color: #0183AA;">${formattedTotalSum}</span>
                        </div>
                    </div>
                `;
                
                tableHTML += '</div>';
            } else {
                // תצוגת טבלה למסכים גדולים
                tableHTML += `
                    <table id="pathwayTable" dir="rtl" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                        <thead>
                            <tr style="background: linear-gradient(45deg, #0183AA, #764ba2); color: white;">
                                <th style="padding: 15px; text-align: right; border: 1px solid #ddd; white-space: nowrap;">סוג מוצר</th>
                                <th style="padding: 15px; text-align: right; border: 1px solid #ddd; white-space: nowrap;">סוג מסלול</th>
                                <th style="padding: 15px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">סכום צבירה</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                processedData.forEach(item => {
                    const formattedAmount = new Intl.NumberFormat('he-IL', {
                        style: 'currency',
                        currency: 'ILS',
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    }).format(item.totalSchumTzvira).replace('₪', '₪ ').trim();
                    
                    totalSum += item.totalSchumTzvira;

                    tableHTML += `
                        <tr style="background: rgba(102, 126, 234, 0.1);">
                            <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold; white-space: nowrap;">${item.sugMutzar}</td>
                            <td style="padding: 12px; border: 1px solid #ddd; white-space: nowrap;">${item.maslulType}</td>
                            <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: #2c3e50; white-space: nowrap;">${formattedAmount}</td>
                        </tr>
                    `;
                });
                
                // הוספת שורת סך הכל
                const formattedTotalSum = new Intl.NumberFormat('he-IL', {
                    style: 'currency',
                    currency: 'ILS',
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                }).format(totalSum).replace('₪', '₪ ').trim();
                
                tableHTML += `
                    <tr style="background: linear-gradient(45deg, #0183AA, #764ba2); color: white; font-weight: bold;">
                        <td style="padding: 15px; border: 1px solid #ddd; text-align: right; font-size: 1.1rem;" colspan="2">סך הכל</td>
                        <td style="padding: 15px; border: 1px solid #ddd; text-align: center; font-size: 1.1rem;">${formattedTotalSum}</td>
                    </tr>
                `;

                tableHTML += `
                        </tbody>
                    </table>
                `;
            }

            tableHTML += `
                </div>
                <div style="margin-top: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px; border-right: 4px solid #0183AA;">
                    <p style="color: #555; font-size: 0.9rem; margin: 0; text-align: right; line-height: 1.5;">
                        <strong>הערה:</strong> טבלה זו מציגה את הסכומים המצטברים לפי מסלול השקעה בכל מוצר פיננסי (לא כולל קרן ותיקה)
                    </p>
                </div>
            `;

            pathwayTableDiv.innerHTML = tableHTML;

            // הוספת הטבלה החדשה לקונטיינר הראשי
            const dataDisplayContainer = document.getElementById('dataDisplayContainer');
            dataDisplayContainer.appendChild(pathwayTableDiv);
        }
        function closeTableDisplay() {
            const table = document.getElementById('statusTable');
            const button = document.getElementById('closeTable');
            const note = document.getElementById('statusTableNote');
            if (table && button && note) {
                if (table.style.display === 'none') {
                    table.style.display = 'table';
                    button.textContent = 'סגור טבלה';
                    note.style.display = 'block';
                } else {
                    table.style.display = 'none';
                    button.textContent = 'פתח טבלה';
                    note.style.display = 'none';
                }
            }
        }
        
        function closeDetailedTableDisplay() {
            const detailedSummary = document.getElementById('detailedSummary');
            const button = document.getElementById('closeDetailedTable');
            
            if (detailedSummary && button) {
                if (detailedSummary.style.display === 'none') {
                    detailedSummary.style.display = 'block';
                    button.textContent = 'סגור';
                } else {
                    detailedSummary.style.display = 'none';
                    button.textContent = 'פתח';
                }
            }
        }
        
        function closePathwayTableDisplay() {
            const content = document.getElementById('pathwayTableContent');
            const button = document.getElementById('closePathwayTable');
            
            if (content && button) {
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    button.textContent = 'סגור';
                } else {
                    content.style.display = 'none';
                    button.textContent = 'פתח';
                }
            }
        }

        // פונקציה ליצירת טבלת פיצויים
        function createPitzuimTable(pitzuimData) {
            if (!pitzuimData || pitzuimData.length === 0) {
                return;
            }

            // סינון רק רשומות עם סכומים גדולים מ-0
            const filteredData = pitzuimData.filter(item => {
                const hasAnyValue = item.pitzuimPturimMaavidimKodmim > 0 ||
                       item.erechPidionPitzuimLeKitzbaMaavidimKodmim > 0 ||
                       item.tzviratPitzuimMaavidimKodmimBeretzefKitzba > 0 ||
                       item.tzviratPitzuimMaavidimKodmimBeretzefZechuyot > 0 ||
                       item.tzviratPitzuim31121999LeKitzba > 0 ||
                       item.erechPidionPitzuimMaasikNochechi > 0 ||
                       item.erechPidionMarkivPitzuimLemasNochechi > 0 ||
                       item.erechPidionPitzuimMaavidimKodmimRetzefZehuyut > 0 ||
                       item.erechPidionPitzuimLeHonMaavidimKodmim > 0 ||
                       item.yitratPitzuimLeLoHitchashbenot > 0;
                
                
                return hasAnyValue;
            });

            // עיבוד נתונים לקרן פנסיה - השלמת אפסים ומזיגה
            const processedData = [];
            const processedKeys = new Set();
            
            filteredData.forEach(item => {
                let accountNumber = item.misparPolisaOHeshbon;
                let productType = item.sugMutzar;
                
                // לקרן פנסיה - השלמת אפסים למספר החשבון
                if (productType === '2' || productType === '2_1' || productType === '2_2') {
                    // השלמת אפסים ל-9 ספרות
                    accountNumber = String(accountNumber).padStart(9, '0');
                }
                
                // מפתח למזיגה: סוג מוצר + מספר חשבון
                const mergeKey = `${productType}_${accountNumber}`;
                
                if (processedKeys.has(mergeKey)) {
                    // מזיגה עם רשומה קיימת
                    const existingIndex = processedData.findIndex(data => 
                        data.sugMutzar === productType && data.misparPolisaOHeshbon === accountNumber
                    );
                    
                    if (existingIndex !== -1) {
                        // חיבור הסכומים
                        const existing = processedData[existingIndex];
                        processedData[existingIndex] = {
                            ...existing,
                            pitzuimPturimMaavidimKodmim: existing.pitzuimPturimMaavidimKodmim + item.pitzuimPturimMaavidimKodmim,
                            erechPidionPitzuimLeKitzbaMaavidimKodmim: existing.erechPidionPitzuimLeKitzbaMaavidimKodmim + item.erechPidionPitzuimLeKitzbaMaavidimKodmim,
                            tzviratPitzuimMaavidimKodmimBeretzefKitzba: existing.tzviratPitzuimMaavidimKodmimBeretzefKitzba + item.tzviratPitzuimMaavidimKodmimBeretzefKitzba,
                            tzviratPitzuimMaavidimKodmimBeretzefZechuyot: existing.tzviratPitzuimMaavidimKodmimBeretzefZechuyot + item.tzviratPitzuimMaavidimKodmimBeretzefZechuyot,
                            tzviratPitzuim31121999LeKitzba: existing.tzviratPitzuim31121999LeKitzba + item.tzviratPitzuim31121999LeKitzba,
                            erechPidionPitzuimMaasikNochechi: existing.erechPidionPitzuimMaasikNochechi + item.erechPidionPitzuimMaasikNochechi,
                            erechPidionMarkivPitzuimLemasNochechi: existing.erechPidionMarkivPitzuimLemasNochechi + item.erechPidionMarkivPitzuimLemasNochechi,
                            erechPidionPitzuimMaavidimKodmimRetzefZehuyut: existing.erechPidionPitzuimMaavidimKodmimRetzefZehuyut + item.erechPidionPitzuimMaavidimKodmimRetzefZehuyut,
                            erechPidionPitzuimLeHonMaavidimKodmim: existing.erechPidionPitzuimLeHonMaavidimKodmim + item.erechPidionPitzuimLeHonMaavidimKodmim,
                            yitratPitzuimLeLoHitchashbenot: existing.yitratPitzuimLeLoHitchashbenot + item.yitratPitzuimLeLoHitchashbenot
                        };
                    }
                } else {
                    // רשומה חדשה
                    processedKeys.add(mergeKey);
                    processedData.push({
                        ...item,
                        sugMutzar: productType,
                        misparPolisaOHeshbon: accountNumber
                    });
                }
            });

            // סינון נוסף - הסרת שורות שבהן כל הסכומים הם 0
            const finalData = processedData.filter(item => {
                const hasValue = item.pitzuimPturimMaavidimKodmim > 0 ||
                       item.erechPidionPitzuimLeKitzbaMaavidimKodmim > 0 ||
                       item.tzviratPitzuimMaavidimKodmimBeretzefKitzba > 0 ||
                       item.tzviratPitzuimMaavidimKodmimBeretzefZechuyot > 0 ||
                       item.tzviratPitzuim31121999LeKitzba > 0 ||
                       item.erechPidionPitzuimMaasikNochechi > 0 ||
                       item.erechPidionMarkivPitzuimLemasNochechi > 0 ||
                       item.erechPidionPitzuimMaavidimKodmimRetzefZehuyut > 0 ||
                       item.erechPidionPitzuimLeHonMaavidimKodmim > 0 ||
                       item.yitratPitzuimLeLoHitchashbenot > 0;
                
                
                return hasValue;
            });

            if (finalData.length === 0) {
                return;
            }
            
            // בדיקה אילו עמודות יש בהן סכומים
            const hasData = {
                pitzuimPturimMaavidimKodmim: finalData.some(item => item.pitzuimPturimMaavidimKodmim > 0),
                erechPidionPitzuimLeKitzbaMaavidimKodmim: finalData.some(item => item.erechPidionPitzuimLeKitzbaMaavidimKodmim > 0),
                tzviratPitzuimMaavidimKodmimBeretzefKitzba: finalData.some(item => item.tzviratPitzuimMaavidimKodmimBeretzefKitzba > 0),
                tzviratPitzuimMaavidimKodmimBeretzefZechuyot: finalData.some(item => item.tzviratPitzuimMaavidimKodmimBeretzefZechuyot > 0),
                tzviratPitzuim31121999LeKitzba: finalData.some(item => item.tzviratPitzuim31121999LeKitzba > 0),
                erechPidionPitzuimMaasikNochechi: finalData.some(item => item.erechPidionPitzuimMaasikNochechi > 0),
                erechPidionMarkivPitzuimLemasNochechi: finalData.some(item => item.erechPidionMarkivPitzuimLemasNochechi > 0),
                erechPidionPitzuimMaavidimKodmimRetzefZehuyut: finalData.some(item => item.erechPidionPitzuimMaavidimKodmimRetzefZehuyut > 0),
                erechPidionPitzuimLeHonMaavidimKodmim: finalData.some(item => item.erechPidionPitzuimLeHonMaavidimKodmim > 0),
                yitratPitzuimLeLoHitchashbenot: finalData.some(item => item.yitratPitzuimLeLoHitchashbenot > 0),
                kayamRetzefPitzuimKitzba: finalData.some(item => item.kayamRetzefPitzuimKitzba <2),
                kayamRetzefPitzuimZechuyot: finalData.some(item => item.kayamRetzefPitzuimZechuyot <2)
            };
            
            const pitzuimTableDiv = document.createElement('div');
            pitzuimTableDiv.className = 'data-card';
            pitzuimTableDiv.style.marginTop = '30px';

            const shemTochnit = {
                '1': 'פוליסת ביטוח חיים משולב חיסכון',
                '2': 'קרן פנסיה',
                '2_1': 'קרן פנסיה ותיקה',
                '2_2': 'קרן פנסיה חדשה',
                '3': 'קופת גמל',
                '4': 'קרן השתלמות',
                '5': 'פוליסת חיסכון טהור',
                '6': 'פוליסת סיכון טהור',
                '7': 'ביטוח חיים משכנתא',
                '8': 'פוליסת סיכון טהור קולקטיב',
                '9': 'קופת גמל להשקעה',
                '10': 'חיסכון לכל ילד'
            };
            
            const fieldLabels = {
                pitzuimPturimMaavidimKodmim: 'צבירת מעבידים קודמים',
                erechPidionPitzuimLeKitzbaMaavidimKodmim: 'ערך פדיון לקצבה מעבידים קודמים',
                tzviratPitzuimMaavidimKodmimBeretzefKitzba: 'צבירת פיצויים מעבידים קודמים לקצבה',
                tzviratPitzuimMaavidimKodmimBeretzefZechuyot: 'צבירת פיצויים מעובדים קודמים לזכויות',
                tzviratPitzuim31121999LeKitzba: 'צבירת פיצויים 31.12.1999 לקצבה',
                erechPidionPitzuimMaasikNochechi: 'ערך פדיון מעביד נוכחי',
                erechPidionMarkivPitzuimLemasNochechi: 'ערך פדיון מרכיב פיצויים למעביד נוכחי',
                erechPidionPitzuimMaavidimKodmimRetzefZehuyut: 'ערך פדיון מעבידים קודמים רצף זכויות',
                erechPidionPitzuimLeHonMaavidimKodmim: 'ערך פדיון להון מעבידים קודמים',
                yitratPitzuimLeLoHitchashbenot: 'יתרת פיצויים ללא התחשבות',
                kayamRetzefPitzuimKitzba: 'רצף פיצויים קצבה',
                kayamRetzefPitzuimZechuyot: 'רצף זכויות פיצויים'
            };

            const isMobile = window.innerWidth <= 768;

            let tableHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: #333; margin: 0; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px; text-align: right;">💰 ערכי פדיון פיצויים</h3>
                    <button style="max-width: 50px;" type="button" class="tbl-button" id="closePitzuimTable" onclick="closePitzuimTableDisplay()">סגור</button>
                </div>
                <div id="pitzuimTableContent">
            `;

            finalData.sort((a, b) => {
                if (a.sugMutzar !== b.sugMutzar) {
                    return a.sugMutzar.localeCompare(b.sugMutzar);
                }
                return a.misparPolisaOHeshbon.localeCompare(b.misparPolisaOHeshbon);
            });

            if (isMobile) {
                // תצוגת כרטיסיות למובייל
                tableHTML += '<div class="cards-container-mobile">';
                
                finalData.forEach(item => {
                    const productName = shemTochnit[item.sugMutzar];
                    
                    tableHTML += `
                        <div class="product-card-mobile">
                            <h4 style="color: #0183AA; margin-bottom: 12px; font-size: 1rem; font-weight: bold; text-align: center; border-bottom: 2px solid #0183AA; padding-bottom: 8px;">
                                ${productName}
                            </h4>
                            <div class="card-row">
                                <span class="card-label">מספר חשבון/פוליסה:</span>
                                <span class="card-value" style="color: #2c3e50;">${item.misparPolisaOHeshbon}</span>
                            </div>
                    `;
                    
                    // הוספת שדות רק אם יש בהם ערכים
                    if (item.pitzuimPturimMaavidimKodmim > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.pitzuimPturimMaavidimKodmim}:</span>
                                <span class="card-value" style="color: #2c3e50;">₪${item.pitzuimPturimMaavidimKodmim.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.erechPidionPitzuimLeKitzbaMaavidimKodmim > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.erechPidionPitzuimLeKitzbaMaavidimKodmim}:</span>
                                <span class="card-value" style="color: #27ae60;">₪${item.erechPidionPitzuimLeKitzbaMaavidimKodmim.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.tzviratPitzuimMaavidimKodmimBeretzefKitzba > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.tzviratPitzuimMaavidimKodmimBeretzefKitzba}:</span>
                                <span class="card-value" style="color: #3498db;">₪${item.tzviratPitzuimMaavidimKodmimBeretzefKitzba.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.tzviratPitzuimMaavidimKodmimBeretzefZechuyot > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.tzviratPitzuimMaavidimKodmimBeretzefZechuyot}:</span>
                                <span class="card-value" style="color: #e74c3c;">₪${item.tzviratPitzuimMaavidimKodmimBeretzefZechuyot.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.tzviratPitzuim31121999LeKitzba > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.tzviratPitzuim31121999LeKitzba}:</span>
                                <span class="card-value" style="color: #f39c12;">₪${item.tzviratPitzuim31121999LeKitzba.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.erechPidionPitzuimMaasikNochechi > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.erechPidionPitzuimMaasikNochechi}:</span>
                                <span class="card-value" style="color: #9b59b6;">₪${item.erechPidionPitzuimMaasikNochechi.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.erechPidionMarkivPitzuimLemasNochechi > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.erechPidionMarkivPitzuimLemasNochechi}:</span>
                                <span class="card-value" style="color: #1abc9c;">₪${item.erechPidionMarkivPitzuimLemasNochechi.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.erechPidionPitzuimMaavidimKodmimRetzefZehuyut > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.erechPidionPitzuimMaavidimKodmimRetzefZehuyut}:</span>
                                <span class="card-value" style="color: #34495e;">₪${item.erechPidionPitzuimMaavidimKodmimRetzefZehuyut.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.erechPidionPitzuimLeHonMaavidimKodmim > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.erechPidionPitzuimLeHonMaavidimKodmim}:</span>
                                <span class="card-value" style="color: #e67e22;">₪${item.erechPidionPitzuimLeHonMaavidimKodmim.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.yitratPitzuimLeLoHitchashbenot > 0) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.yitratPitzuimLeLoHitchashbenot}:</span>
                                <span class="card-value" style="color: #95a5a6;">₪${item.yitratPitzuimLeLoHitchashbenot.toLocaleString('he-IL')}</span>
                            </div>
                        `;
                    }
                    
                    if (item.kayamRetzefPitzuimKitzba && item.kayamRetzefPitzuimKitzba < 2) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.kayamRetzefPitzuimKitzba}:</span>
                                <span class="card-value" style="color: #16a085;">${item.kayamRetzefPitzuimKitzba > 0 ? 'כן' : 'לא'}</span>
                            </div>
                        `;
                    }
                    
                    if (item.kayamRetzefPitzuimZechuyot && item.kayamRetzefPitzuimZechuyot < 2) {
                        tableHTML += `
                            <div class="card-row">
                                <span class="card-label">${fieldLabels.kayamRetzefPitzuimZechuyot}:</span>
                                <span class="card-value" style="color: #8e44ad;">${item.kayamRetzefPitzuimZechuyot > 0 ? 'כן' : 'לא'}</span>
                            </div>
                        `;
                    }
                    
                    tableHTML += '</div>';
                });
                
                tableHTML += '</div>';
            } else {
                // תצוגת טבלה למסכים גדולים
                tableHTML += `
                    <div style="overflow-x: auto; margin-top: 20px;">
                        <table id="pitzuimTable" dir="rtl" style="min-width: 1200px; border-collapse: collapse;">
                            <thead>
                                <tr style="background: linear-gradient(45deg, #0183AA, #764ba2); color: white;">
                                    <th style="padding: 5px; text-align: right; border: 1px solid #ddd; font-size: 0.8rem; min-width: 80px;">סוג מוצר</th>
                                    <th style="padding: 5px; text-align: right; border: 1px solid #ddd; font-size: 0.8rem; min-width: 100px;">מספר חשבון/פוליסה</th>
                                    ${hasData.pitzuimPturimMaavidimKodmim ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">צבירת מעבידים קודמים</th>' : ''}
                                    ${hasData.erechPidionPitzuimLeKitzbaMaavidimKodmim ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">ערך פדיון פיצויים לקצבה מעבידים קודמים</th>' : ''}
                                    ${hasData.tzviratPitzuimMaavidimKodmimBeretzefKitzba ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">צבירת פיצויים מעבידים קודמים לקצבה</th>' : ''}
                                    ${hasData.tzviratPitzuimMaavidimKodmimBeretzefZechuyot ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">צבירת פיצויים מעובדים קודמים לזכויות</th>' : ''}
                                    ${hasData.tzviratPitzuim31121999LeKitzba ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">צבירת פיצויים 31.12.1999 לקצבה</th>' : ''}
                                    ${hasData.erechPidionPitzuimMaasikNochechi ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">ערך פדיון פיצויים מעביד נוכחי</th>' : ''}
                                    ${hasData.erechPidionMarkivPitzuimLemasNochechi ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">ערך פדיון מרכיב פיצויים למעביד נוכחי</th>' : ''}
                                    ${hasData.erechPidionPitzuimMaavidimKodmimRetzefZehuyut ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">ערך פדיון פיצויים מעבידים קודמים רצף זכויות</th>' : ''}
                                    ${hasData.erechPidionPitzuimLeHonMaavidimKodmim ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">ערך פדיון פיצויים להון מעבידים קודמים</th>' : ''}
                                    ${hasData.yitratPitzuimLeLoHitchashbenot ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 120px; line-height: 1.2;">יתרת פיצויים ללא התחשבות</th>' : ''}
                                    ${hasData.kayamRetzefPitzuimKitzba ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 100px; line-height: 1.2;">קיים רצף פיצויים קצבה</th>' : ''}
                                    ${hasData.kayamRetzefPitzuimZechuyot ? '<th style="padding: 5px; text-align: center; border: 1px solid #ddd; font-size: 0.85rem; min-width: 100px; line-height: 1.2;">קיים רצף זכויות פיצויים</th>' : ''}
                                </tr>
                            </thead>
                        <tbody>
                `;
                
                finalData.forEach(item => {
                    const productName = shemTochnit[item.sugMutzar];
                    tableHTML += `
                        <tr style="background: rgba(102, 126, 234, 0.1);">
                            <td style="padding: 5px; border: 1px solid #ddd; font-weight: bold;  font-size: 0.8rem;">${productName}</td>
                            <td style="padding: 5px; border: 1px solid #ddd;  font-size: 0.8rem;">${item.misparPolisaOHeshbon}</td>
                            ${hasData.pitzuimPturimMaavidimKodmim ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #2c3e50; white-space: nowrap; font-size: 0.85rem;">${item.pitzuimPturimMaavidimKodmim > 0 ? '₪' + item.pitzuimPturimMaavidimKodmim.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.erechPidionPitzuimLeKitzbaMaavidimKodmim ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #27ae60; white-space: nowrap; font-size: 0.85rem;">${item.erechPidionPitzuimLeKitzbaMaavidimKodmim > 0 ? '₪' + item.erechPidionPitzuimLeKitzbaMaavidimKodmim.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.tzviratPitzuimMaavidimKodmimBeretzefKitzba ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #3498db; white-space: nowrap; font-size: 0.85rem;">${item.tzviratPitzuimMaavidimKodmimBeretzefKitzba > 0 ? '₪' + item.tzviratPitzuimMaavidimKodmimBeretzefKitzba.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.tzviratPitzuimMaavidimKodmimBeretzefZechuyot ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #e74c3c; white-space: nowrap; font-size: 0.85rem;">${item.tzviratPitzuimMaavidimKodmimBeretzefZechuyot > 0 ? '₪' + item.tzviratPitzuimMaavidimKodmimBeretzefZechuyot.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.tzviratPitzuim31121999LeKitzba ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #f39c12; white-space: nowrap; font-size: 0.85rem;">${item.tzviratPitzuim31121999LeKitzba > 0 ? '₪' + item.tzviratPitzuim31121999LeKitzba.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.erechPidionPitzuimMaasikNochechi ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #9b59b6; white-space: nowrap; font-size: 0.85rem;">${item.erechPidionPitzuimMaasikNochechi > 0 ? '₪' + item.erechPidionPitzuimMaasikNochechi.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.erechPidionMarkivPitzuimLemasNochechi ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #1abc9c; white-space: nowrap; font-size: 0.85rem;">${item.erechPidionMarkivPitzuimLemasNochechi > 0 ? '₪' + item.erechPidionMarkivPitzuimLemasNochechi.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.erechPidionPitzuimMaavidimKodmimRetzefZehuyut ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #34495e; white-space: nowrap; font-size: 0.85rem;">${item.erechPidionPitzuimMaavidimKodmimRetzefZehuyut > 0 ? '₪' + item.erechPidionPitzuimMaavidimKodmimRetzefZehuyut.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.erechPidionPitzuimLeHonMaavidimKodmim ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #e67e22; white-space: nowrap; font-size: 0.85rem;">${item.erechPidionPitzuimLeHonMaavidimKodmim > 0 ? '₪' + item.erechPidionPitzuimLeHonMaavidimKodmim.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.yitratPitzuimLeLoHitchashbenot ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #95a5a6; white-space: nowrap; font-size: 0.85rem;">${item.yitratPitzuimLeLoHitchashbenot > 0 ? '₪' + item.yitratPitzuimLeLoHitchashbenot.toLocaleString('he-IL') : '-'}</td>` : ''}
                            ${hasData.kayamRetzefPitzuimKitzba ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #16a085; white-space: nowrap; font-size: 0.85rem;">${item.kayamRetzefPitzuimKitzba > 0 ? 'כן' : 'לא'}</td>` : ''}
                            ${hasData.kayamRetzefPitzuimZechuyot ? `<td style="padding: 5px; border: 1px solid #ddd; text-align: center; color: #8e44ad; white-space: nowrap; font-size: 0.85rem;">${item.kayamRetzefPitzuimZechuyot > 0 ? 'כן' : 'לא'}</td>` : ''}
                        </tr>
                    `;
                });

                tableHTML += `
                        </tbody>
                    </table>
                    </div>
                `;
            }

            tableHTML += `
                </div>
                <div style="margin-top: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px; border-right: 4px solid #0183AA;">
                    <p style="color: #555; font-size: 0.9rem; margin: 0; text-align: right; line-height: 1.5;">
                        <strong>הערה:</strong> מוצגות רק רשומות עם סכומי פיצויים גדולים מ-0. סכומים בשקלים חדשים.
                    </p>
                </div>
            `;

            pitzuimTableDiv.innerHTML = tableHTML;
            const dataDisplayContainer = document.getElementById('dataDisplayContainer');
            dataDisplayContainer.appendChild(pitzuimTableDiv);
        }

        function closePitzuimTableDisplay() {
            const content = document.getElementById('pitzuimTableContent');
            const button = document.getElementById('closePitzuimTable');
            
            if (content && button) {
                if (content.style.display === 'none') {
                    content.style.display = 'block';
                    button.textContent = 'סגור';
                } else {
                    content.style.display = 'none';
                    button.textContent = 'פתח';
                }
            }
        }

        // פונקציה ליצירת טבלת סטטוס שעבוד, עיקול, הלוואה ותביעה
        function createStatusTable(statusData) {
            if (!statusData || statusData.length === 0) {
                return;
            }

            // סינון רק חשבונות עם בעיות (שעבוד/עיקול/הלוואה/תביעה)
            
            
            const filteredStatusData = statusData.filter(item => 
                // בדיקה יותר גמישה - כל ערך שאינו '2' או 2 נחשב כבעיה
                Number(item.hutalSHiabud) !== 2 || Number(item.hutalIkul) !== 2 || 
                Number(item.yeshHalvaaBamutzar) !== 2 || Number(item.yeshTvia) !== 2)

            // יצירת אלמנט חדש לטבלה
            const statusTableDiv = document.createElement('div');
            statusTableDiv.style.cssText = `
                background: rgba(255,255,255,0.95);
                padding: 25px;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.1);
                margin-top: 30px;
            `;

            // אם אין נתונים עם בעיות - הצג הודעה יפה
            if (filteredStatusData.length === 0) {
                statusTableDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: #333; margin: 0; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px; text-align: right;">🔒 סטטוס שעבוד, עיקול, הלוואה ותביעה</h3>
                    </div>
                    <div style="text-align: center; padding: 40px; background: linear-gradient(135deg, #27ae60, #2ecc71); border-radius: 15px; color: white;">
                        <div style="font-size: 3rem; margin-bottom: 20px;">✅</div>
                        <h4 style="font-size: 1.5rem; margin-bottom: 15px; font-weight: bold;">מצוין!</h4>
                        <p style="font-size: 1.1rem; margin: 0; line-height: 1.6;">
                            לא קיימים עיקולים, שעבודים, תביעות או הלוואות<br>
                            בכל החשבונות הפיננסיים שלך
                        </p>
                    </div>
                `;
                const dataDisplayContainer = document.getElementById('dataDisplayContainer');
                dataDisplayContainer.appendChild(statusTableDiv);
                return;
            }

            // מיפוי שמות מוצרים
            const shemTochnit = {
                '1': 'פוליסת ביטוח חיים משולב חיסכון',
                '2': 'קרן פנסיה',
                '2_1': 'קרן פנסיה ותיקה',
                '2_2': 'קרן פנסיה חדשה',
                '3': 'קופת גמל',
                '4': 'קרן השתלמות',
                '5': 'פוליסת חיסכון טהור',
                '6': 'פוליסת סיכון טהור',
                '7': 'ביטוח חיים משכנתא',
                '8': 'פוליסת סיכון טהור קולקטיב',
                '9': 'קופת גמל להשקעה',
                '10': 'חיסכון לכל ילד'
            };
           
            // פונקציה לקבלת סמל לפי ערך
            function getStatusIcon(value) {
                if (value === '2' || value === 2) {
                    return '<span style="color: #27ae60; font-size: 1.2em;">✅</span>'; // אין בעיה
                } else if (value === '1' || value === 1) {
                    flag=true;
                    return '<span style="color: #e74c3c; font-size: 1.2em;">⚠️</span>'; // יש בעיה
                } else {
                    flag=true;
                    return '<span style="color: #95a5a6; font-size: 1.2em;">❓</span>'; // לא ידוע
                }
            }

            // פונקציה לקבלת טקסט לפי ערך
            function getStatusText(value) {
                if (value === '2' || value === 2) {
                    return 'אין';
                } else if (value === '1' || value === 1) {
                    return 'יש';
                } else {
                    return 'לא ידוע';
                }
            }
            
           
             
            // מיון הנתונים לפי סוג מוצר ואז לפי מספר חשבון
            filteredStatusData.sort((a, b) => {
                if (a.sugMutzar !== b.sugMutzar) {
                    return a.sugMutzar.localeCompare(b.sugMutzar);
                }
                return a.misparPolisaOHeshbon.localeCompare(b.misparPolisaOHeshbon);
            });
            let tableHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: #333; margin: 0; font-size: 1.5rem; border-bottom: 3px solid #0183AA; padding-bottom: 10px; text-align: right;">🔒 סטטוס שעבוד, עיקול, הלוואה ותביעה</h3>
                    <button type="button" class="tbl-button" id="closeTable" onclick="closeTableDisplay()">סגור טבלה</button>
                </div>
                <table id="statusTable" dir="rtl" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                    <thead>
                        <tr style="background: linear-gradient(45deg, #0183AA, #764ba2); color: white;">
                            <th style="padding: 15px; text-align: right; border: 1px solid #ddd; white-space: nowrap;">סוג מוצר</th>
                            <th style="padding: 15px; text-align: right; border: 1px solid #ddd; white-space: nowrap;">מספר חשבון/פוליסה</th>
                            <th style="padding: 15px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">שעבוד</th>
                            <th style="padding: 15px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">עיקול</th>
                            <th style="padding: 15px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">הלוואה</th>
                            <th style="padding: 15px; text-align: center; border: 1px solid #ddd; white-space: nowrap;">תביעה</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            filteredStatusData.forEach(item => {
                const productName = shemTochnit[item.sugMutzar] || `מוצר ${item.sugMutzar}`;
                const pensiaType = item.pensiaVatikaOHadasha ? ` (${item.pensiaVatikaOHadasha})` : '';

                tableHTML += `
                    <tr style="background: rgba(102, 126, 234, 0.1);">
                        <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold; white-space: nowrap;">${productName}${pensiaType}</td>
                        <td style="padding: 12px; border: 1px solid #ddd; white-space: nowrap;">${item.misparPolisaOHeshbon}</td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; white-space: nowrap;">
                            ${getStatusIcon(item.hutalSHiabud)} ${getStatusText(item.hutalSHiabud)}
                        </td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; white-space: nowrap;">
                            ${getStatusIcon(item.hutalIkul)} ${getStatusText(item.hutalIkul)}
                        </td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; white-space: nowrap;">
                            ${getStatusIcon(item.yeshHalvaaBamutzar)} ${getStatusText(item.yeshHalvaaBamutzar)}
                        </td>
                        <td style="padding: 12px; border: 1px solid #ddd; text-align: center; white-space: nowrap;">
                            ${getStatusIcon(item.yeshTvia)} ${getStatusText(item.yeshTvia)}
                        </td>
                    </tr>
                `;
            });
            tableHTML += `
                    </tbody>
                </table>
                <div style="margin-top: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px; border-right: 4px solid #0183AA;">
                    <p id="statusTableNote" style="color: #555; font-size: 0.9rem; margin: 0; text-align: right; line-height: 1.5;">
                        <strong>הסבר:</strong><br>
                        ✅ <strong>אין</strong> - לא קיים שעבוד/עיקול/הלוואה/תביעה<br>
                        ⚠️ <strong>יש</strong> - קיים שעבוד/עיקול/הלוואה/תביעה<br>
                        ❓ <strong>לא ידוע</strong> - המידע לא זמין
                    </p>
                </div>
            `;
            statusTableDiv.innerHTML = tableHTML;

            // הוספת הטבלה החדשה לקונטיינר הראשי
            const dataDisplayContainer = document.getElementById('dataDisplayContainer');
            dataDisplayContainer.appendChild(statusTableDiv);
        }

        // פונקציה לסגירת התצוגה

        // ========================================
        // Navigate to Home Page Function
        // ========================================
        function navigateToHome() {
            // אם אנחנו כבר בדף הבית - פשוט נגלול למעלה
            if (window.location.pathname.endsWith('index.html') || window.location.pathname === '/') {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                // אנחנו בדף אחר - נעבור לדף הבית
                window.location.href = 'index.html';
            }
        }
    </script>

    <!-- Modal Container -->
    <div id="modals-container"></div>

    <!-- External Modal Scripts -->
    <script src="about-modal.js"></script>
    <script src="consultation-form.js"></script>
    <script src="terms-modal.js"></script>
    <script src="risk-quest-modal.js"></script>
    <script src="terms-consent.js"></script>
    <script src="professional-info-modal.js"></script>
    <script>
        // Load Modal HTML files
        fetch('about-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('modals-container').innerHTML += html;
            })
            .catch(err => console.error('Error loading about modal:', err));
        
        fetch('consultation-form.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('modals-container').innerHTML += html;
            })
            .catch(err => console.error('Error loading consultation form:', err));
        
        fetch('risk-quest-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('modals-container').innerHTML += html;
            })
            .catch(err => console.error('Error loading risk quest modal:', err));
        
        fetch('terms-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('modals-container').innerHTML += html;
            })
            .catch(err => console.error('Error loading terms modal:', err));
        
        fetch('terms-consent.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('afterbegin', html);
            })
            .catch(err => console.error('Error loading terms consent:', err));
        
        fetch('professional-info-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('modals-container').innerHTML += html;
            })
            .catch(err => console.error('Error loading professional info modal:', err));
        
        // Load Footer
        fetch('footer.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('beforeend', html);
            })
            .catch(err => console.error('Error loading footer:', err));
    </script>

    <!-- Accessibility Menu Script -->
    <script src="accessibility.js"></script>

<script>
    // Scroll to Top functionality
    function scrollToTop() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }
    
    // Show/Hide scroll to top button on scroll (mobile only)
    function updateScrollButton() {
        const scrollBtn = document.getElementById('scrollToTopBtn');
        if (scrollBtn && window.innerWidth <= 768) {
            if (window.pageYOffset > 300) {
                scrollBtn.classList.add('show');
            } else {
                scrollBtn.classList.remove('show');
            }
        } else if (scrollBtn) {
            scrollBtn.classList.remove('show');
        }
    }
    function updateAdviceButton() {
        const adviceBtn = document.getElementById('adviceBtnFloat');
        if (adviceBtn && window.innerWidth <= 768) {
            if (window.pageYOffset > 300) {
                adviceBtn.classList.add('show');
            } else {
                adviceBtn.classList.remove('show');
            }
        }
        else if(adviceBtn && window.innerWidth > 768){
            if (window.pageYOffset > 600) {
                adviceBtn.classList.add('show');
            } else {
                adviceBtn.classList.remove('show');
            }
        }
        }
        
     //   } else if (adviceBtn) {
     //       adviceBtn.classList.remove('show');
     //   }
    
    
    window.addEventListener('scroll', updateScrollButton);
    window.addEventListener('resize', updateScrollButton);
    window.addEventListener('scroll', updateAdviceButton);
    window.addEventListener('resize', updateAdviceButton);
    
    // Initialize on load
    setTimeout(updateScrollButton, 100);
</script>

</body>
</html>






