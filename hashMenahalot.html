<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-41JX3YK216"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-41JX3YK216');
    </script>
    
    <!-- SEO Meta Tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="השוואת חברות מנהלות - בחר מסלול והשווה בין כל החברות המנהלות לפי תשואות, דמי ניהול ונתונים נוספים.">
    <title>השוואת חברות מנהלות - השוואת קופות גמל וקרנות | פיננסי-נט</title>
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="השוואת חברות מנהלות - פיננסי-נט">
    <meta property="og:description" content="השווה בין חברות מנהלות שונות לפי תשואות ודמי ניהול">
    <meta property="og:image" content="https://i.postimg.cc/L4YLr22D/logoxnew.png">
    <meta property="og:url" content="https://zamit00.github.io/NewFinnanciNet/hashMenahalot.html">
    <meta property="og:type" content="website">
    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="kochavimscript.js" defer></script>
    <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        max-width: 100%;
    }
    
    html {
        scroll-behavior: smooth;
    }
    
    .tblmaxsize{
        width: clamp(300px,90vw,1000px) !important;
    }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: #f8fafc; 
        direction: rtl;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        box-sizing: border-box;
        max-width: 100%;
        overflow-x: hidden;
        line-height: 1.6;
        color: #333;
    }
    
.logotext {
    position: relative;
    width: 100%;
    top: 45px;
    text-align: center;
    font-size: 2rem; /* גודל הטקסט */
    font-weight: bold;
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%); /* גרדיאנט ירוק */
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    display: inline-block;
    animation: gradientShift 5s infinite linear;
  }
h1 {
    text-align: center;
}
    td{text-align: center;}
    #form2{display: none;}

.formDo{
    background-color: white; /* רקע לבן כמו כרטיסים ב-index */
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    border-radius: 20px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #0183AA;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: clamp(300px,90vw,800px);
    padding-bottom: 30px;
    box-sizing: border-box;
    margin-top: 40px;
}
.formDo h1{
    font-size:25px;
}
.formDo label {
    font-weight: bold;
    margin-bottom: 5px;
}
.custom-confirm-button{
    max-width: 250px;
}
.rd{
    font-size: 18px;
    padding: 15px;
    color: rgb(24, 124, 24);
    font-weight: lighter;
    white-space: nowrap;
}
.chooseopt{
    width: clamp(300px,90%,500px);
    height: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 15px;
}
.choose{
    width: 300px;
    margin: 5px;
}
.dropdown {
    position: relative;
    display: inline-block;
    width: 90%;
    border-radius: 10px;
    border: 1px solid #0183AA;
    height: 40px;
    color: #0183AA ;
    font-size: 16px;
    text-align: right;   
}
.dropdown-toggle{
    width:99%;
    border-radius: 10px;
    padding: 10px;
    cursor: pointer;
    background: #fff;
    text-align: right;
    box-sizing: border-box;
    display: flex;
    align-items: center;
    height: 38px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding-right: 20px;   
}
#compareButton, #compareButton2 {
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    color: white;
    border-radius: 50px; /* פינות מעוגלות יותר */
    box-shadow: 0 4px 15px #0183AA;
    transition: all 0.3s ease;
}
#compareButton:hover, #compareButton2:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px #0183AA;
}
.form{
    display: flex;
    flex-direction:column;
    align-items: center;
    width: clamp(300px,500px,500px);
    max-width: 100vw;
}
.inputHev{
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
#compare{
    display: flex;
    justify-content: center;
}
table {
    width: 100%;
    max-width: 1000px;
    border-collapse: collapse;
    direction: rtl;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 16px;
    table-layout: auto;
    margin: 0 auto;
}

.tbltbody {
    max-width: 1000px;
    width: 100%;
    margin: 20px auto;
    overflow-x: hidden;
    table-layout: fixed;
}

.tbltbody table {
    width: 100%;
    max-width: 1000px;
    table-layout: fixed;
}

th, td {
    padding: 12px 10px;
    text-align: center;
    border: 1px solid #ddd;
    word-wrap: break-word;
}

th {
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    color: white;
    text-align: center;
    font-weight: 600;
}

tr:nth-child(even) {
    background-color: #f2f2f2;
}

tr:hover {
    background-color: #f0f4ff;
}

tbody {
    display: table-row-group;
}

tbody tr {
    display: table-row;
}
/* קביעת רוחב לעמודות */
th:nth-child(1), td:nth-child(1) { width: 14%; } /* עמודה ראשונה (חברה) */
th:nth-child(2), td:nth-child(2) { width: 24%; } /* עמודה שנייה (שם המסלול) - הקטנה */
th:nth-child(3), td:nth-child(3) { width: 16%; } /* עמודה שלישית - הגדלה */
th:nth-child(4), td:nth-child(4) { width: 15%; } /* עמודה רביעית */
th:nth-child(5), td:nth-child(5) { width: 15%; } /* עמודה חמישית */
/* Chart Container */
.charts {
    display: none;
    flex-direction: column;
    align-items: center;
    max-width: 1000px;
    width: 100%;
    margin: 2rem auto;
    padding: 2rem;
    background: white;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    min-height: 600px;
}

.charts.show-charts {
    display: flex !important;
    visibility: visible !important;
}

.chart-controls {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
    width: 100%;
}

.chart-btn {
    background: white;
    color: #0183AA;
    padding: 12px 24px;
    border: 2px solid #e2e8f0;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
    font-size: 1rem;
}

.chart-btn:hover {
    background: #0183AA;
    color: white;
    transform: translateY(-2px);
}

.chart-btn.active {
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    color: white;
    border-color: #0183AA;
}

.chart-container {
    width: 100%;
    max-width: 900px;
    height: 500px;
    position: relative;
    margin: 0 auto;
}

.chart-wrapper {
    display: none !important;
    width: 100%;
    height: 100%;
    position: relative;
}

.chart-wrapper.active {
    display: block !important;
}

.chart-wrapper canvas {
    width: 100% !important;
    height: 100% !important;
    max-height: 500px !important;
}
#compare h3{ padding-right:10px;padding-left:10px;}
#compare h4{text-decoration: underline;color: #0183AA; padding-right: 10px;}
#compare p{text-align: justify;padding-right:10px; padding-left: 10px}
.maspn{text-decoration: underline;color: green;}
.dropdown-menu {
    display: none;
    position: absolute;
    width:270px;
    background: #fff;
    border: 1px solid #ccc;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    max-height: 150px;
    z-index: 1000;
    box-sizing: border-box;
    overflow-y: auto;
}
.spn{position: absolute; left: 5px;}
.dropdown-menu label {
    display: block;
    padding: 5px 10px;
    cursor: pointer;
}
.dropdown-menu label:hover {
    background: #f0f0f0;
}
#compareButton3{display:none;}
.lblkot{width: 300px;font-size: 20px;text-align: center;
    margin-top: 5px; box-sizing: border-box;}
.sugsel{text-align: center;}
.tbl{display: flex;justify-content: center;}

/* Header and Navigation */
.header {
    position: sticky;
    top: 0;
    width: 100% !important;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    box-shadow: 0 2px 20px rgba(0,0,0,0.1);
    z-index: 1000;
    padding: 1rem 0;
    transition: all 0.3s ease;
    max-width: 1400px;
    margin-right: auto;
    margin-left: auto;
}

.nav-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo {
    font-size: 1.8rem;
    font-weight: bold;
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.logoimg {
    max-width: 200px;
    height: auto;
}

.nav-menu {
    list-style: none;
    display: flex;
    gap: 2rem;
    align-items: center;
}

.nav-menu a {
    text-decoration: none;
    color: #333;
    font-weight: 500;
    transition: color 0.3s ease;
    position: relative;
    font-size: 16px;
}

.nav-menu a:hover {
    color: #0183AA;
}

.nav-menu a:hover::after {
    width: 100%;
}

.nav-menu a::after {
    content: '';
    position: absolute;
    bottom: -5px;
    right: 0;
    width: 0;
    height: 2px;
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    transition: width 0.3s ease;
}

/* Navigation Dropdown */
.nav-dropdown {
    position: relative;
}

.nav-dropdown .dropdown-content {
    display: flex;
    flex-direction: column;
    position: absolute;
    top: calc(100% - 2px);
    right: 0;
    background: white;
    border: 1px solid #ddd;
    border-radius: 0 0 8px 8px;
    box-shadow: none;
    min-width: 220px;
    z-index: 1001;
    margin-top: 0;
    border-top: none;
    max-height: 0;
    opacity: 0;
    visibility: hidden;
    overflow: hidden;
    transition: max-height 0.3s ease, opacity 0.3s ease, visibility 0.3s ease;
}

.nav-dropdown .dropdown-content a {
    color: #333;
    padding: 12px 16px;
    text-decoration: none;
    display: block;
    transition: background-color 0.3s ease;
    font-size: 14px;
    border-bottom: 1px solid #eee;
}

.nav-dropdown .dropdown-content a:hover {
    background-color: #f5f5f5;
    color: #0183AA;
}

.nav-dropdown .dropdown-content a:last-child {
    border-bottom: none;
}

.nav-dropdown .dropdown-content.show {
    max-height: 500px;
    opacity: 1;
    visibility: visible;
}

/* Desktop hover behavior */
@media (min-width: 769px) {
    .nav-dropdown:hover .dropdown-content:not(.show) {
        max-height: 500px;
        opacity: 1;
        visibility: visible;
    }
}

.hamburger {
    display: none;
    flex-direction: column;
    cursor: pointer;
    gap: 4px;
}

.hamburger span {
    width: 25px;
    height: 3px;
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    transition: 0.3s;
    border-radius: 3px;
}

.hamburger.active span:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
}

.hamburger.active span:nth-child(2) {
    opacity: 0;
}

.hamburger.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -6px);
}

@media (max-width: 850px) {
    table,tr{font-size: 12px;
    max-width: 90vw;}
    }
@media (max-width: 768px) {
    .header {
        padding: 1rem 0;
        width: 100%;
        margin: 0;
    }

    .nav-container {
        padding: 1rem 1rem;
    }
    
    footer{max-width: 100%;box-sizing: border-box;margin: 0;padding: 0;}

    .nav-menu {
        position: fixed;
        top: 80px;
        right: 0;
        width: 100%;
        height: calc(100vh - 80px);
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(10px);
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        padding-top: 2rem;
        display: flex;
        opacity: 0;
        visibility: hidden;
        transform: translateX(100%);
        transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
    }

    .hamburger {
        display: flex;
        padding-left: 5%;
    }

    .nav-menu.active {
        opacity: 1;
        visibility: visible;
        transform: translateX(0);
        margin-top: -25px; 
    }
    
    .nav-menu.active li,
    .nav-menu.active li a {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        margin-left: auto;
        margin-right: auto;
        width: 100%;
    }
    
    /* Mobile nav-dropdown adjustments */
    .nav-dropdown .dropdown-content {
        position: relative;
        display: flex;
        flex-direction: column;
        min-width: auto;
        width: clamp(200px, 100%, 270px);
        max-height: 0;
        opacity: 0;
        visibility: hidden;
        overflow: hidden;
        border: none;
        background: white;
        margin-top: 5px;
        top: auto;
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        padding: 0;
        transition: max-height 0.3s ease, opacity 0.3s ease, visibility 0.3s ease, padding-top 0.3s ease;
    }

    .nav-dropdown .dropdown-content a {
        padding: 8px 16px;
        border-bottom: 1px solid #eee;
        font-size: 1rem;
    }

    .nav-dropdown .dropdown-content.show {
        max-height: 500px;
        opacity: 1;
        visibility: visible;
        padding-top: 15px;
    }
    
    .logoimg {
        width: 150px;
        height: auto;
    }
    
    .charts {
        flex-direction: column;
        max-width: 95vw;
        gap: 1.5rem;
    }
    
    .chart-container {
        max-width: 100%;
        width: 100%;
        height: 350px;
    }
    
    .charts {
        padding: 1.5rem 1rem;
    }
    
    .chart-controls {
        gap: 0.5rem;
    }
    
    .chart-btn {
        padding: 10px 16px;
        font-size: 0.9rem;
    }
}

@media (max-width: 500px) {
    table, th, td {
        font-size: 9px;
        max-width: 100%;
    }
    
    .charts {
        flex-direction: column;
        max-width: 98vw;
        gap: 1rem;
        padding: 1rem 0.5rem;
    }
    
    .chart-container { 
        max-width: 100%;
        width: 100%;
        height: 280px;
    }
    
    .chart-controls {
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        width: 100%;
    }
    
    .chart-btn {
        padding: 10px 20px;
        font-size: 0.85rem;
        width: 100%;
        max-width: 250px;
    }
    
    #compare {
        font-size: 10px;
    }
    
    .rd {
        font-size: 12px;
    }
}
h1 {
    text-align: center;
}
.formDo h1{
    font-size:25px;
}
.formDo label {
    font-weight: bold;
    margin-bottom: 5px;
}
.rd{
    font-size: 18px;
    padding: 15px;
    color: rgb(24, 124, 24);
    font-weight: lighter;
    white-space: nowrap;
}
.chooseopt{
    width: clamp(300px,90%,500px);
    height: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 15px;
}
.choose{
    width: 300px;
    margin: 5px;
}
.dropdown {
    position: relative;
    display: inline-block;
    width: 90%;
    border-radius: 10px;
    border: 1px solid #0183AA;
    height: 40px;
    color: #005bb5;
    font-size: 16px;
    text-align: right;   
}
.dropdown-toggle{
    width:99%;
    border-radius: 10px;
    padding: 10px;
    cursor: pointer;
    background: #fff;
    text-align: right;
    box-sizing: border-box;
    display: flex;
    align-items: center;
    height: 38px;
     font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    padding-right: 20px;
}
#compareButton, #compareButton2 {
    width: 90%;
    padding: 10px;
    font-size: 18px;
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.3s ease-in-out;
    margin-top: 30px;
    box-sizing: border-box;
}
#compareButton:hover {
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    color: white;
}
.form{
    display: flex;
    flex-direction:column;
    align-items: center;
    width: clamp(300px,500px,500px);
}
.inputHev{
     font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
#compare{
    display: flex;
    justify-content: center;
    width:95vw;
    max-width:100vw;
}
table {
    width: 100%;
    border-collapse: collapse;
    direction: rtl;
     font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 16px;
    table-layout: fixed; /* חלוקת עמודות קבועה */
}
th, td {
    text-align: center;
    border: 1px solid #ddd;
    word-wrap: nowrap; /* גלישת טקסט */
}
th {text-align:right ;
    background: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
    color: white;
    text-align: center;
    padding:0;
}
tr:nth-child(even) {
    background-color: #f2f2f2;
    padding:0;
}
tr:hover {
    background-color: #d0e4ff;
}
/* גלילה אנכית לתוכן */
tbody {
    display: block;
    margin-top: 30px;
    max-width: 100%;
    
}
/* שמירה על מבנה רספונסיבי */
tbody tr {
    display: table;
    width: 100%;
    max-width:100%;
    table-layout: fixed;
    white-space:wrap;
}
#compare h4{text-decoration: underline;color: #0183AA ;
padding-right:10px; padding-left: 10px;
}
#compare p{text-align: justify;padding-right:10px; padding-left: 10px;}
.maspn{text-decoration: underline;color: green;}
.dropdown-menu {
    display: none;
    position: absolute;
    width:270px;
    background: #fff;
    border: 1px solid #ccc;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    max-height: none;
    z-index: 1000;
    box-sizing: border-box;
    overflow-y: visible;
}
.spn{position: absolute; left: 5px;}
.dropdown-menu label {
    display: block;
    padding: 5px 10px;
    cursor: pointer;
}
.dropdown-menu label:hover {
    background: #f0f0f0;
}
.lblkot{width: 300px;font-size: 20px;text-align: center;
    margin-top: 5px; box-sizing: border-box;}
.sugsel{text-align: center;}
.tbl{display: flex;justify-content: center;}
@media (min-width: 1024px) {
    .chart-container { 
        max-width: 900px;
        height: 500px;
    }
    
    .charts {
        max-width: 1000px;
        padding: 2.5rem;
    }
}
.tblRashi{
            width: 100%;
            max-width: 800px;
            border-collapse: collapse;
            margin: auto;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
        }
        .thkotrash,.thkotmish, .tdshura {
            border: 1px solid #ddd;
            padding: 2px;
            text-align: center;
        }
        .thkotmish {
            background-color: #007BFF;
            color: white;
        }
        .thkotrash {
            background-color: linear-gradient(180deg, #62B1C8 0%, #2494B5 50%, #0183AA 100%);
            font-size: 14px;color: white;
        }
        tbody tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        /* התאמת עמודות */
        thead tr:nth-child(2) th:first-child,
        tbody tr td:first-child {
            width: 60%;
        }
        thead tr:nth-child(2) th:not(:first-child),
        tbody tr td:not(:first-child) {
            width: calc(40% / 3);
        }
        /* התאמה למסכים קטנים */
        @media (max-width: 600px) {
            .tblRashi {
                font-size: 10px;
            }
        }
    </style>
    
    <!-- External Modal Styles -->
    <link rel="stylesheet" href="about-modal.css">
    <link rel="stylesheet" href="consultation-form.css">
    <link rel="stylesheet" href="terms-modal.css">
    <link rel="stylesheet" href="mainStyle.css">
    <link rel="stylesheet" href="footer.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script src="data.js"></script>  

</head>
<body dir="rtl">
    <header class="header" dir="rtl">
        <div class="nav-container">   
            <nav class="nav-menu" id="navMenu">
                <li><a href="#" onclick="navigateToHome(); return false;"><i class="fa fa-home" style="font-size:2rem"></i></a></li>
                <li class="nav-dropdown">
                    <a href="#" onclick="toggleHashMenahalotProductsDropdown(event)">מוצרים ותשואות ▼</a>
                    <div class="dropdown-content" id="hashMenahalotProductsDropdown">
                        <a href="mozarim.html?product=hishtalmut">קרנות השתלמות</a>
                        <a href="mozarim.html?product=gemel">קופות גמל</a>
                        <a href="mozarim.html?product=gemelHashkaa">קופות גמל להשקעה</a>
                        <a href="mozarim.html?product=yeled">חסכון לילד</a>
                        <a href="mozarim.html?product=polisot">פוליסות חסכון</a>
                        <a href="mozarim.html?product=pensia">קרנות פנסיה חדשות</a>
                        <a href="mozarim.html?product=pensiaKlalit">קרנות פנסיה כלליות</a>
                    </div>
                </li>
                <li class="nav-dropdown">
                    <a href="#" onclick="toggleHashMenahalotCalculatorDropdown(event)">מחשבונים ▼</a>
                    <div class="dropdown-content" id="hashMenahalotCalculatorDropdown">
                        <a href="prisatMaanak.html">פריסת מענק פרישה</a>
                        <a href="calac.html">מחשבון דחיית קצבה</a>
                        <a href="ribitderibit.html">חישוב ערך עתידי</a>
                        <a href="loan.html">סימולטור הלוואה</a>
                        <a href="hafkada.html">מחשבון הפקדה לסכום מטרה</a>
                        <a href="hashDmeyNihul.html">השוואת דמי ניהול</a>
                    </div>
                </li>
                <li class="nav-dropdown">
                    <a href="#" onclick="toggleHashMenahalotToolsDropdown(event)">כלי השוואה ▼</a>
                    <div class="dropdown-content" id="hashMenahalotToolsDropdown">
                        <a href="hashMenahalot.html">השוואת חברות מנהלות</a>
                        <a href="hasifotMeshulav.html">מחולל חשיפות</a>
                        <a href="VirtualInvest.html">השוואת תיק משולב מסלולים</a>                        
                        <a href="#">ציון משקל תשואה לשארפ</a>
                    </div>
                </li>
                <li><a href="#" onclick="openAboutModal(); return false;">אודות</a></li>
                <li><a href="index.html" onclick="openConsultationForm(); return false;">צור קשר</a></li>
                <li class="whatsapp-desktop"><a href="https://wa.me/972545287184?text=שלום, אני מעוניין בייעוץ פנסיוני" target="_blank" title="צור קשר בוואטסאפ"><i class="fab fa-whatsapp" style="font-size:2rem; color:#0183AA;"></i></a></li>
            </nav>
            <div class="whatsapp-mobile">
                <a href="https://wa.me/972545287184?text=שלום, אני מעוניין בייעוץ פנסיוני" target="_blank" title="צור קשר בוואטסאפ">
                    <i class="fab fa-whatsapp" style="font-size:2rem; color:#0183AA;"></i>
                </a>
            </div>
            <div class="logo"> <img class="logoimg" src="https://shaham-orlan.co.il/wp-content/uploads/2023/06/logo.png" onclick="navigateToHome();" style="cursor: pointer;"/></div>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </header>
    
    <div class="formDo" id="formDo" style="margin-top: 2rem;">
        <h1>השוואת חברות</h1>
        
    <div class="chooseopt">
    <div class="choose">
   <input  type="radio" id="radio1" name="radio" onchange="selchange()" checked>
    <label class="rd" for="radio1">מוצר ומסלול - מרובה חברות</label>
            </div>
            <div class="choose">
                <input  type="radio" id="radio2" name="radio" onchange="selchange()"> 
                <label class="rd" for="radio2">שתי חברות - כלל המוצרים</label>
            </div>
        </div>
        <div class="form" id="form1">
            <label class="lblkot" for="dropdown-toggle">בחר מנהלת</label>
            <div class="dropdown">
                <div id="dropdown-toggle" class="dropdown-toggle" onclick="toggleDr();changmoz()"><span
                     class='spn' id="spn">v</span>
               </div>
<div id='dropdown-menu' class="dropdown-menu"></div>
</div>
<div id='mas'  style='width:clamp(300px,90vw,600px);height:100vh;z-index:1000;
    background-color:white;display:none;position: relative;top:-100px;right:80px;' ></div>
<label class="lblkot" for="sugMMen">בחר מוצר</label>
 <select class="dropdown sugsel"  id="sugMMen" onchange="changeTheMuzar()">
 <option value="" disabled selected></option>
 <option value="קרנות השתלמות">קרנות השתלמות</option>
 <option value="תגמולים ואישית לפיצויים">קופות גמל</option>
 <option value="קופת גמל להשקעה">קופת גמל להשקעה</option>
  <option value="קופת גמל להשקעה - חסכון לילד">חסכון לילד</option> 
 <option value="פוליסות חסכון">פוליסות חסכון פרט</option> 
<option value="קרנות חדשות">קרנות פנסיה</option></select>

<label class="lblkot" for="selectShemkupa">בחר מסלול</label>
            <select class="dropdown sugsel" id="selectShemkupa" onchange='changmoz()' ></select>
            <button id="compareButton" onclick="dohash()">בצע</button>
        </div>
        <div class="form" id="form2">
            <label class="lblkot" for="sugMMen">בחר מנהלת מובילה</label>
            <select class="dropdown" id="selmen1" onchange="clearCompare()"></select>
            <label class="lblkot" for="sugMMen">מול מנהלת</label>
            <select class="dropdown" id="selmen2" onchange="clearCompare()"></select>
            <button id="compareButton2" onclick="compare2()">בצע השוואה</button>
            <button id="compareButton3" onclick="pdfDo()"
            style="background-color: #0183AA;
            margin-top:30px;color: white;">קובץ pdf</button>
        </div>
    </div>
    <div id="compare"></div>
    <label class='tes tblmaxsize' style="margin-top:20px;display:none;"> תשואות</label>
    <table class='tbltbody' id="comparisonTable">
        <tbody></tbody>
    </table>
     <label class='has tblmaxsize' style="margin-top:20px;display:none;"> חשיפות</label>
        <table class='tbltbody' id="comparisonTable2">
        <tbody></tbody>
    </table>
     
      <label class='sik tblmaxsize' style="margin-top:20px;display:none;"> מדדי סיכון</label>
        <table class='tbltbody' id="comparisonTable3">
        <tbody></tbody>
    </table>
    
     
    <div class="charts" id="charts" style="display: none; visibility: hidden;">
        <div class="chart-controls">
            <button class="chart-btn active" onclick="switchChart('year')">תשואה שנתית</button>
            <button class="chart-btn" onclick="switchChart('threeYear')">תשואה 3 שנים</button>
            <button class="chart-btn" onclick="switchChart('fiveYear')">תשואה 5 שנים</button>
        </div>
        <div class="chart-container">
            <div class="chart-wrapper active" id="yearChartWrapper">
                <canvas id="yearChart"></canvas>
            </div>
            <div class="chart-wrapper" id="threeYearChartWrapper">
                <canvas id="threeYearChart"></canvas>
            </div>
            <div class="chart-wrapper" id="fiveYearChartWrapper">
                <canvas id="fiveYearChart"></canvas>
            </div>
        </div>
    </div>
    <script src="accessibility.js"></script>
    <script>
        /*eruda.init();*/
    let datanetunimKlaliXa = [];let datanetunimKlaliXb = [];let datanetunimKlaliXp = [];
    const gufmosdix = [
    'הראל פנסיה וגמל', 'כלל פנסיה וגמל',
    'מגדל מקפת קרנות פנסיה וקופות גמל', 'מנורה מבטחים פנסיה וגמל',
    'הפניקס פנסיה וגמל', 'אלטשולר שחם גמל ופנסיה',
    'אנליסט קופות גמל', 'ילין לפידות ניהול קופות גמל', 'מור גמל ופנסיה',
    'מיטב גמל ופנסיה', 'אינפיניטי השתלמות, גמל ופנסיה '
];
const gufmosdi = gufmosdix.sort((a, b) => a.localeCompare(b, 'he'));
    const mozkochCompare = [
    'קרנות השתלמות', 'תגמולים ואישית לפיצויים', 'קופת גמל להשקעה',
     "קופת גמל להשקעה - חסכון לילד", "פוליסות חסכון"
    ,'קרנות חדשות'];
    const hevMen=gufmosdi;
    const menu = document.querySelector('.dropdown-menu');
    const selmenu1 = document.getElementById('selmen1');
    const selmenu2 = document.getElementById('selmen2');

    const divCompare = document.getElementById('compare');
    const btnPdf = document.getElementById('compareButton3');
    const form1 = document.getElementById('form1');
    const form2 = document.getElementById('form2');
    const radio1 = document.getElementById('radio1');
    const radio2 = document.getElementById('radio2');
    const charts = document.getElementById('charts');
    var z=0;
    menu.innerHTML=''
        for(let i=0;i<gufmosdi.length;i++){
   if(i===0){
    menu.innerHTML+=`  
      <label style='font-size: 11px !important;'><input class="inputHev"  type="checkbox" value="all" onchange="sfira()"> כל החברות </label>
            `;   
            }
            /*if(gufmosdi[z]==='מגדל מקפת קרנות פנסיה וקופות גמל'){gufmosdi[z]='מגדל מקפת'}*/
  menu.innerHTML+=`
  <label style='font-size: 11px !important;'><input class="inputHev" type="checkbox" value=${gufmosdi[z]} onchange="sfira()"> ${gufmosdi[z]} </label>
            `;
            const opt1=document.createElement('option');
            opt1.value=gufmosdi[z];
            opt1.textContent=gufmosdi[z];
            selmenu1.appendChild(opt1);
            const opt2=document.createElement('option');
            opt2.value=gufmosdi[z];
            opt2.textContent=gufmosdi[z];
            selmenu2.appendChild(opt2);
            z++;
        }
        window.onload = async function() {
        await fetchdataJasonX();
        form1.style.display='flex';
        form2.style.display='none';
    };
       function selchange(){
        // הסתרת כל הטבלאות והגרפים תמיד בתחילה
        charts.style.display = 'none';
        document.querySelector('.tes').style.display = 'none';
        document.querySelector('.has').style.display = 'none';
        document.querySelector('.sik').style.display = 'none';
        document.getElementById('comparisonTable').style.display = 'none';
        document.getElementById('comparisonTable2').style.display = 'none';
        document.getElementById('comparisonTable3').style.display = 'none';
        divCompare.innerHTML = '';
        
        // ניקוי תוכן הטבלאות
        const tbody1 = document.querySelector('#comparisonTable tbody');
        const tbody2 = document.querySelector('#comparisonTable2 tbody');
        const tbody3 = document.querySelector('#comparisonTable3 tbody');
        
        if (tbody1) tbody1.innerHTML = '';
        if (tbody2) tbody2.innerHTML = '';
        if (tbody3) tbody3.innerHTML = '';
        
        if(radio1.checked){
            form1.style.display = 'flex';
            form2.style.display = 'none';
           
            
            
        }
        else{
            form1.style.display = 'none';
            form2.style.display = 'flex';
            charts.classList.remove('show-charts');
        }
       } 
        function sfira(){
            var sfiracheck=0;
            document.querySelectorAll(".dropdown-menu input[type='checkbox']").forEach(checkbox => {
                if (checkbox.value ==="all" && checkbox.checked){
                    sfiracheck="כל החברות";
                    document.querySelectorAll(".dropdown-menu input[type='checkbox']").forEach(checkbox => {
                     if(checkbox.checked && checkbox.value !=="all" ) {checkbox.checked='false'};
                    });
                    document.querySelector('.dropdown-menu').style.display='none';
                }
                else if(checkbox.checked) {sfiracheck++};
    });
    const checkedCount = document.querySelectorAll('input[type="checkbox"]:checked').length;
    if(checkedCount===0){
        document.getElementById("dropdown-toggle").innerHTML=`לא נבחרו חברות
      <span class='spn' id="spn">v</span> `;return;
    }
   if(sfiracheck){
    document.getElementById("dropdown-toggle").innerHTML=` נבחרו: ${sfiracheck}
      <span class='spn' id="spn">v</span> `
   }
   else if(!sfiracheck){
    document.querySelectorAll(".dropdown-menu input[type='checkbox']").forEach(checkbox => {
     if(checkbox.checked && checkbox.value !=="all" ) {checkbox.checked='false'};
    });
   }
        }
    function toggleDr() {
        const menu = document.querySelector('.dropdown-menu');
        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    }
function changmoz(){
        document.getElementById('comparisonTable').style.display='none';
        document.getElementById('yearChart').style.display='none';
        document.getElementById('threeYearChart').style.display='none';
        document.getElementById('fiveYearChart').style.display='none';
        document.querySelector('.tblmaxsize').style.display='none';
        document.querySelector('.tes').style.display='none';
        document.querySelector('.has').style.display='none';
        document.querySelector('.sik').style.display='none';
        
    }
function changeTheMuzar() {
        document.getElementById('comparisonTable').style.display='none';
        document.getElementById('yearChart').style.display='none';
        document.getElementById('threeYearChart').style.display='none';
        document.getElementById('fiveYearChart').style.display='none';
        const selectedProduct = document.getElementById('sugMMen').value;
        const selectShemkupa = document.getElementById('selectShemkupa');
        selectShemkupa.innerHTML = '';
        let relevantList;
        if (selectedProduct === "קרנות השתלמות" || selectedProduct === "קופת גמל להשקעה" 
        || selectedProduct === 'פוליסות חסכון') {
            relevantList = hishtalmot;
        } else if (selectedProduct === "תגמולים ואישית לפיצויים"  || selectedProduct==='קרנות חדשות' ) {
            relevantList = gemel;
        } else if (selectedProduct.includes('לילד' )){relevantList = layeled; }
        
        /* const uniqueMaslulim = [...new Set(relevantList.map(item => item.shemkupa))];*/
        for(let i=0;i<relevantList.length;i++){
        const option = document.createElement('option');
            option.value = relevantList[i];
            option.textContent = relevantList[i];
            selectShemkupa.appendChild(option);
        }

}

 async function fetchdataJasonX() {
    try {
        const response = await fetch('dataJasonM.json');
        if (!response.ok) throw new Error(`שגיאה: ${response.status} ${response.statusText}`);
        datanetunimKlaliXa = await response.json();
        datanetunimKlaliXa=datanetunimKlaliXa.filter(item=>item.tesuam !== undefined && Number(item.tesuam)!==0)
    } catch (error) {
        console.error('שגיאה בשליפת הנתונים:', error);
    }
    try {
        const responseb = await fetch('dataJasonB.json');
        if (!responseb.ok) throw new Error(`שגיאה: ${response.status} ${response.statusText}`);
        datanetunimKlaliXb = await responseb.json();
        datanetunimKlaliXb=datanetunimKlaliXb.filter(item=>item.tesuam !== undefined && Number(item.tesuam)!==0)
    } catch (error) {
        console.error('שגיאה בשליפת הנתונים:', error);
    }
    try {
        const responseb = await fetch('dataJasonP.json');
        if (!responseb.ok) throw new Error(`שגיאה: ${response.status} ${response.statusText}`);
        datanetunimKlaliXp = await responseb.json();
        datanetunimKlaliXp=datanetunimKlaliXp.filter(item=>item.tesuam !== undefined && Number(item.tesuam)!==0)
    } catch (error) {
        console.error('שגיאה בשליפת הנתונים:', error);
    }
}
// שינוי בפונקציה של הכפתור כדי להציג נתונים לכל החברות אם נבחר "כל החברות"
 async function dohash() {
    document.querySelector('.dropdown-menu').style.display='none';
    document.getElementById('compare').style.display = 'none';
    
    const checkedCount = document.querySelectorAll('input[type="checkbox"]:checked').length;
    const selectedmoz=document.getElementById('sugMMen').value
    
    if(checkedCount===0){
        hatraa('לא נבחרו חברות');return;
    }
    if(!selectedmoz){
        hatraa('לא נבחר מוצר');return;
    }
    
    // הצגת טבלאות ו-labels
    document.querySelector('.tes').style.display = 'block';
    document.querySelector('.has').style.display = 'block';
    document.querySelector('.sik').style.display = 'block';
    document.getElementById('comparisonTable').style.display = 'block';
    document.getElementById('comparisonTable2').style.display = 'block';
    document.getElementById('comparisonTable3').style.display = 'block';
    
    //toggleDr();
    var selectedValues = [];
    document.querySelectorAll(".dropdown-menu input[type='checkbox']").forEach(checkbox => {
        if(checkbox.checked) {selectedValues.push(checkbox.value)};
    });
    const selectedProduct = document.getElementById('sugMMen').value;
    const selectedMaslul = document.getElementById('selectShemkupa').value;
    // אם "כל החברות" נבחר, נשתמש בכל החברות
    if (selectedValues.includes("all")) {
        if(selectedProduct!=='פוליסות חסכון' && selectedProduct!=='קרנות חדשות'){
        selectedValues = [...new Set(datanetunimKlaliXa.map(company => company.menahelet))];
        }
        else if(selectedProduct==='קרנות חדשות'){
        selectedValues = [...new Set(datanetunimKlaliXp.map(company => company.menahelet))];
        }
        else{
            selectedValues = [...new Set(datanetunimKlaliXb.map(company => company.shemkupa.split(" ")[0]))];
        }

        
    }
    var databring;var selectedData
    databring=await filterMaslulXa(selectedMaslul, selectedProduct);
    if(selectedProduct!=='פוליסות חסכון' && selectedProduct!=='קרנות חדשות'){
    databring=databring.filter(item=>(!item.ochlosiyayaad.includes('עובדי סקטור מסויים')
      &&  !item.ochlosiyayaad.includes('עובדי מפעל/גוף מסויים') && Number( item.tesuam)!==0)
    && !item.menahelet.includes('סלייס'))};
   
    if(selectedProduct!=='פוליסות חסכון' ){
     selectedData = databring.filter(item =>
         selectedValues.some(b => item.menahelet.includes(b))
         && item.tesuam 
    );}
    else{
        selectedData = databring.filter(item =>
        selectedValues.some(b => item.shemkupa.includes(b)) 
        && item.tesuam
    ); 
    }
    
    selectedData.sort((a, b) => b.tesuam - a.tesuam);
    updateTable(selectedData);
    updateCharts(selectedData,selectedProduct);
};
function updateTable(data) {
            const tableBody = document.querySelector('#comparisonTable tbody');
            
            if (!tableBody) {
                console.error('לא נמצא tbody עבור comparisonTable');
                return;
            }
            
            tableBody.innerHTML = `
                <thead>
                <tr>
                    <th style="width:16%;">חברה</th>
                    <th style="width:25%;">שם המסלול</th>
                    <th style="width:16%;">תשואה שנה</th>
                    <th style="width:16%;">תשואה 3 שנים</th>
                    <th style="width:16%;">תשואה 5 שנים</th>
                </tr>
                </thead>
            `;
            data.forEach(company => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td  style='text-align:right;paddin-right:5px;width:16%;white-space:wrap;'>${company.shemkupa.split(" ")[0]}</td>
                    <td class="tdnamekupa" style='text-align:right;paddin-right:5px;width:25%;'>${company.shemkupa}</td>
                    <td style="width:16%;">${Number(company.tesuam).toFixed(2)}%</td>
                    <td  style="width:16%;">${Number(company.tesuam36).toFixed(2)}%</td>
                    <td style="width:16%;">${Number(company.tesuam60).toFixed(2)}%</td>
                `;
                tableBody.appendChild(row);
            });
 
 const tableBody2 = document.querySelector('#comparisonTable2 tbody');
            
            if (!tableBody2) {
                console.error('לא נמצא tbody עבור comparisonTable2');
                return;
            }
            
            tableBody2.innerHTML = `
                <thead>
                <tr>
                    <th style="width:14%;">חברה</th>
                    <th style="width:22%;">שם המסלול</th>
                    <th style="width:18%;">חשיפה למניות</th>
                    <th style="width:18%;">חשיפה לחול</th>
                    <th style="width:18%;">חשיפה למטח</th>
                </tr>
                </thead>
            `;
            data.forEach(company => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style='text-align:right;padding-right:5px;width:14%;white-space:wrap;'>${company.shemkupa.split(" ")[0]}</td>
                    <td class="tdnamekupa" style='text-align:right;padding-right:5px;width:22%;'>${company.shemkupa}</td>
                    <td style="width:18%;">${Number(company.kvutzaAhuz4751).toFixed(2)}%</td>
                    <td style="width:18%;">${Number(company.kvutzaAhuz4752).toFixed(2)}%</td>
                    <td style="width:18%;">${Number(company.kvutzaAhuz4761).toFixed(2)}%</td>
                `;
                tableBody2.appendChild(row);
            });
       
const tableBody3 = document.querySelector('#comparisonTable3 tbody');
            
            if (!tableBody3) {
                console.error('לא נמצא tbody עבור comparisonTable3');
                return;
            }
            
            tableBody3.innerHTML = `
                <thead>
                <tr>
                    <th style="width:14%;">חברה</th>
                    <th style="width:22%;">שם המסלול</th>
                    <th style="width:18%;">סטיית תקן 36 חודשים</th>
                    <th style="width:18%;">סטיית תקן 60 חודשים</th>
                    <th style="width:18%;">שארפ</th>
                </tr>
                </thead>
            `;
            data.forEach(company => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style='text-align:right;padding-right:5px;width:14%;white-space:wrap;'>${company.shemkupa.split(" ")[0]}</td>
                    <td class="tdnamekupa" style='text-align:right;padding-right:5px;width:22%;'>${company.shemkupa}</td>
                    <td style="width:18%;">${Number(company.stiya36).toFixed(2)}%</td>
                    <td style="width:18%;">${Number(company.stiya60).toFixed(2)}%</td>
                    <td style="width:18%;">${Number(company.sharp).toFixed(2)}</td>
                `;
                tableBody3.appendChild(row);
            });
 
            
 
 document.querySelectorAll('[class^="tbltbody"] td').forEach(td => {
      let text = td.textContent.trim();
      if (text.startsWith("-")) {
          td.innerHTML = `<span style="direction: ltr; display: inline-block;">${text}</span>`;
          td.style.color="red";
          td.style.textAlign='center'
      }
 });
            addclickMen();
        }
function addclickMen(){
     const elements = document.querySelectorAll(".tdnamekupa");
    elements.forEach((element) => {
    element.setAttribute("onclick", "bringinfo(this)");
});
}
let yearChart, threeYearChart, fiveYearChart;
function createChart(ctx, label, data) {
    const backgroundColors = [
        'rgba(255, 99, 132, 0.6)',
        'rgba(54, 162, 235, 0.6)',
        'rgba(255, 206, 86, 0.6)',
        'rgba(75, 192, 192, 0.6)',
        'rgba(153, 102, 255, 0.6)',
        'rgba(255, 159, 64, 0.6)',
        'rgba(199, 199, 199, 0.6)'
    ];
    const borderColors = backgroundColors.map(color => color.replace('0.6', '1'));
    return new Chart(ctx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: [{
                label: label,
                data: data.values,
                backgroundColor: backgroundColors.slice(0, data.values.length),
                borderColor: borderColors.slice(0, data.values.length),
                borderWidth: 1
            }]
        },
        options: {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
        y: { beginAtZero: true }
    },
    plugins: {
        title: {
            display: true,
            text: label
        },
        legend: { display: false } // אפשר לשנות ל-true אם רוצים שהמקרא יוצג
    }
}
    });
    
}
function updateCharts(selectedData,selectedProduct) {
    
    // הצגת מכל הגרפים - שימוש במשתנה הגלובלי
    if (!charts) {
        console.error('charts container not found!');
        return;
    }
    
    // הסרת inline styles ושימוש ב-CSS
    charts.style.removeProperty('display');
    charts.style.removeProperty('visibility');
    charts.classList.add('show-charts');
    
    
    var labels;
    if(selectedProduct!=='פוליסות חסכון'){
        labels = selectedData.map(item => item.menahelet);
    }
    else{
        labels = selectedData.map(item => item.shemkupa.split(" ")[0]);
    }
    
    const yearData = selectedData.map(item => item.tesuam);
    const threeYearData = selectedData.map(item => item.tesuam36);
    const fiveYearData = selectedData.map(item => item.tesuam60);
    
    
    // השמדת גרפים קודמים אם קיימים
    if (yearChart) yearChart.destroy();
    if (threeYearChart) threeYearChart.destroy();
    if (fiveYearChart) fiveYearChart.destroy();
    
    // יצירת גרפים חדשים
    const yearCanvas = document.getElementById('yearChart');
    yearCanvas.style.display = 'block';
    const threeYearCanvas = document.getElementById('threeYearChart');
    const fiveYearCanvas = document.getElementById('fiveYearChart');
    
    if (!yearCanvas || !threeYearCanvas || !fiveYearCanvas) {
        console.error('Canvas elements not found!');
        return;
    }
    
    yearChart = createChart(yearCanvas.getContext('2d'), 'תשואה שנתית (12 חודשים)', { labels, values: yearData });
    threeYearChart = createChart(threeYearCanvas.getContext('2d'), 'תשואה 3 שנים', { labels, values: threeYearData });
    fiveYearChart = createChart(fiveYearCanvas.getContext('2d'), 'תשואה 5 שנים', { labels, values: fiveYearData });
    
    
    // ודא שהגרף הראשון מוצג
    document.querySelectorAll('.chart-wrapper').forEach(wrapper => wrapper.classList.remove('active'));
    const yearWrapper = document.getElementById('yearChartWrapper');
    if (yearWrapper) {
        yearWrapper.classList.add('active');
    }
    
    // ודא שהכפתור הראשון פעיל
    document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
    const firstBtn = document.querySelectorAll('.chart-btn')[0];
    if (firstBtn) {
        firstBtn.classList.add('active');
    }
}
async function filterMaslulXa(mas, moza){
    var data;var dataforfilter;
   if(moza==="פוליסות חסכון"){dataforfilter=datanetunimKlaliXb}
   else if(moza==="קרנות חדשות"){dataforfilter=datanetunimKlaliXp}
   else{dataforfilter=datanetunimKlaliXa}
        var data;
        if (mas==='כללי'){
             data = dataforfilter.filter(item => 
                 item.mozar === moza &&   
                 item.shemkupa.includes(mas) 
                );
         data.sort((a, b) => b.tesuam - a.tesuam); 
         return data;
         }
         else if(mas==='עוקב מדד s&p 500' && moza!=="פוליסות חסכון"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('500')
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==='עוקב מדד s&p 500' && moza==="פוליסות חסכון"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('500')
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="מניות"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('מניות') &&
                 !item.shemkupa.includes('עוקב') &&
                 !item.shemkupa.includes('סחיר') &&
                 !item.shemkupa.includes('משולב') &&
                 !item.shemkupa.includes('25') &&
                 !item.shemkupa.includes('"אג\"ח"') && 
                 !item.shemkupa.includes('פאסיבי')
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="אשראי ואג\"ח"){
                 data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('אשראי') &&
                 !item.shemkupa.includes('מניות') &&
                 !item.shemkupa.includes('עוקב') &&
                 !item.shemkupa.includes('סחיר')
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="אשראי ואג\"ח עם מניות"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('אשראי') &&
                 item.shemkupa.includes('25') 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="כספי (שקלי)"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('כספי (שקלי)')
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="עוקב מדדים - גמיש"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('עוקב') &&
                 item.shemkupa.includes('גמיש')
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="אג\"ח ממשלות"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('ממשלות')
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="הלכה יהודית"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes('הלכה')
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="משולב סחיר"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("משולב סחיר")
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="עוקב מדדי אג\"ח"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("עוקב") &&
                 item.shemkupa.includes("אג\"ח") &&
                 !item.shemkupa.includes("מניות") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="עוקב מדדי מניות"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("מניות") &&
                 !item.shemkupa.includes("אג\"ח") &&
                 item.shemkupa.includes("עוקב") &&
                 !item.shemkupa.includes("25") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="מניות סחיר"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("מניות") &&
                 item.shemkupa.includes("סחיר") && 
                 !item.shemkupa.includes("25")  
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="אג\"ח סחיר"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("סחיר") &&
                 item.shemkupa.includes("אג\"ח") &&
                 !item.shemkupa.includes("מניות") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="אג\"ח סחיר עם מניות"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("סחיר") &&
                 item.shemkupa.includes("אג\"ח") &&
                 item.shemkupa.includes("מניות") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="עוקב מדדי אג\"ח עם מניות"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 !item.shemkupa.includes("סחיר") &&
                 item.shemkupa.includes("אג\"ח") &&
                 item.shemkupa.includes("מניות") &&
                 item.shemkupa.includes("עוקב")
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="50-60"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("50") &&
                 item.shemkupa.includes("60") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="עד 50"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("50") &&
                 !item.shemkupa.includes('עוקב') &&
                 !item.shemkupa.includes("60") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==="60 ומעלה"){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 !item.shemkupa.includes("50") &&
                 item.shemkupa.includes("60") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
         }
         else if(mas==='סיכון מוגבר'){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("מוגבר") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
          }
          else if(mas==='סיכון מועט'){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("מועט") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
          }
          else if(mas==='סיכון בינוני'){
             data = dataforfilter.filter(item => 
                 item.mozar === moza && 
                 item.shemkupa.includes("בינוני") 
             );
         data.sort((a, b) => b.tesuam - a.tesuam);    
         return data;
          }
}
function clearCompare(){
    divCompare.innerHTML='';
    btnPdf.style.display='none';
}
function hatraa(x){
    Swal.fire({
    title: `<span style='color: green; font-size: 16px;'>${x}</span>`,
    width: "clamp(250px,90vw,500px)", 
    icon: "warning",
    showCancelButton: false,
    confirmButtonText: "אישור",
    cancelButtonText: "לא, בטל",
    confirmButtonColor: "#3085d6",
    cancelButtonColor: "#d33",
    customClass: {
      confirmButton: "custom-confirm-button"
      }
    }).then((result) => {
    });
}
async function compare2() {
  btnPdf.style.display = 'block';
  divCompare.style.display = 'block';

  if (selmenu1.value === selmenu2.value) {
    hatraa("נדרש לבחור חברות שונות");
    return;
  }

  divCompare.innerHTML = '';

  // ===== שמות מקוריים לתצוגה =====
  const men1Display = selmenu1.value;
  const men2Display = selmenu2.value;

  // ===== עזר: חיתוך לשם קצר לכותרות =====
  const cutCompanyName = (s) => {
    const firstSpace = s.indexOf(" ");
    if (firstSpace === -1) return s;
    const secondSpace = s.indexOf(" ", firstSpace + 1);
    return secondSpace === -1 ? s : s.slice(0, secondSpace + 1);
  };

  const men1x = cutCompanyName(men1Display);
  const men2x = cutCompanyName(men2Display);

  // ===== עזר: המרת תשואה למספר (כולל ניקוי %) =====
  const toNum = (v) => {
    if (v === undefined || v === null || v === '' || v === 0) return null;
    if (typeof v === 'string') {
      const s = v.replace('%', '').replace(/,/g, '').trim();
      if (!s) return null;
      const n = Number(s);
      return Number.isFinite(n) ? n : null;
    }
    const n = Number(v);
    return Number.isFinite(n) ? n : null;
  };

  const buildSide = (src) => ({
    year: toNum(src?.tesuam),
    threeYears: toNum(src?.tesuam36),
    fiveYears: toNum(src?.tesuam60),
  });

  const getRelevantList = (moz) => {
    if (moz === "קרנות השתלמות" || moz === "קופת גמל להשקעה" || moz === "פוליסות חסכון") return hishtalmot;
    if (moz === "תגמולים ואישית לפיצויים" || moz === "קרנות חדשות") return gemel;
    if (moz === "קופת גמל להשקעה - חסכון לילד") return layeled;
    return null;
  };

  const productTitle = (moz) => (moz !== 'קרנות חדשות' ? moz : 'קרנות פנסיה - אישית');

  const addWin = (map, moz, obj) => {
    if (!map[moz]) map[moz] = [];
    map[moz].push(obj);
  };

  // ===== מפות תוצאות: חלק 1 (men1 מובילה) וחלק 2 (men2 מובילה) =====
  const wins1ByProduct = {}; // A = men1, B = men2
  const wins2ByProduct = {}; // A = men2, B = men1

  // ===== שלב חישוב: מעבר על מוצרים+מסלולים =====
  for (let r = 0; r < mozkochCompare.length; r++) {
    const moz = mozkochCompare[r];
    const relevantList = getRelevantList(moz);
    if (!relevantList) continue;

    for (let i = 0; i < relevantList.length; i++) {
      const dataspecific = await filterMaslulXa(relevantList[i], moz);
      if (!dataspecific || dataspecific.length < 2) continue;

      // פילטרים לפי סוג מוצר (לא לשנות men1Display/men2Display!)
      let toz1, toz2;

      if (moz !== "פוליסות חסכון") {
        toz1 = dataspecific.filter(item => item?.menahelet?.includes(men1Display));
        toz2 = dataspecific.filter(item => item?.tesuam !== undefined && item?.menahelet?.includes(men2Display));
      } else {
        // בפוליסות חסכון לפי shemkupa ולרוב מספיק מילה ראשונה
        const men1Key = men1Display.split(" ")[0];
        const men2Key = men2Display.split(" ")[0];

        toz1 = dataspecific.filter(item => item?.tesuam !== undefined && item?.shemkupa?.includes(men1Key));
        toz2 = dataspecific.filter(item => item?.tesuam !== undefined && item?.shemkupa?.includes(men2Key));
      }

      const a1 = toz1?.[0];
      const a2 = toz2?.[0];
      if (!a1 || !a2) continue;

      // השוואה אך ורק על 12 חודשים (tesuam)
      const y1 = toNum(a1.tesuam);
      const y2 = toNum(a2.tesuam);
      if (y1 === null || y2 === null) continue;

      if (y1 > y2) {
        // men1 מובילה => A=men1, B=men2
        addWin(wins1ByProduct, moz, {
          product: moz,
          track: relevantList[i],
          AName: men1Display,
          BName: men2Display,
          A: buildSide(a1),
          B: buildSide(a2)
        });
      } else if (y2 > y1) {
        // men2 מובילה => A=men2, B=men1 (החלפה מלאה של הנתונים!)
        addWin(wins2ByProduct, moz, {
          product: moz,
          track: relevantList[i],
          AName: men2Display,
          BName: men1Display,
          A: buildSide(a2),
          B: buildSide(a1)
        });
      }
    }
  }

  // ===== רינדור =====
  const cellColor = (a, b) => {
    if (a === null || b === null) return '#333';
    return Number(a) > Number(b) ? 'green' : '#333';
  };

  const renderSection = (titleHtml, map) => {
    divCompare.innerHTML += titleHtml;

    // שמירה על סדר מוצרים כמו mozkochCompare
    let hasAny = false;

    for (let r = 0; r < mozkochCompare.length; r++) {
      const moz = mozkochCompare[r];
      const arr = map[moz];
      if (!arr || arr.length === 0) continue;

      hasAny = true;
      divCompare.innerHTML += `<h4 style="width:100%;max-width:100%;text-align:center;">${productTitle(moz)}</h4>`;

      arr.forEach(result => {
        const cYear = cellColor(result.A.year, result.B.year);
        const c3Y   = cellColor(result.A.threeYears, result.B.threeYears);
        const c5Y   = cellColor(result.A.fiveYears, result.B.fiveYears);

        const disp = (n) => (n === null ? 'לא קיים' : (n.toFixed(2) + "%"));

        divCompare.innerHTML += `
          <br>
          <table class="tblRashi">
            <thead>
              <tr><th class="thkotrash" colspan="4">מסלול: ${result.track}</th></tr>
              <tr>
                <th class="thkotmish">שם מנהלת</th>
                <th class="thkotmish">שנה</th>
                <th class="thkotmish">3 שנים</th>
                <th class="thkotmish">5 שנים</th>
              </tr>
              <tr>
                <td class="tdshura">${result.AName}</td>
                <td class="tdshura" style="color:${cYear}">${disp(result.A.year)}</td>
                <td class="tdshura" style="color:${c3Y}">${disp(result.A.threeYears)}</td>
                <td class="tdshura" style="color:${c5Y}">${disp(result.A.fiveYears)}</td>
              </tr>
              <tr>
                <td class="tdshura">${result.BName}</td>
                <td class="tdshura">${disp(result.B.year)}</td>
                <td class="tdshura">${disp(result.B.threeYears)}</td>
                <td class="tdshura">${disp(result.B.fiveYears)}</td>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        `;
      });
    }

    if (!hasAny) {
      divCompare.innerHTML += `<p style="width:100%;text-align:center;margin:10px 0;">לא נמצאו תוצאות להצגה.</p>`;
    }
  };

  // ===== חלק 1: men1 מובילה על men2 (12 חודשים) =====
  renderSection(
    `<h3 style="width:100%;max-width:100%;text-align:center;">יתרונות ${men1x} מול ${men2x} בתשואה ל-12 חודשים</h3>`,
    wins1ByProduct
  );

  // ===== חלק 2: men2 מובילה על men1 (12 חודשים) =====
  renderSection(
    `<h3 style="width:100%;max-width:100%;text-align:center;margin-top:22px;">יתרונות ${men2x} מול ${men1x} בתשואה ל-12 חודשים</h3>`,
    wins2ByProduct
  );
}


function pdfDo() {
        document.getElementById('formDo').style.display='none';
        let element = document.getElementById("compare");
        const originalDisplay = element.style.display;
    
        element.style.display = 'none';
        window.print();
        element.style.display = originalDisplay;
        document.getElementById('formDo').style.display='flex';

}
        // פונקציה להחלפת גרפים
        function switchChart(chartType) {
            // הסרת active מכל הכפתורים
            document.querySelectorAll('.chart-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // הסתרת כל הגרפים
            document.querySelectorAll('.chart-wrapper').forEach(wrapper => {
                wrapper.classList.remove('active');
            });
            
            // הצגת הגרף המבוקש והפעלת הכפתור
            if (chartType === 'year') {
                document.getElementById('yearChartWrapper').classList.add('active');
                document.querySelectorAll('.chart-btn')[0].classList.add('active');
                document.getElementById('yearChart').style.display = 'block';
                document.getElementById('threeYearChart').style.display = 'none';
                document.getElementById('fiveYearChart').style.display = 'none';
            } else if (chartType === 'threeYear') {
                document.getElementById('threeYearChartWrapper').classList.add('active');
                document.querySelectorAll('.chart-btn')[1].classList.add('active');
                document.getElementById('threeYearChart').style.display = 'block';
                document.getElementById('yearChart').style.display = 'none';
                document.getElementById('fiveYearChart').style.display = 'none';
            } else if (chartType === 'fiveYear') {
                document.getElementById('fiveYearChartWrapper').classList.add('active');
                document.querySelectorAll('.chart-btn')[2].classList.add('active');
                document.getElementById('fiveYearChart').style.display = 'block';
                document.getElementById('yearChart').style.display = 'none';
                document.getElementById('threeYearChart').style.display = 'none';
            }
        }

        // Dropdown functions
        function toggleHashMenahalotProductsDropdown(event) {
            console.log('toggleHashMenahalotProductsDropdown called');
            if (!event) event = window.event;
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            const dropdown = document.getElementById('hashMenahalotProductsDropdown');
            if (!dropdown) {
                console.log('dropdown not found');
                return false;
            }
            // Find the link - could be event.target or its parent
            let link = null;
            if (event && event.target) {
                link = event.target.closest ? event.target.closest('a') : null;
                if (!link && event.target.tagName === 'A') link = event.target;
            }
            if (!link) link = dropdown.closest('.nav-dropdown')?.querySelector('a');
            
            // במסכים גדולים, התפריט נפתח ב-hover (CSS), אז לא צריך לעשות כלום
            if (window.innerWidth > 768) {
                console.log('desktop mode, returning');
                return false;
            }
            
            console.log('mobile mode, toggling dropdown');
            // Close other dropdowns and reset their text
            document.querySelectorAll('.dropdown-content.show').forEach(d => {
                if (d !== dropdown) {
                    d.classList.remove('show');
                    const parentLi = d.closest('.nav-dropdown');
                    const parentLink = parentLi?.querySelector('a');
                    if (parentLink) {
                        if (d.id === 'hashMenahalotCalculatorDropdown') {
                            parentLink.innerHTML = 'מחשבונים ▼';
                        } else if (d.id === 'hashMenahalotToolsDropdown') {
                            parentLink.innerHTML = 'כלי השוואה ▼';
                        }
                    }
                }
            });
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                if (link) link.innerHTML = 'מוצרים ותשואות ▼';
                console.log('dropdown closed');
            } else {
                dropdown.classList.add('show');
                if (link) link.innerHTML = 'מוצרים ותשואות ▲';
                console.log('dropdown opened');
            }
            return false;
        }
        
        // Debug: Check if function is defined after definition
        console.log('After definition - toggleHashMenahalotProductsDropdown:', typeof toggleHashMenahalotProductsDropdown);
        
        function toggleHashMenahalotCalculatorDropdown(event) {
            if (!event) event = window.event;
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            const dropdown = document.getElementById('hashMenahalotCalculatorDropdown');
            if (!dropdown) return false;
            // Find the link - could be event.target or its parent
            let link = null;
            if (event && event.target) {
                link = event.target.closest ? event.target.closest('a') : null;
                if (!link && event.target.tagName === 'A') link = event.target;
            }
            if (!link) link = dropdown.closest('.nav-dropdown')?.querySelector('a');
            
            // במסכים גדולים, התפריט נפתח ב-hover (CSS), אז לא צריך לעשות כלום
            if (window.innerWidth > 768) {
                return false;
            }
            
            // Close other dropdowns and reset their text
            document.querySelectorAll('.dropdown-content.show').forEach(d => {
                if (d !== dropdown) {
                    d.classList.remove('show');
                    const parentLi = d.closest('.nav-dropdown');
                    const parentLink = parentLi?.querySelector('a');
                    if (parentLink) {
                        if (d.id === 'hashMenahalotProductsDropdown') {
                            parentLink.innerHTML = 'מוצרים ותשואות ▼';
                        } else if (d.id === 'hashMenahalotToolsDropdown') {
                            parentLink.innerHTML = 'כלי השוואה ▼';
                        }
                    }
                }
            });
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                if (link) link.innerHTML = 'מחשבונים ▼';
            } else {
                dropdown.classList.add('show');
                if (link) link.innerHTML = 'מחשבונים ▲';
            }
            return false;
        }
        
        function toggleHashMenahalotToolsDropdown(event) {
            if (!event) event = window.event;
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            const dropdown = document.getElementById('hashMenahalotToolsDropdown');
            if (!dropdown) return false;
            // Find the link - could be event.target or its parent
            let link = null;
            if (event && event.target) {
                link = event.target.closest ? event.target.closest('a') : null;
                if (!link && event.target.tagName === 'A') link = event.target;
            }
            if (!link) link = dropdown.closest('.nav-dropdown')?.querySelector('a');
            
            // במסכים גדולים, התפריט נפתח ב-hover (CSS), אז לא צריך לעשות כלום
            if (window.innerWidth > 768) {
                return false;
            }
            
            // Close other dropdowns and reset their text
            document.querySelectorAll('.dropdown-content.show').forEach(d => {
                if (d !== dropdown) {
                    d.classList.remove('show');
                    const parentLi = d.closest('.nav-dropdown');
                    const parentLink = parentLi?.querySelector('a');
                    if (parentLink) {
                        if (d.id === 'hashMenahalotProductsDropdown') {
                            parentLink.innerHTML = 'מוצרים ותשואות ▼';
                        } else if (d.id === 'hashMenahalotCalculatorDropdown') {
                            parentLink.innerHTML = 'מחשבונים ▼';
                        }
                    }
                }
            });
            
            if (dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
                if (link) link.innerHTML = 'כלי השוואה ▼';
            } else {
                dropdown.classList.add('show');
                if (link) link.innerHTML = 'כלי השוואה ▲';
            }
            return false;
        }

        // Close nav dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            document.querySelectorAll('.dropdown-content.show').forEach(d => {
                if (!d.contains(event.target)) {
                    const parentLi = d.closest('.nav-dropdown');
                    const parentLink = parentLi?.querySelector('a');
                    if (parentLink && !parentLink.contains(event.target)) {
                        d.classList.remove('show');
                        if (d.id === 'hashMenahalotProductsDropdown') {
                            parentLink.innerHTML = 'מוצרים ותשואות ▼';
                        } else if (d.id === 'hashMenahalotCalculatorDropdown') {
                            parentLink.innerHTML = 'מחשבונים ▼';
                        } else if (d.id === 'hashMenahalotToolsDropdown') {
                            parentLink.innerHTML = 'כלי השוואה ▼';
                        }
                    }
                }
            });
        });

        // Close nav dropdown when clicking on links
        document.addEventListener('click', function(event) {
            if (event.target.closest('#hashMenahalotProductsDropdown a')) {
                const navDropdown = document.getElementById('hashMenahalotProductsDropdown');
                const navLink = navDropdown?.closest('.nav-dropdown')?.querySelector('a');
                
                if (navDropdown) navDropdown.classList.remove('show');
                if (navLink) navLink.innerHTML = 'מוצרים ותשואות ▼';
            }
            
            if (event.target.closest('#hashMenahalotCalculatorDropdown a')) {
                const navDropdown = document.getElementById('hashMenahalotCalculatorDropdown');
                const navLink = navDropdown?.closest('.nav-dropdown')?.querySelector('a');
                
                if (navDropdown) navDropdown.classList.remove('show');
                if (navLink) navLink.innerHTML = 'מחשבונים ▼';
            }
            
            if (event.target.closest('#hashMenahalotToolsDropdown a')) {
                const navDropdown = document.getElementById('hashMenahalotToolsDropdown');
                const navLink = navDropdown?.closest('.nav-dropdown')?.querySelector('a');
                
                if (navDropdown) navDropdown.classList.remove('show');
                if (navLink) navLink.innerHTML = 'כלי השוואה ▼';
            }
        });


        // Hamburger menu functionality
       
        // Ensure nav dropdown links work properly
        document.querySelectorAll('#hashMenahalotProductsDropdown a, #hashMenahalotCalculatorDropdown a, #hashMenahalotToolsDropdown a').forEach(link => {
            link.addEventListener('click', function(e) {
                // Don't prevent default - let the link work normally
                e.stopPropagation();
                
                // Close dropdown after a short delay to allow navigation
                setTimeout(() => {
                    const allDropdowns = ['hashMenahalotProductsDropdown', 'hashMenahalotCalculatorDropdown', 'hashMenahalotToolsDropdown'];
                    allDropdowns.forEach(dropdownId => {
                        const dropdown = document.getElementById(dropdownId);
                        const dropdownLink = dropdown?.closest('.nav-dropdown')?.querySelector('a');
                        
                        if (dropdown) {
                            dropdown.classList.remove('show');
                        }
                        if (dropdownLink) {
                            if (dropdownId.includes('Products')) {
                                dropdownLink.innerHTML = 'מוצרים ותשואות ▼';
                            } else if (dropdownId.includes('Calculator')) {
                                dropdownLink.innerHTML = 'מחשבונים ▼';
                            } else if (dropdownId.includes('Tools')) {
                                dropdownLink.innerHTML = 'כלי השוואה ▼';
                            }
                        }
                    });
                }, 100);
            });
        });

        // Hamburger menu functionality
        document.addEventListener('DOMContentLoaded', function() {
            const hamburger = document.getElementById('hamburger');
            const navMenu = document.getElementById('navMenu');
            
            if (hamburger && navMenu) {
                hamburger.addEventListener('click', function() {
                    this.classList.toggle('active');
                    navMenu.classList.toggle('active');
                });

                document.querySelectorAll('.nav-menu a').forEach(link => {
                    link.addEventListener('click', function(e) {
                        if (window.innerWidth <= 768 && !this.hasAttribute('onclick')) {
                            hamburger.classList.remove('active');
                            navMenu.classList.remove('active');
                        }
                    });
                });

                document.addEventListener('click', function(e) {
                    if (!navMenu.contains(e.target) && !hamburger.contains(e.target)) {
                        hamburger.classList.remove('active');
                        navMenu.classList.remove('active');
                    }
                });
            }
        });

    </script>

    <!-- Modal Container -->
    <div id="modals-container"></div>

    <!-- External Modal Scripts -->
    <script src="about-modal.js"></script>
    <script src="consultation-form.js"></script>
    <script src="terms-modal.js"></script>
    <script src="accessibility.js"></script>
    <script>
        // Load Modal HTML files
        fetch('about-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('modals-container').innerHTML += html;
            })
            .catch(err => console.error('Error loading about modal:', err));
        
        fetch('terms-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('modals-container').innerHTML += html;
            })
            .catch(err => console.error('Error loading terms modal:', err));
        
        fetch('consultation-form.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('modals-container').innerHTML += html;
            })
            .catch(err => console.error('Error loading consultation form:', err));
        
        // Load Footer
        fetch('footer.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('beforeend', html);
            })
            .catch(err => console.error('Error loading footer:', err));
        
        // ========================================
        // Navigate to Home Page Function
        // ========================================
        function navigateToHome() {
            // אם אנחנו כבר בדף הבית - פשוט נגלול למעלה
            if (window.location.pathname.endsWith('index.html') || window.location.pathname === '/') {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                // אנחנו בדף אחר - נעבור לדף הבית
                window.location.href = 'index.html';
            }
        }
        
        // Debug: Check if functions are defined
        console.log('toggleHashMenahalotProductsDropdown defined:', typeof toggleHashMenahalotProductsDropdown);
        console.log('toggleHashMenahalotCalculatorDropdown defined:', typeof toggleHashMenahalotCalculatorDropdown);
        console.log('toggleHashMenahalotToolsDropdown defined:', typeof toggleHashMenahalotToolsDropdown);
    </script>

</body>
</html>


